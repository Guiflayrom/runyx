(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34589,e=>{"use strict";var t=e.i(1717),r=e.i(9814);let s="runyx:projects",a=(0,r.createContext)(null);function n(e){let t=crypto.randomUUID();return window.parent.postMessage({__fromSandbox:!0,requestId:t,payload:e},"*"),new Promise((e,r)=>{let s=a=>{let n=a.data;n?.__fromExtension&&n.requestId===t&&(window.removeEventListener("message",s),n.error?r(Error(n.error)):e(n.response))};window.addEventListener("message",s)})}function l(){let e=(0,r.useContext)(a);if(!e)throw Error("useProject must be used within ProjectProvider");return e}let o=[];function i({children:e}){let[l,i]=(0,r.useState)(o),[c,d]=(0,r.useState)(null),[u,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{let e=await n({type:"storage.get",keys:[s]}),t=e?.data?.[s];t?.projects&&Array.isArray(t.projects)&&i(t.projects),t&&"selectedProjectId"in t&&d(t.selectedProjectId??null)}catch(e){console.warn("[storage] failed to load projects",e)}finally{x(!0)}})()},[]),(0,r.useEffect)(()=>{u&&n({type:"storage.set",data:{[s]:{projects:l,selectedProjectId:c}}}).catch(e=>console.warn("[storage] failed to persist projects",e))},[u,l,c]);let m=(0,r.useCallback)(e=>l.find(t=>t.id===e),[l]),p=(0,r.useCallback)(e=>{i(t=>[...t,e])},[]),h=(0,r.useCallback)((e,t)=>{i(r=>r.map(r=>r.id===e?{...r,...t,updatedAt:Date.now()}:r))},[]),f=(0,r.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e)),d(t=>t===e?null:t)},[]),g=(0,r.useCallback)((e,t)=>{i(r=>r.map(r=>r.id===e?r.workflowIds.includes(t)?r:{...r,workflowIds:[...r.workflowIds,t],updatedAt:Date.now()}:r))},[]),v=(0,r.useCallback)((e,t)=>{i(r=>r.map(r=>r.id===e?{...r,workflowIds:r.workflowIds.filter(e=>e!==t),updatedAt:Date.now()}:r))},[]);return(0,t.jsx)(a.Provider,{value:{projects:l,selectedProjectId:c,hydrated:u,setSelectedProjectId:d,getProject:m,addProject:p,updateProject:h,deleteProject:f,addWorkflowToProject:g,removeWorkflowFromProject:v},children:e})}e.s(["DEFAULT_PROJECT_ID",0,"proj-1","ProjectProvider",()=>i,"useProject",()=>l])},46385,4831,96185,e=>{"use strict";var t=e.i(1717),r=e.i(9814);let s=[],a=(0,r.createContext)(null),n={runIn:"page",target:"currentTab",specificTabId:"",scopeUrlRegex:"",mode:"expression",code:"",args:[],expect:"any",saveAs:"",saveOnlyIfOk:!1,failOnFalsy:!1},l={mode:"single",parallelLimit:2},o={eventName:"",channel:"",authToken:"",dedupeWindowMs:0},i={event:"navigation:completed",urlMatchType:"hostEquals",urlValue:"",runOncePerSession:!0,onlyIfTabActive:!1,debounceMs:300},c={condition:"selectorAppears",selector:"",text:"",attributeName:"",attributeValue:"",timeoutMs:1e4,fireMode:"once",cooldownMs:1e3,targetTabScope:"currentTab",scopeUrlRegex:""},d={mode:"everyMinutes",everyMinutes:30,everyMs:1e3,dailyTime:"09:00",timezone:"local",jitterMs:0,runIfBrowserClosed:!1},u={waitFor:"selectorAppears",textScope:"any",strategy:"observer",intervalMs:250,requireStableMs:0,invert:!1,timeMs:1e3},x={selector:"",extractWhat:"text",multiple:"first",joinWith:"\n",outputType:"auto",trim:!0,defaultValue:"",failIfEmpty:!1,saveAs:"",serverUpload:{enabled:!1,url:"",method:"POST",headers:[],dataField:"data"}},m={captureMode:"viewport",format:"png",quality:90,includeTimestamp:!0,fileNameTemplate:"{{workflow}}_{{step}}_{{timestamp}}",saveTo:"downloads",maxWidth:0,onFail:"continue",serverUpload:{enabled:!1,url:"",method:"POST",headers:[],dataField:"screenshot"}};function p(e){switch(e){case"webhookWs":return{...o};case"browserEvent":return{...i};case"domCondition":return{...c};case"schedule":return{...d}}}function h(){return{allowedSites:[],wsEndpoint:"",wsConnected:!1,wsConnectRequested:!1,verboseLogging:!1,allowCookies:!1,allowStorage:!1,maxRetries:0,defaultTimeout:5e3,triggerPolicy:{...l}}}function f(e){return{version:"1.0.0",exportedAt:Date.now(),workflow:{...e,runs:[],settings:{...e.settings,wsConnected:!1,wsConnectRequested:!1}}}}function g(e){return{...e.workflow,id:"wf-"+Date.now().toString(),createdAt:Date.now(),updatedAt:Date.now(),runs:[],runCount:0,lastRun:void 0,status:"idle",settings:b(e.workflow.settings),variables:e.workflow.variables||{}}}function v(e){if(!e||"object"!=typeof e||"string"!=typeof e.version||"number"!=typeof e.exportedAt||!e.workflow||"object"!=typeof e.workflow)return!1;let t=e.workflow;return"string"==typeof t.name&&!!Array.isArray(t.steps)&&!!Array.isArray(t.triggers)&&(!t.settings||"object"==typeof t.settings)&&(!t.variables||"object"==typeof t.variables)}function b(e){let t=h();return e?{allowedSites:Array.isArray(e.allowedSites)?e.allowedSites:t.allowedSites,wsEndpoint:"string"==typeof e.wsEndpoint?e.wsEndpoint:t.wsEndpoint,wsConnected:!1,verboseLogging:"boolean"==typeof e.verboseLogging?e.verboseLogging:t.verboseLogging,allowCookies:"boolean"==typeof e.allowCookies?e.allowCookies:t.allowCookies,allowStorage:"boolean"==typeof e.allowStorage?e.allowStorage:t.allowStorage,maxRetries:"number"==typeof e.maxRetries?e.maxRetries:t.maxRetries,defaultTimeout:"number"==typeof e.defaultTimeout?e.defaultTimeout:t.defaultTimeout,triggerPolicy:e.triggerPolicy&&e.triggerPolicy.mode?{mode:e.triggerPolicy.mode,parallelLimit:"number"==typeof e.triggerPolicy.parallelLimit?e.triggerPolicy.parallelLimit:t.triggerPolicy.parallelLimit}:t.triggerPolicy}:t}e.s(["createDefaultSettings",()=>h,"defaultEvaluateConfig",0,n,"defaultExtractConfig",0,x,"defaultScreenshotConfig",0,m,"defaultTriggerRunPolicy",0,l,"defaultWaitConfig",0,u,"deserializeWorkflow",()=>g,"getDefaultConfig",()=>p,"mergeSettingsWithDefaults",()=>b,"serializeWorkflow",()=>f,"validateWorkflowImport",()=>v],4831);let y=e=>new Promise(t=>setTimeout(t,e)),j=(e,t)=>e?t?e.replace(/{{\s*([^}]+)\s*}}/g,(e,r)=>{let s=((e,t)=>{if(e)return t.split(".").reduce((e,t)=>{if(null!=e)return e[t]},e)})(t,String(r||"").trim());return null==s?"":String(s)}):e:e??"";function w(e){if(!e)return;let t=e.trim();if(t&&"none"!==t.toLowerCase())return t}function N(e,t){if(!t||!e)return;let r=t.replace(/\[(\w+)\]/g,".$1").split(".").filter(Boolean),s=e;for(let e of r)if(!(s&&Object.prototype.hasOwnProperty.call(s,e)))return;else s=s[e];return s}async function k(e){var t;let r,s,a=e.body&&"GET"!==e.method?e.body:void 0,n=(t=function(e){let t={};for(let r of e||[])r.key&&(t[r.key]=r.value??"");return t}(e.headers),(s=w(e.contentType))?{...t,"Content-Type":s}:t),l=await fetch(e.url,{method:e.method||"GET",headers:n,body:a}),o=await l.text();try{r=JSON.parse(o)}catch{r=void 0}let i=e.responseJsonPath?N(r,e.responseJsonPath):void 0;return{status:l.status,text:o,json:r,extracted:i}}async function C(e){let t=e.retry?.enabled?e.retry.maxRetries??0:0,r=null;for(let s=0;s<=t&&!function(e,t){if(!t?.enabled)return!0;if("statusCode"===t.conditionType){let r=t.expectedStatusCode??200;return e.status===r}let r=t.jsonField||void 0,s=r?N(e.json,r):void 0;if(null==s)return!1;let a=String(s),n=t.jsonFieldValue??"";switch(t.jsonFieldOperator){case"equals":return a===n;case"notEquals":return a!==n;case"contains":return a.includes(n);case"notContains":return!a.includes(n);default:return!1}}(r=await k(e),e.retry);s++)s<t&&await y(750);return r}async function S(e,t){if(!e)return"";if("fixed"===e.type)return e.fixedValue??"";if("request"===e.type){let r=e.requestConfig;if(!r?.url)throw Error("Request value source is missing URL");let s={...r,url:j(r.url,t),contentType:w(j(r.contentType,t)),body:j(r.body,t),responseJsonPath:j(r.responseJsonPath,t),headers:(r.headers||[]).map(e=>({key:j(e.key,t),value:j(e.value,t)}))},a=await C(s),n=a.extracted??a.json??a.text;return null==n?"":"string"==typeof n?n:JSON.stringify(n)}return""}e.s(["applyRequestTemplate",()=>j,"executeRequestWithRetry",()=>C,"resolveValueFromSource",()=>S],96185);var E=e.i(34589);let T=e=>e.endsWith("/")?e.replace(/\/+$/,""):e,R=e=>{let t=T(e.trim().replace(/^[a-z]+:\/\//i,""));return t?t.includes("/")?t:`${t}/*`:""},M=e=>{let t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\\*/g,".*");return RegExp(`^${t}$`,"i")};function D(e,t){let r=(e=>{if(!e)return"";try{let t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)return"";let r=t.pathname&&"/"!==t.pathname&&t.pathname.endsWith("/")?t.pathname.slice(0,-1):t.pathname||"/";return`${t.host}${r}`}catch{return T(e.replace(/^[a-z]+:\/\//i,""))}})(e);if(!t||0===t.length)return{allowed:!1,reason:"No allowed sites configured",target:r};if(!r)return{allowed:!1,reason:"No active tab URL available to check allowed sites",target:r};let s=r.startsWith("www.")?[r,r.slice(4)]:[r];for(let e of t){let t=R(e.host||"");if(!t)continue;let a=M(t);if(s.some(e=>a.test(e)))return{allowed:!0,matched:e.host,target:r}}return{allowed:!1,reason:"Current site not in allowed list",target:r}}let P="runyx:automation-state",A="[runner]";function I(e){let t=crypto.randomUUID();return window.parent.postMessage({__fromSandbox:!0,requestId:t,payload:e},"*"),new Promise((e,r)=>{let s=a=>{let n=a.data;n?.__fromExtension&&n.requestId===t&&(window.removeEventListener("message",s),n.error?r(Error(n.error)):e(n.response))};window.addEventListener("message",s)})}function L(){let e=(0,r.useContext)(a);if(!e)throw Error("useAutomation must be used within AutomationProvider");return e}function O({children:e}){let{projects:o,selectedProjectId:i,addWorkflowToProject:c,removeWorkflowFromProject:d}=(0,E.useProject)(),[p,h]=(0,r.useState)({[E.DEFAULT_PROJECT_ID]:s}),[f,g]=(0,r.useState)({[E.DEFAULT_PROJECT_ID]:s[0]?.id??""}),[v,b]=(0,r.useState)(!1),[y,w]=(0,r.useState)(null),[N,k]=(0,r.useState)(null),[T,R]=(0,r.useState)(!1),[M,L]=(0,r.useState)(!1),O=(0,r.useRef)(new Map),[q,z]=(0,r.useState)({}),F=(0,r.useRef)(new Set),_=(0,r.useRef)(new Map),U=(0,r.useRef)(new Map),V=(0,r.useRef)(new Map),W=(0,r.useRef)(new Map),[$,B]=(0,r.useState)(0),H=i??E.DEFAULT_PROJECT_ID,K=p[H]??[],G=f[H]??K[0]?.id??"",J=(0,r.useCallback)(e=>{h(t=>t[e]?t:{...t,[e]:[]}),g(t=>t[e]?t:{...t,[e]:""})},[]),X=(0,r.useCallback)(e=>o.find(t=>t.workflowIds.includes(e))?.id??H,[o,H]),Y=(0,r.useCallback)((e,t)=>{h(r=>{let s=t(r[e]??[]);return{...r,[e]:s}})},[]),Z=(0,r.useCallback)((e,t)=>{Y(X(e),r=>r.map(r=>r.id===e?t(r):r))},[X,Y]),Q=(0,r.useCallback)(e=>"paused"!==e.status,[]),ee=(0,r.useCallback)(e=>e.steps.map(e=>({id:"object"==typeof e&&"id"in e?e.id:crypto.randomUUID(),name:"object"==typeof e&&"name"in e?e.name:"Step",status:"pending",duration:"-"})),[]),et=(0,r.useCallback)((e,t)=>{Y(e,()=>t),g(r=>({...r,[e]:t[0]?.id??""}))},[Y]),er=(0,r.useCallback)(e=>p[e]??[],[p]);(0,r.useEffect)(()=>{let e=e=>{let t=e.data;if(t?.__fromExtension&&t.push){if(t.message?.type==="automation:pick:done"){let e=t.message.selector;w(e),N?.(e),k(null),b(!1)}t.message?.type==="automation:pick:cancel"&&(w(null),k(null),b(!1))}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[N]),(0,r.useEffect)(()=>{v&&(async()=>{try{let e=await I({type:"tabs.query",query:{active:!0,lastFocusedWindow:!0}}),t=e?.tabs?.[0]?.id??q.id,r=e?.tabs?.[0]?.url??q.url;if(t&&z({id:t,url:r}),!t){b(!1),k(null);return}await I({type:"tabs.sendMessage",tabId:t,message:{type:"picker:start"}})}catch(e){console.error("[picker] failed to start",e),b(!1),k(null)}})()},[v,q]),(0,r.useEffect)(()=>{T&&J(H)},[H,J,T]),(0,r.useEffect)(()=>{(async()=>{try{let e=await I({type:"storage.get",keys:[P]}),t=e?.data?.[P];t?.workflowsByProject&&"object"==typeof t.workflowsByProject&&h(e=>({...e,...t.workflowsByProject})),t?.selectedWorkflowByProject&&"object"==typeof t.selectedWorkflowByProject&&g(e=>({...e,...t.selectedWorkflowByProject})),"boolean"==typeof t?.isRunnerActive&&L(t.isRunnerActive)}catch(e){console.warn("[storage] failed to load automation state",e)}finally{R(!0)}})()},[]),(0,r.useEffect)(()=>{if(!T)return;let e=p[H]??[],t=f[H],r=!!t&&e.some(e=>e.id===t),s=e[0]?.id??"";r||s===t||g(e=>({...e,[H]:s}))},[T,H,f,p]),(0,r.useEffect)(()=>{T&&I({type:"storage.set",data:{[P]:{workflowsByProject:p,selectedWorkflowByProject:f,isRunnerActive:M}}}).catch(e=>console.warn("[storage] failed to persist automation state",e))},[T,M,f,p]);let es=(0,r.useCallback)(e=>{g(t=>({...t,[H]:e}))},[H]),ea=(0,r.useCallback)(e=>(p[X(e)]??[]).find(t=>t.id===e),[X,p]),en=(0,r.useCallback)((e,t)=>{Z(e,e=>({...e,...t,updatedAt:Date.now()}))},[Z]),el=(0,r.useCallback)(e=>{Y(H,t=>t.some(t=>t.id===e.id)?t:[...t,e]),g(t=>({...t,[H]:e.id})),c(H,e.id)},[H,c,Y]),eo=(0,r.useCallback)(e=>{let t=X(e),r="";Y(t,t=>{let s=t.filter(t=>t.id!==e);return r=s[0]?.id??"",s}),g(s=>s[t]===e?{...s,[t]:r}:s),d(t,e)},[X,d,Y]),ei=(0,r.useCallback)((e,t)=>{Z(e,e=>Q(e)?e:{...e,steps:[...e.steps,t],updatedAt:Date.now()})},[Q,Z]),ec=(0,r.useCallback)((e,t,r)=>{Z(e,e=>Q(e)?e:{...e,steps:e.steps.map(e=>e.id===t?{...e,...r}:e),updatedAt:Date.now()})},[Q,Z]),ed=(0,r.useCallback)((e,t)=>{Z(e,e=>Q(e)?e:{...e,steps:e.steps.filter(e=>e.id!==t),updatedAt:Date.now()})},[Q,Z]),eu=(0,r.useCallback)((e,t,r)=>{Z(e,e=>{if(Q(e))return e;let s=[...e.steps],[a]=s.splice(t,1);return s.splice(r,0,a),{...e,steps:s,updatedAt:Date.now()}})},[Q,Z]),ex=(0,r.useCallback)((e,t)=>{Z(e,e=>Q(e)?e:{...e,triggers:[...e.triggers,t],updatedAt:Date.now()})},[Q,Z]),em=(0,r.useCallback)((e,t,r)=>{Z(e,e=>Q(e)?e:{...e,triggers:e.triggers.map(e=>e.id===t?{...e,...r}:e),updatedAt:Date.now()})},[Q,Z]),ep=(0,r.useCallback)((e,t)=>{Z(e,e=>Q(e)?e:{...e,triggers:e.triggers.filter(e=>e.id!==t),updatedAt:Date.now()})},[Q,Z]),eh=(0,r.useCallback)((e,t)=>{Z(e,e=>({...e,runs:[t,...e.runs],runCount:e.runCount+1,lastRun:"Just now",updatedAt:Date.now()}))},[Z]),ef=(0,r.useCallback)((e,t,r)=>{Z(e,e=>({...e,runs:e.runs.map(e=>e.id===t?{...e,...r}:e),updatedAt:Date.now()}))},[Z]),eg=(0,r.useCallback)((e,t)=>{Z(e,e=>({...e,runs:e.runs.filter(e=>e.id!==t),updatedAt:Date.now()}))},[Z]),ev=(0,r.useCallback)(e=>{Z(e,e=>({...e,runs:[],updatedAt:Date.now()}))},[Z]),eb=(0,r.useCallback)((e,t)=>{Z(e,e=>({...e,settings:{...e.settings,...t},updatedAt:Date.now()}))},[Z]),ey=(0,r.useCallback)(e=>{let t=U.current.get(e);if(t){try{t.close()}catch(e){console.warn("[ws] failed to close existing connection",e)}U.current.delete(e)}let r=V.current.get(e);r?.reconnectTimer&&clearTimeout(r.reconnectTimer),V.current.delete(e),eb(e,{wsConnected:!1,wsConnectRequested:!0}),B(e=>e+1)},[]),ej=(0,r.useCallback)((e,t)=>{Z(e,e=>({...e,settings:{...e.settings,allowedSites:[...e.settings.allowedSites,t]},updatedAt:Date.now()}))},[Z]),ew=(0,r.useCallback)((e,t)=>{Z(e,e=>({...e,settings:{...e.settings,allowedSites:e.settings.allowedSites.filter(e=>e.host!==t)},updatedAt:Date.now()}))},[Z]),eN=(0,r.useCallback)((e,t,r,s)=>{Z(e,e=>{if(Q(e))return e;let a=e.steps.map(e=>e.id===t&&"if-else"===e.type?"if"===r?{...e,ifSteps:[...e.ifSteps,s]}:{...e,elseSteps:[...e.elseSteps,s]}:e);return{...e,steps:a,updatedAt:Date.now()}})},[Z]),ek=(0,r.useCallback)((e,t,r,s)=>{Z(e,e=>{if(Q(e))return e;let a=e.steps.map(e=>e.id===t&&"if-else"===e.type?"if"===r?{...e,ifSteps:e.ifSteps.filter(e=>e.id!==s)}:{...e,elseSteps:e.elseSteps.filter(e=>e.id!==s)}:e);return{...e,steps:a,updatedAt:Date.now()}})},[Z]),eC=(0,r.useCallback)((e,t,r,s,a)=>{Z(e,e=>{if(Q(e))return e;let n=e.steps.map(e=>e.id===t&&"if-else"===e.type?"if"===r?{...e,ifSteps:e.ifSteps.map(e=>e.id===s?{...e,...a}:e)}:{...e,elseSteps:e.elseSteps.map(e=>e.id===s?{...e,...a}:e)}:e);return{...e,steps:n,updatedAt:Date.now()}})},[Z]),eS=(0,r.useCallback)((e,t,r)=>{Z(e,e=>({...e,variables:{...e.variables,[t]:r},updatedAt:Date.now()}))},[Z]),eE=(0,r.useCallback)((e,t)=>{Z(e,e=>{let r={...e.variables};return delete r[t],{...e,variables:r,updatedAt:Date.now()}})},[Z]),eT=(0,r.useCallback)(()=>{L(!0)},[]),eR=(0,r.useCallback)(()=>{L(O.current.size>0)},[]),eM=(0,r.useCallback)(()=>{O.current.forEach(e=>{e.stopFlag.current=!0}),L(O.current.size>0)},[]),eD=(0,r.useCallback)(async(e,t)=>{let r=ea(e);if(!r)return;let s=t?.trigger??"manual",a=`run-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,l={current:!1};O.current.set(a,{workflowId:e,stopFlag:l}),L(!0);let o=Math.max(0,r.settings?.maxRetries??0),i={...r.variables||{}},c=t?.context?.tabId,d=t?.context?.url,p={...i},h=e=>e?e.trim().replace(/^vars\./i,""):"",f=e=>{let t=Date.now(),s=new Date(t).toISOString();return{vars:p,workflowId:r.id,workflowName:r.name,workflow:r.name,date:s.slice(0,10),stepName:e?.name,step:e?.name||e?.id,stepId:e?.id,url:d??q.url,timestamp:Math.floor(t/1e3),timestampMs:t,isoTimestamp:s}},g=async(e,t,r)=>{let s;if(!e.serverUpload?.enabled)return;let a=e.serverUpload,n=j(a.url,r).trim();if(!n)throw Error("Upload URL is required");let l=a.dataField||"screenshot",o=(a.headers||[]).reduce((e,t)=>{let s=j(t.key,r).trim();return s&&(e[s]=j(t.value,r)),e},{}),i=Object.keys(o).some(e=>"content-type"===e.toLowerCase()),c={...r,dataField:l,data:t.base64,dataUrl:t.dataUrl,fileName:t.fileName,format:e.format,width:t.width,height:t.height};s=a.bodyTemplate?j(a.bodyTemplate,c):JSON.stringify({[l]:t.base64,fileName:t.fileName,format:e.format,width:t.width,height:t.height,timestamp:r.timestampMs??Date.now()});let d=await fetch(n,{method:a.method||"POST",headers:{...i?{}:{"Content-Type":"application/json"},...o},body:s});if(!d.ok){let e="";try{e=await d.text()}catch{}let t=e?`: ${e}`:"";throw Error(`Upload failed with status ${d.status}${t}`)}};try{let v=Date.now(),b=!1,y=!1,w=async o=>{let i,w="running";try{if(!c||!d){let e=await I({type:"tabs.query",query:{active:!0,lastFocusedWindow:!0}});c=c??e?.tabs?.[0]?.id,d=d??e?.tabs?.[0]?.url}z({id:c,url:d})}catch(e){console.warn(A,"failed to query tabs",e)}let N=ee(r),k=D(d??q.url,r.settings?.allowedSites);if(!k.allowed){let t=k.reason||"Current site is not in the allowed list.";if(console.warn(A,"blocked by allowedSites",{reason:t,target:k.target}),y){let r=Date.now();ef(e,a,{status:"failed",steps:N,endTime:r,duration:`${((r-v)/1e3).toFixed(2)}s`,error:t})}else alert(t);return"failed"}if(b||(eT(),b=!0),y)ef(e,a,{status:"running",steps:N,error:void 0,context:{url:d??t?.context?.url,tabId:c??t?.context?.tabId,variables:p}});else{let n={id:a,workflowId:r.id,status:"running",trigger:s,startTime:v,steps:N,context:{url:d??t?.context?.url,tabId:c??t?.context?.tabId,variables:p},artifacts:[]};eh(e,n),y=!0}let E=(t,r,s,n)=>{N=N.map(e=>e.id!==t?e:{...e,status:r,duration:s??e.duration,error:n}),ef(e,a,{steps:N}),n&&!i&&(i=n)},T=()=>{N=N.map(e=>"pending"===e.status||"running"===e.status?{...e,status:"skipped",error:"Cancelled"}:e),w="cancelled",ef(e,a,{steps:N})},R=async(e,t)=>{let r=t?.targetTabId??c??q.id;if(!r)throw Error("No tab available to run this step. Click the extension icon on the target page first.");let s=await I({type:"tabs.sendMessage",tabId:r,message:{type:"automation:run:step",step:e}});return s?.res??s},M=async(t,s,l,o,i)=>{var v,b;if("goTo"===t.type){let e,a,n=f(t),u=j(t.goToUrl||"",n).trim();if(!u)return l("Target URL is required");let x=D(u,r.settings?.allowedSites);if(!x.allowed)return l(x.reason||"Target URL is not in the allowed list.");let m=c??q.id;if(!m)return l("No tab available to navigate. Click the extension icon on the target page first.");let p=(e="number"==typeof t.timeout?t.timeout:15e3,a=d,new Promise((t,r)=>{let s=Date.now(),n=e=>{if(!e)return!1;if(e===u||e.startsWith(u))return!0;try{let t=new URL(u),r=new URL(e);if(t.origin===r.origin&&r.pathname.startsWith(t.pathname))return!0}catch{}return!1},l=(e,t,r)=>{window.removeEventListener("message",e),clearTimeout(t),clearInterval(r)},o=e=>{let r=e.data;if(!r?.__fromExtension||!r.push||r.message?.type!=="automation:browserEvent")return;let s=r.message;if(s.tabId!==m||"navigation:completed"!==s.event&&"tabs:updated"!==s.event||!s.url)return;let d=!a||s.url!==a;(n(s.url)||d)&&(l(o,i,c),t(s.url))},i=setTimeout(()=>{l(o,i,c);let e=Date.now()-s;r(Error(`Navigation timed out after ${e}ms`))},Math.max(1e3,e)),c=setInterval(()=>{(async()=>{try{let e=await I({type:"tabs.query",query:{}}),r=(e?.tabs||[]).find(e=>e?.id===m),s=r?.url;if(!s)return;let d=!a||s!==a;(n(s)||d)&&(l(o,i,c),t(s))}catch{}})()},350);window.addEventListener("message",o)}));return await I({type:"tabs.update",tabId:m,updateProperties:{url:u}}),d=await p||u,z({id:m,url:d}),o("success",s()),{action:"continue",nextIndex:i}}if("click"===t.type){let e=t.selector;if(!e)return l("Missing selector");let r=await R({type:"click",selector:e,clickMode:t.clickMode,timeout:t.timeout});return r?.ok?(o("success",s()),{action:"continue",nextIndex:i}):l(r?.error||"Click failed")}if("wait"===t.type){let e={...u,...t.waitConfig,selector:t.waitConfig?.selector??t.selector},r=await R({type:"wait",waitConfig:e,timeout:t.timeout??e.timeMs??5e3});return r?.ok?(o("success",s()),{action:"continue",nextIndex:i}):l(r?.error||"Wait failed")}if("type"===t.type){if(!t.selector)return l("Missing selector");let e=t.valueSource?await S(t.valueSource,f(t)):t.value??"",r=await R({type:"type",selector:t.selector,value:e??""});return r?.ok?(o("success",s()),{action:"continue",nextIndex:i}):l(r?.error||"Type failed")}if("select"===t.type){if(!t.selector)return l("Missing selector");let e=t.value??"";try{e=t.valueSource?await S(t.valueSource,f(t)):t.value??""}catch(e){return l(e?.message||String(e))}let r=await R({type:"select",selector:t.selector,value:e??"",timeout:t.timeout??5e3});return r?.ok?(o("success",s()),{action:"continue",nextIndex:i}):l(r?.error||"Select failed")}if("scroll"===t.type){let e={scrollType:"toSelector",behavior:"smooth",...t.scrollConfig,selector:t.scrollConfig?.selector||t.selector};if(("toSelector"===e.scrollType||"intoView"===e.scrollType)&&!e.selector)return l("Selector is required for this scroll type");let r=await R({type:"scroll",config:e,scrollConfig:e,selector:e.selector,timeout:t.timeout??5e3});return r?.ok?(o("success",s()),{action:"continue",nextIndex:i}):l(r?.error||"Scroll failed")}if("evaluate"===t.type){let r,a={...n,...t.evaluateConfig||{}},c=f(t),d=j(a.code||"",c).trim();if(!d)return l("Code is required for evaluate");let u=async()=>{if("specificTab"===a.target){let e=j(a.specificTabId||"",c).trim(),t=Number(e);if(!Number.isFinite(t))throw Error("Invalid tab id for evaluate");return t}if("anyTabMatchingScope"===a.target){let e=(a.scopeUrlRegex||"").trim();if(!e)throw Error("Scope regex is required for tab matching");let t=await I({type:"tabs.query",scopeUrlRegex:e}),r=(t?.tabs||[]).find(t=>t?.url&&new RegExp(e).test(t.url));if(!r?.id)throw Error("No tab matches the provided scope regex");return r.id}},x=(e,t)=>{let r=j(e.value??"",c),s=e.name?.trim()||`arg${t+1}`;try{switch(e.type){case"number":{let e=Number(r);if(!Number.isFinite(e))throw Error("Expected a number");return{name:s,rawValue:r,value:e}}case"boolean":{let e=String(r).trim().toLowerCase();if(["true","1","yes","on"].includes(e))return{name:s,rawValue:r,value:!0};if(["false","0","no","off",""].includes(e))return{name:s,rawValue:r,value:!1};return{name:s,rawValue:r,value:!!r}}case"json":return{name:s,rawValue:r,value:JSON.parse(r||"null")};default:return{name:s,rawValue:r,value:r}}}catch(t){let e=t?.message||String(t);throw Error(`Argument "${s}" is invalid: ${e}`)}},m=[];if("expression"!==a.mode)for(let[e,t]of(a.args||[]).entries()){let r=x(t,e);m.push({...t,name:r.name,value:r.rawValue,resolvedValue:r.value})}let g={...a,code:d,args:m};try{r=await u()}catch(e){return l(e?.message||String(e))}let v=await R({type:"evaluate",config:g,evaluateConfig:g,vars:p},{targetTabId:r}),b=!!v?.ok,y=v?.result,w=v?.error||"Evaluate failed";if(b){let e="string"===a.expect&&"string"!=typeof y?{ok:!1,error:"Expected a string result"}:"number"!==a.expect||"number"==typeof y&&Number.isFinite(y)?"boolean"===a.expect&&"boolean"!=typeof y?{ok:!1,error:"Expected a boolean result"}:"object"===a.expect&&(null===y||Array.isArray(y)||"object"!=typeof y)?{ok:!1,error:"Expected an object result"}:"array"!==a.expect||Array.isArray(y)?a.failOnFalsy&&!y?{ok:!1,error:"Result is falsy"}:{ok:!0}:{ok:!1,error:"Expected an array result"}:{ok:!1,error:"Expected a number result"};e.ok||(b=!1,w=e.error||w)}let N=h(a.saveAs||t.saveTo);if(N&&(b||!a.saveOnlyIfOk)){let t="string"==typeof y?y:JSON.stringify(y??"");eS(e,N,t),p={...p,[N]:t}}return b?(o("success",s()),{action:"continue",nextIndex:i}):l(w)}if("request"===t.type){let r=f(t),a=j(t.serverUrl,r).trim();if(!a)return l("Request URL is required");try{let n=await C({url:a,method:t.requestMethod||"GET",contentType:j(t.requestContentType,r),headers:(t.headers||[]).map(e=>({key:j(e.key,r).trim(),value:j(e.value,r)})).filter(e=>e.key),body:j(t.requestBody,r),responseJsonPath:j(t.responseJsonPath,r),retry:{enabled:!1,maxRetries:0,conditionType:"jsonField"}});if(n.status>=400)return l(`Request failed with status ${n.status}`);if(t.saveTo){let r=h(t.saveTo);if(r){let t=n.extracted??n.json??n.text??"",s="string"==typeof t?t:JSON.stringify(t??"");eS(e,r,s),p={...p,[r]:s}}}return o("success",s()),{action:"continue",nextIndex:i}}catch(e){return l(e?.message||String(e))}}if("sendCookies"===t.type){let e=f(t),r=j(t.serverUrl,e).trim();if(!r)return l("Server URL is required");let a=(t.headers||[]).map(t=>({key:j(t.key,e).trim(),value:j(t.value,e)})).filter(e=>e.key),n=!1!==t.cookieAll,u=t.cookieDomain||void 0,x=(t.cookieNames||[]).filter(Boolean);try{let e=await I({type:"cookies.sendToServer",serverUrl:r,method:t.requestMethod||"POST",headers:a,cookieAll:n,cookieDomain:u,cookieNames:x,tabId:c,tabUrl:d});if(e?.ok)return o("success",s()),{action:"continue",nextIndex:i};let m=e?.error||`Cookie send failed (status ${e?.status??"?"})`;return l(m)}catch(e){return l(e?.message||String(e))}}if("sendPageSource"===t.type){let e=f(t),r=j(t.serverUrl,e).trim();if(!r)return l("Server URL is required");let a=(t.headers||[]).map(t=>({key:j(t.key,e).trim(),value:j(t.value,e)})).filter(e=>e.key),n=t.requestMethod&&["POST","PUT"].includes(t.requestMethod)?t.requestMethod:"POST";try{let e=await I({type:"pageSource.sendToServer",serverUrl:r,method:n,headers:a,tabId:c,tabUrl:d});if(e?.ok)return o("success",s()),{action:"continue",nextIndex:i};let t=e?.error||`Page source send failed (status ${e?.status??"?"})`;return l(t)}catch(e){return l(e?.message||String(e))}}if("extract"===t.type){let r={...x,...t.extractConfig||{},selector:t.extractConfig?.selector||t.selector||""};if(!r.selector)return l("Selector is required for extract");let a=await R({type:"extract",config:r,selector:r.selector,timeout:t.timeout??5e3});if(a?.ok){let n=h(r.saveAs||t.saveTo);if(n){let t=void 0!==a.value?a.value:void 0!==a.values?a.values:void 0!==a.rawValues?a.rawValues:"",r="string"==typeof t?t:JSON.stringify(t??"",null,2);eS(e,n,r),p={...p,[n]:r}}return o("success",s()),{action:"continue",nextIndex:i}}return l(a?.error||"Extract failed")}if("screenshot"===t.type){let r,n,c,d,u={...m,...t.screenshotConfig||{},selector:t.screenshotConfig?.selector||t.selector||""},x={...f(t),fileNameTemplate:u.fileNameTemplate},y=(v=u.fileNameTemplate,b=u.format,r=j(v||"",x).trim(),n=`screenshot_${x.timestamp||Math.floor(Date.now()/1e3)}`,c=(r||n).replace(/[\\/:*?"<>|]+/g,"_").replace(/\s+/g,"_").replace(/\.+$/,""),d="jpeg"===b?"jpg":"png",c.toLowerCase().endsWith(`.${d}`)?c:`${c}.${d}`),w=async e=>"continue"===u.onFail?(o("skipped",s(),e||"Screenshot skipped"),{action:"continue",nextIndex:i}):l(e),N=await R({type:"screenshot",config:u,screenshotConfig:u,selector:u.selector,fileName:y});if(!N?.ok||!N.dataUrl)return w(N?.error||"Screenshot failed");let k=N.dataUrl,C=N.base64||("string"==typeof k&&k.includes(",")?k.split(",")[1]:"");try{await g(u,{dataUrl:k,base64:C,fileName:y,width:N.width,height:N.height},{...x,fileName:y})}catch(e){return w(e?.message||String(e))}try{if("downloads"===u.saveTo)await I({type:"download.dataUrl",dataUrl:k,fileName:y});else if("varsBase64"===u.saveTo){let r=h(u.saveAs||t.saveTo||"screenshot");r&&(eS(e,r,C),p={...p,[r]:C})}else if("runnerArtifacts"===u.saveTo){let t=ea(e),r=t?.runs.find(e=>e.id===a),s=r?.artifacts||[],n={id:`${a}-screenshot-${Date.now()}`,type:"screenshot",name:y,dataUrl:k,createdAt:Date.now(),width:N.width,height:N.height};ef(e,a,{artifacts:[...s,n]})}}catch(e){return w(e?.message||String(e))}return o("success",s()),{action:"continue",nextIndex:i}}return o("skipped",s(),"Not implemented yet"),{action:"continue",nextIndex:i}},P=async(t,r,s)=>{let n,o=new Map;r.forEach((e,r)=>{let a=e.id||`${t}-${s}-${r}`;o.set(a,r)});let c=0,d=5*r.length||5;for(;c<r.length&&c<d;){if(l.current)return{status:"cancelled"};let d=r[c],u=d.id||`${t}-${s}-${c}`,x=Date.now(),m=()=>`${((Date.now()-x)/1e3).toFixed(2)}s`,p=`${t}:${u}:${s}`,h=(t,r,l)=>{let o={id:p,name:`${s} > ${d.name}`,status:t,duration:r,error:l},c=N.findIndex(e=>e.id===p);N=c>=0?N.map((e,t)=>t===c?{...e,...o}:e):[...N,{...o,duration:r??"-"}],ef(e,a,{steps:N}),l&&!i&&(i=l),l&&(n=l)};if(!1===d.enabled){h("skipped",m(),"Disabled"),c+=1;continue}let f=async e=>{let t=d.onFailure||"stop",r=d.gotoStep,s=d.fallbackCode;if("skip"===t)return h("skipped",m(),e||"Skipped"),{action:"continue",nextIndex:c+1};if("goto"===t){let t=r?o.get(r):void 0;return void 0===t||t===c?(h("failed",m(),e||"Goto target not found"),{action:"stop"}):(h("skipped",m(),e||"Jumping to another step"),{action:"jump",nextIndex:t})}if("fallback"===t){if(!s)return h("failed",m(),e||"Fallback code missing"),{action:"stop"};try{let e=await R({type:"fallback",code:s});if(e?.ok)return h("success",m(),"Fallback executed"),{action:"continue",nextIndex:c+1};return h("failed",m(),e?.error||"Fallback failed"),{action:"stop"}}catch(e){return h("failed",m(),String(e)),{action:"stop"}}}return h("failed",m(),e||"Step failed"),{action:"stop"}};h("running","-");let g=await M(d,m,f,h,c+1);if("jump"===g.action&&"number"==typeof g.nextIndex){c=g.nextIndex;continue}if("continue"===g.action){c=g.nextIndex??c+1;continue}return{status:"failed",error:n}}return{status:"success",error:n}},L=r.steps,O=new Map;L.forEach((e,t)=>{let r=e.id||`step-${t}`;O.set(r,t)});let F=0,_=5*L.length;for(;F<L.length&&F<_;){if(l.current){T();break}let e=L[F],t=e.id||`step-${F}`,r=Date.now(),s=()=>`${((Date.now()-r)/1e3).toFixed(2)}s`;if(!1===e.enabled){E(t,"skipped",s(),"Disabled"),F+=1;continue}let a=async r=>{let a=e.onFailure||"stop",n=e.gotoStep,l=e.fallbackCode;if("skip"===a)return E(t,"skipped",s(),r||"Skipped"),{action:"continue",nextIndex:F+1};if("goto"===a){let e=n?O.get(n):void 0;return void 0===e?(E(t,"failed",s(),r||"Goto target not found"),w="failed",{action:"stop"}):e===F?(E(t,"failed",s(),"Goto target is the same step; aborting"),w="failed",{action:"stop"}):(E(t,"skipped",s(),r||"Jumping to another step"),{action:"jump",nextIndex:e})}if("fallback"===a){if(!l)return E(t,"failed",s(),r||"Fallback code missing"),w="failed",{action:"stop"};try{let e=await R({type:"fallback",code:l});if(e?.ok)return E(t,"success",s(),"Fallback executed"),{action:"continue",nextIndex:F+1};return E(t,"failed",s(),e?.error||"Fallback failed"),w="failed",{action:"stop"}}catch(e){return E(t,"failed",s(),String(e)),w="failed",{action:"stop"}}}return E(t,"failed",s(),r||"Step failed"),w="failed",{action:"stop"}};try{if(E(t,"running","-",void 0),"if-else"===e.type){let r=await R({type:"condition:check",condition:e.condition});if(!r?.ok){let e=await a(r?.error||"Condition evaluation failed");if("jump"===e.action&&"number"==typeof e.nextIndex)F=e.nextIndex;else if("continue"===e.action)F+=1;else break;continue}let n=!!r.result,l=n?"IF":"ELSE",o=n?e.ifSteps:e.elseSteps,c=await P(e.id,o,l);if("cancelled"===c.status){T();break}if("failed"===c.status){let e=c.error||`${l} branch failed`;E(t,"failed",s(),e),w="failed",i||(i=e);break}E(t,"success",s(),`${l} branch executed`),F+=1;continue}let r=await M(e,s,a,(e,r,s)=>E(t,e,r,s),F+1);if("jump"===r.action&&"number"==typeof r.nextIndex)F=r.nextIndex;else if("continue"===r.action)F=r.nextIndex??F+1;else break}catch(t){let e=await a(String(t));if("jump"===e.action)F=e.nextIndex;else if("continue"===e.action)F+=1;else break}if(l.current){T();break}}let U=Date.now();return l.current?w="cancelled":"failed"!==w&&(w="success"),ef(e,a,{status:w,endTime:U,duration:`${((U-v)/1e3).toFixed(2)}s`,error:i}),w},N=0,k="failed";for(;0===N||"failed"===k&&N<=o&&!l.current;){if(p={...i},k=await w(N),N+=1,"failed"===k&&N<=o&&!l.current){console.warn(`${A} retrying attempt ${N}/${o}`);continue}if("failed"!==k||N>o||l.current)break}b&&eR()}finally{O.current.delete(a),L(O.current.size>0)}},[eh,ee,ea,q,eS,eT,eR,ef]),eP=(0,r.useCallback)(e=>{switch(e){case"browserEvent":return"browser";case"domCondition":return"dom";case"schedule":return"schedule";case"webhookWs":return"websocket";default:return"manual"}},[]),eA=(0,r.useCallback)(e=>{let t=0;return O.current.forEach(r=>{r.workflowId!==e||r.stopFlag.current||(t+=1)}),t},[]),eI=(0,r.useCallback)(e=>{O.current.forEach(t=>{t.workflowId===e&&(t.stopFlag.current=!0)})},[]),eL=(0,r.useCallback)((e,t,r)=>{let s=ea(e);if(!s||"paused"===s.status)return;let a=s.settings?.triggerPolicy||l,n=eA(e),o=Math.max(1,a.parallelLimit||l.parallelLimit);"single"===a.mode&&n>0||("restart"===a.mode&&n>0&&eI(e),"parallel"===a.mode&&n>=o||(em(e,t.id,{lastEvent:new Date().toLocaleTimeString()}),eD(e,{trigger:eP(t.type),context:r})))},[eI,eA,ea,eP,eD,em]),eO=(0,r.useCallback)(async(e,t)=>{let r,s,a=ea(e);if(!a)return void console.debug("[ws] skip (workflow not found)",{workflowId:e});let n=(a.triggers||[]).filter(e=>"webhookWs"===e.type&&e.enabled);if(0===n.length)return void console.debug("[ws] skip (no enabled ws triggers)",{workflowId:e});let l="";if(!(l=(l="string"==typeof t?t:t instanceof Blob?await t.text():t instanceof ArrayBuffer?new TextDecoder().decode(t):String(t??"")).trim()))return void console.debug("[ws] skip (empty message)",{workflowId:e});let o=l;try{let e=JSON.parse(l);e&&"string"==typeof e.event&&(o=e.event,r="string"==typeof e.channel?e.channel:void 0,s="string"==typeof e.token?e.token:void 0)}catch{}if(!o)return;console.log("[ws] message received",{workflowId:e,raw:l,eventName:o,channel:r,token:s?"***":""});let i=Date.now();n.forEach(t=>{let a=t.config,n=(a.channel||"").trim(),l=(r||"").trim(),c=!n||n===l||"default"===n&&!l,d=!a.authToken||a.authToken===(s||""),u=(a.eventName||"").trim()===o,x=Number(a.dedupeWindowMs)||0,m=W.current.get(t.id)||0,p=x>0&&i-m<x;(console.log("[ws] incoming",{workflowId:e,triggerId:t.id,triggerName:t.name,eventName:o,cfgEvent:a.eventName,cfgChannel:n,incomingChannel:l,channelMatch:c,tokenMatch:d,deduped:p}),u&&c&&d&&!p)?(W.current.set(t.id,i),console.log("[ws] firing trigger",{workflowId:e,triggerId:t.id,triggerName:t.name}),eL(e,t,{})):console.log("[ws] skip trigger",{triggerId:t.id,reason:u?c?d?"dedupe":"token":"channel":"event"})})},[ea,eL]);(0,r.useEffect)(()=>{if(!T)return;let e=(e,t)=>{let r=V.current.get(e);if(r?.reconnectTimer)return;let s=setTimeout(()=>{V.current.delete(e),U.current.delete(e),B(e=>e+1)},2e3);V.current.set(e,{endpoint:t,reconnectTimer:s})};K.forEach(t=>{if((e=>{let t=(e.settings?.wsEndpoint||"").trim();if(!t||"wss://your-server.com/ws"===t)return!1;let r=(e.triggers||[]).some(e=>"webhookWs"===e.type&&e.enabled),s=e.settings?.wsConnectRequested;return!!(t&&("paused"!==e.status||s)&&(r||s))})(t))(t=>{let r=t.settings?.wsEndpoint;if(!r)return;let s=U.current.get(t.id),a=V.current.get(t.id);if(!s||a?.endpoint!==r||s.readyState===WebSocket.CLOSING||s.readyState===WebSocket.CLOSED){if(s){try{s.close()}catch(e){console.warn("[ws] failed to close stale connection",e)}U.current.delete(t.id)}a?.reconnectTimer&&clearTimeout(a.reconnectTimer);try{let s=new WebSocket(r);V.current.set(t.id,{endpoint:r}),eb(t.id,{wsConnected:!1}),s.onopen=()=>{eb(t.id,{wsConnected:!0,wsConnectRequested:!0})},s.onclose=()=>{eb(t.id,{wsConnected:!1,wsConnectRequested:!0}),e(t.id,r)},s.onerror=()=>{eb(t.id,{wsConnected:!1,wsConnectRequested:!0})},s.onmessage=e=>{eO(t.id,e.data)},U.current.set(t.id,s)}catch(s){console.warn("[ws] failed to connect",s),eb(t.id,{wsConnected:!1}),e(t.id,r)}}})(t);else{let e=U.current.get(t.id);if(e){try{e.close()}catch(e){console.warn("[ws] failed to close unused connection",e)}U.current.delete(t.id)}let r=V.current.get(t.id);r?.reconnectTimer&&clearTimeout(r.reconnectTimer),V.current.delete(t.id),t.settings?.wsConnected&&eb(t.id,{wsConnected:!1})}})},[eO,T,eb,K,$]),(0,r.useEffect)(()=>()=>{U.current.forEach(e=>{try{e.close()}catch(e){console.warn("[ws] failed to close on cleanup",e)}}),U.current.clear(),V.current.forEach(e=>{e.reconnectTimer&&clearTimeout(e.reconnectTimer)}),V.current.clear()},[]),(0,r.useEffect)(()=>{if(!T)return;let e=K.flatMap(e=>(e.triggers||[]).filter(t=>"browserEvent"===t.type&&t.enabled&&"paused"!==e.status).map(t=>({workflowId:e.id,trigger:t})));if(0===e.length)return;let t=(e,t)=>{try{if("hostEquals"===e.urlMatchType){let r=new URL(t),s=(()=>{try{return new URL(e.urlValue).host||e.urlValue}catch{return e.urlValue}})()?.trim().toLowerCase();return r.host.toLowerCase()===s}if("contains"===e.urlMatchType){let r=(e.urlValue||"").trim();return!!r&&t.includes(r)}if("regex"===e.urlMatchType){let r=(e.urlValue||"").trim();if(!r)return!1;return new RegExp(r).test(t)}}catch(e){console.warn("[trigger:browser] match failed",e)}return!1},r=async(e,t)=>{if(void 0!==t)return t;if(!e)return!1;try{let t=await I({type:"tabs.query",query:{active:!0,lastFocusedWindow:!0}});return(t?.tabs||[]).some(t=>t.id===e&&t.active)}catch{return!1}},s=async s=>{let{event:a,tabId:n,url:l,active:o}=s;if(!l)return;let i=Date.now();for(let s of e){let e=s.trigger,c=e.config;if(c.event!==a||!t(c,l)||c.onlyIfTabActive&&!await r(n,o))continue;let d=_.current.get(e.id)||0;(!c.debounceMs||!(i-d<c.debounceMs))&&(c.runOncePerSession&&F.current.has(e.id)||(_.current.set(e.id,i),c.runOncePerSession&&F.current.add(e.id),eL(s.workflowId,e,{url:l,tabId:n})))}},a=e=>{let t=e.data;if(!t?.__fromExtension||!t.push||t.message?.type!=="automation:browserEvent")return;let r=t.message;s({event:r.event,tabId:r.tabId,url:r.url,active:r.active})};return window.addEventListener("message",a),()=>window.removeEventListener("message",a)},[eL,T,K]);let eq=(0,r.useMemo)(()=>{let e=K.flatMap(e=>(e.triggers||[]).filter(t=>"schedule"===t.type&&t.enabled&&"paused"!==e.status).map(t=>({workflowId:e.id,trigger:t}))),t=JSON.stringify(e.map(e=>{let t=e.trigger.config;return{workflowId:e.workflowId,triggerId:e.trigger.id,enabled:e.trigger.enabled,mode:t.mode,everyMinutes:t.everyMinutes,everyMs:t.everyMs,dailyTime:t.dailyTime,timezone:t.timezone,jitterMs:t.jitterMs,cronExpression:t.cronExpression||""}}));return{entries:e,signature:t}},[K]);return(0,r.useEffect)(()=>{if(!T)return;let e=[],t=eq.entries,r=t=>{let s=t.trigger.config,a=Math.max(0,s.jitterMs||0),n=0,l=setTimeout(async()=>{let e=new Date;"cronLike"===s.mode?s.cronExpression&&((e,t,r)=>{let s=e.trim().split(/\s+/);if(s.length<5)return!1;let[a,n,l,o,i]=s,c="UTC"===r?t.getUTCMinutes():t.getMinutes(),d="UTC"===r?t.getUTCHours():t.getHours(),u="UTC"===r?t.getUTCDate():t.getDate(),x=("UTC"===r?t.getUTCMonth():t.getMonth())+1,m="UTC"===r?t.getUTCDay():t.getDay(),p=(e,t)=>{if("*"===e)return!0;if(e.startsWith("*/")){let r=Number(e.slice(2));return r>0&&t%r==0}return e.split(",").some(e=>{if(e.includes("-")){let[r,s]=e.split("-").map(Number);if(Number.isFinite(r)&&Number.isFinite(s))return t>=r&&t<=s}let r=Number(e);return Number.isFinite(r)&&r===t})};return p(a,c)&&p(n,d)&&p(l,u)&&p(o,x)&&p(i,m)})(s.cronExpression,e,s.timezone||"local")&&eL(t.workflowId,t.trigger,{}):eL(t.workflowId,t.trigger,{}),r(t)},(n="everyMinutes"===s.mode?Math.max(6e4,60*(s.everyMinutes||1)*1e3):"everyMs"===s.mode?Math.max(10,s.everyMs||0):"dailyAt"===s.mode?((e,t)=>{let[r,s]=e.split(":"),a=Number(r),n=Number(s),l=new Date,o=new Date(l);return"UTC"===t?o.setUTCHours(a,n,0,0):o.setHours(a,n,0,0),o.getTime()<=l.getTime()&&("UTC"===t?o.setUTCDate(o.getUTCDate()+1):o.setDate(o.getDate()+1)),o.getTime()-l.getTime()})(s.dailyTime||"09:00",s.timezone||"local"):6e4)+(a?Math.floor(Math.random()*a):0));e.push(l)};return t.forEach(r),()=>{e.forEach(e=>clearTimeout(e))}},[eL,T,eq.signature]),(0,r.useEffect)(()=>{if(!T)return;let e=K.flatMap(e=>(e.triggers||[]).filter(t=>"domCondition"===t.type&&t.enabled&&"paused"!==e.status).map(t=>({workflowId:e.id,trigger:t})));if(0===e.length)return;let t=new Set,r=[],s=async e=>{try{if("anyTabMatchingScope"===e.targetTabScope&&e.scopeUrlRegex){let t=await I({type:"tabs.query",scopeUrlRegex:e.scopeUrlRegex}),r=t?.tabs||[];return r[0]?.id}let t=await I({type:"tabs.query",query:{active:!0,lastFocusedWindow:!0}});return t?.tabs?.[0]?.id}catch(e){console.warn("[trigger:dom] failed to resolve tab",e);return}};return e.forEach(e=>{var a,n;let l,o;return a=e.workflowId,l=(n=e.trigger).config,void(o=async()=>{if(t.has(n.id))return;let e=await s(l);if(!e){let e=setTimeout(o,1500);r.push(e);return}let i=(e=>{let t={selector:e.selector,text:e.text,attributeName:e.attributeName,attributeValue:e.attributeValue,intervalMs:250,strategy:"observer",requireStableMs:0,invert:!1,textScope:"insideSelector"};switch(e.condition){case"selectorAppears":default:return{...t,waitFor:"selectorAppears"};case"selectorDisappears":return{...t,waitFor:"selectorDisappears"};case"textContains":return{...t,waitFor:"textContains"};case"attributeEquals":return{...t,waitFor:"attributeEquals"};case"elementEnabled":return{...t,waitFor:"elementEnabled"}}})(l);try{let s=await I({type:"tabs.sendMessage",tabId:e,message:{type:"automation:domCondition:wait",config:i,timeoutMs:l.timeoutMs||1e4}});if((s?.ok??s?.res?.ok)&&!t.has(n.id)){if(eL(a,n,{tabId:e}),"everyTime"===l.fireMode){let e=Math.max(0,l.cooldownMs||0),t=setTimeout(o,e);r.push(t)}return}}catch(e){console.warn("[trigger:dom] watch failed",e)}if(!t.has(n.id)){let e=setTimeout(o,Math.max(500,l.cooldownMs||500));r.push(e)}})()}),()=>{e.forEach(e=>t.add(e.trigger.id)),r.forEach(e=>clearTimeout(e))}},[eL,T,K]),(0,t.jsx)(a.Provider,{value:{workflows:K,selectedWorkflowId:G,setSelectedWorkflowId:es,getWorkflow:ea,updateWorkflow:en,addWorkflow:el,deleteWorkflow:eo,addStep:ei,updateStep:ec,deleteStep:ed,reorderSteps:eu,addStepToBlock:eN,deleteStepFromBlock:ek,updateStepInBlock:eC,setVariable:eS,deleteVariable:eE,addTrigger:ex,updateTrigger:em,deleteTrigger:ep,addRun:eh,updateRun:ef,deleteRun:eg,clearRuns:ev,updateSettings:eb,addAllowedSite:ej,removeAllowedSite:ew,restartWebsocket:ey,isPicking:v,setIsPicking:b,pickedSelector:y,setPickedSelector:w,onPickComplete:N,setOnPickComplete:k,lastKnownTab:q,setLastKnownTab:z,getWorkflowsForProject:er,setWorkflowsForProject:et,isRunnerActive:M,startRunner:eT,stopRunner:eR,requestStopRunner:eM,runWorkflow:eD},children:e})}e.s(["AutomationProvider",()=>O,"useAutomation",()=>L],46385)},23204,e=>{"use strict";let t,r,s;var a,n,l,o,i,c,d,u,x,m=e.i(1717),p=e.i(34589),h=e.i(9814),f=e.i(46385);function g(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function v(...e){return t=>{let r=!1,s=e.map(e=>{let s=g(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():g(e[t],null)}}}}function b(...e){return h.useCallback(v(...e),e)}var y=h.forwardRef((e,t)=>{let{children:r,...s}=e,a=h.Children.toArray(r),n=a.find(N);if(n){let e=n.props.children,r=a.map(t=>t!==n?t:h.Children.count(e)>1?h.Children.only(null):h.isValidElement(e)?e.props.children:null);return(0,m.jsx)(j,{...s,ref:t,children:h.isValidElement(e)?h.cloneElement(e,void 0,r):null})}return(0,m.jsx)(j,{...s,ref:t,children:r})});y.displayName="Slot";var j=h.forwardRef((e,t)=>{let{children:r,...s}=e;if(h.isValidElement(r)){var a;let e,n,l=(a=r,(n=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(n=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref);return h.cloneElement(r,{...function(e,t){let r={...t};for(let s in t){let a=e[s],n=t[s];/^on[A-Z]/.test(s)?a&&n?r[s]=(...e)=>{n(...e),a(...e)}:a&&(r[s]=a):"style"===s?r[s]={...a,...n}:"className"===s&&(r[s]=[a,n].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props),ref:t?v(t,l):l})}return h.Children.count(r)>1?h.Children.only(null):null});j.displayName="SlotClone";var w=({children:e})=>(0,m.jsx)(m.Fragment,{children:e});function N(e){return h.isValidElement(e)&&e.type===w}function k(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,s,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t)if(Array.isArray(t)){var n=t.length;for(r=0;r<n;r++)t[r]&&(s=e(t[r]))&&(a&&(a+=" "),a+=s)}else for(s in t)t[s]&&(a&&(a+=" "),a+=s);return a}(e))&&(s&&(s+=" "),s+=t);return s}let C=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,S=(e,t)=>r=>{var s;if((null==t?void 0:t.variants)==null)return k(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:a,defaultVariants:n}=t,l=Object.keys(a).map(e=>{let t=null==r?void 0:r[e],s=null==n?void 0:n[e];if(null===t)return null;let l=C(t)||C(s);return a[e][l]}),o=r&&Object.entries(r).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return k(e,l,null==t||null==(s=t.compoundVariants)?void 0:s.reduce((e,t)=>{let{class:r,className:s,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...n,...o}[t]):({...n,...o})[t]===r})?[...e,r,s]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)},E=(e=new Map,t=null,r)=>({nextPart:e,validators:t,classGroupId:r}),T=[],R=(e,t,r)=>{if(0==e.length-t)return r.classGroupId;let s=e[t],a=r.nextPart.get(s);if(a){let r=R(e,t+1,a);if(r)return r}let n=r.validators;if(null===n)return;let l=0===t?e.join("-"):e.slice(t).join("-"),o=n.length;for(let e=0;e<o;e++){let t=n[e];if(t.validator(l))return t.classGroupId}},M=(e,t)=>{let r=E();for(let s in e)D(e[s],r,s,t);return r},D=(e,t,r,s)=>{let a=e.length;for(let n=0;n<a;n++)P(e[n],t,r,s)},P=(e,t,r,s)=>{"string"==typeof e?A(e,t,r):"function"==typeof e?I(e,t,r,s):L(e,t,r,s)},A=(e,t,r)=>{(""===e?t:O(t,e)).classGroupId=r},I=(e,t,r,s)=>{q(e)?D(e(s),t,r,s):(null===t.validators&&(t.validators=[]),t.validators.push({classGroupId:r,validator:e}))},L=(e,t,r,s)=>{let a=Object.entries(e),n=a.length;for(let e=0;e<n;e++){let[n,l]=a[e];D(l,O(t,n),r,s)}},O=(e,t)=>{let r=e,s=t.split("-"),a=s.length;for(let e=0;e<a;e++){let t=s[e],a=r.nextPart.get(t);a||(a=E(),r.nextPart.set(t,a)),r=a}return r},q=e=>"isThemeGetter"in e&&!0===e.isThemeGetter,z=[],F=(e,t,r,s,a)=>({modifiers:e,hasImportantModifier:t,baseClassName:r,maybePostfixModifierPosition:s,isExternal:a}),_=/\s+/,U=e=>{let t;if("string"==typeof e)return e;let r="";for(let s=0;s<e.length;s++)e[s]&&(t=U(e[s]))&&(r&&(r+=" "),r+=t);return r},V=[],W=e=>{let t=t=>t[e]||V;return t.isThemeGetter=!0,t},$=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,B=/^\((?:(\w[\w-]*):)?(.+)\)$/i,H=/^\d+\/\d+$/,K=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,G=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,J=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,X=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Y=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Z=e=>H.test(e),Q=e=>!!e&&!Number.isNaN(Number(e)),ee=e=>!!e&&Number.isInteger(Number(e)),et=e=>e.endsWith("%")&&Q(e.slice(0,-1)),er=e=>K.test(e),es=()=>!0,ea=e=>G.test(e)&&!J.test(e),en=()=>!1,el=e=>X.test(e),eo=e=>Y.test(e),ei=e=>!ed(e)&&!ef(e),ec=e=>eN(e,eE,en),ed=e=>$.test(e),eu=e=>eN(e,eT,ea),ex=e=>eN(e,eR,Q),em=e=>eN(e,eC,en),ep=e=>eN(e,eS,eo),eh=e=>eN(e,eD,el),ef=e=>B.test(e),eg=e=>ek(e,eT),ev=e=>ek(e,eM),eb=e=>ek(e,eC),ey=e=>ek(e,eE),ej=e=>ek(e,eS),ew=e=>ek(e,eD,!0),eN=(e,t,r)=>{let s=$.exec(e);return!!s&&(s[1]?t(s[1]):r(s[2]))},ek=(e,t,r=!1)=>{let s=B.exec(e);return!!s&&(s[1]?t(s[1]):r)},eC=e=>"position"===e||"percentage"===e,eS=e=>"image"===e||"url"===e,eE=e=>"length"===e||"size"===e||"bg-size"===e,eT=e=>"length"===e,eR=e=>"number"===e,eM=e=>"family-name"===e,eD=e=>"shadow"===e,eP=((e,...t)=>{let r,s,a,n,l=e=>{let t=s(e);if(t)return t;let n=((e,t)=>{let{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:a,sortModifiers:n}=t,l=[],o=e.trim().split(_),i="";for(let e=o.length-1;e>=0;e-=1){let t=o[e],{isExternal:c,modifiers:d,hasImportantModifier:u,baseClassName:x,maybePostfixModifierPosition:m}=r(t);if(c){i=t+(i.length>0?" "+i:i);continue}let p=!!m,h=s(p?x.substring(0,m):x);if(!h){if(!p||!(h=s(x))){i=t+(i.length>0?" "+i:i);continue}p=!1}let f=0===d.length?"":1===d.length?d[0]:n(d).join(":"),g=u?f+"!":f,v=g+h;if(l.indexOf(v)>-1)continue;l.push(v);let b=a(h,p);for(let e=0;e<b.length;++e){let t=b[e];l.push(g+t)}i=t+(i.length>0?" "+i:i)}return i})(e,r);return a(e,n),n};return n=o=>{var i;let c;return s=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=Object.create(null),s=Object.create(null),a=(a,n)=>{r[a]=n,++t>e&&(t=0,s=r,r=Object.create(null))};return{get(e){let t=r[e];return void 0!==t?t:void 0!==(t=s[e])?(a(e,t),t):void 0},set(e,t){e in r?r[e]=t:a(e,t)}}})((i=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{prefix:t,experimentalParseClassName:r}=e,s=e=>{let t,r=[],s=0,a=0,n=0,l=e.length;for(let o=0;o<l;o++){let l=e[o];if(0===s&&0===a){if(":"===l){r.push(e.slice(n,o)),n=o+1;continue}if("/"===l){t=o;continue}}"["===l?s++:"]"===l?s--:"("===l?a++:")"===l&&a--}let o=0===r.length?e:e.slice(n),i=o,c=!1;return o.endsWith("!")?(i=o.slice(0,-1),c=!0):o.startsWith("!")&&(i=o.slice(1),c=!0),F(r,c,i,t&&t>n?t-n:void 0)};if(t){let e=t+":",r=s;s=t=>t.startsWith(e)?r(t.slice(e.length)):F(z,!1,t,void 0,!0)}if(r){let e=s;s=t=>r({className:t,parseClassName:e})}return s})(i),sortModifiers:(c=new Map,i.orderSensitiveModifiers.forEach((e,t)=>{c.set(e,1e6+t)}),e=>{let t=[],r=[];for(let s=0;s<e.length;s++){let a=e[s],n="["===a[0],l=c.has(a);n||l?(r.length>0&&(r.sort(),t.push(...r),r=[]),t.push(a)):r.push(a)}return r.length>0&&(r.sort(),t.push(...r)),t}),...(e=>{let t=(e=>{let{theme:t,classGroups:r}=e;return M(r,t)})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:e=>{if(e.startsWith("[")&&e.endsWith("]")){var r;let t,s,a;return -1===(r=e).slice(1,-1).indexOf(":")?void 0:(s=(t=r.slice(1,-1)).indexOf(":"),(a=t.slice(0,s))?"arbitrary.."+a:void 0)}let s=e.split("-"),a=+(""===s[0]&&s.length>1);return R(s,a,t)},getConflictingClassGroupIds:(e,t)=>{if(t){let t=s[e],a=r[e];if(t){if(a){let e=Array(a.length+t.length);for(let t=0;t<a.length;t++)e[t]=a[t];for(let r=0;r<t.length;r++)e[a.length+r]=t[r];return e}return t}return a||T}return r[e]||T}}})(i)}).cache.get,a=r.cache.set,n=l,l(o)},(...e)=>n(((...e)=>{let t,r,s=0,a="";for(;s<e.length;)(t=e[s++])&&(r=U(t))&&(a&&(a+=" "),a+=r);return a})(...e))})(()=>{let e=W("color"),t=W("font"),r=W("text"),s=W("font-weight"),a=W("tracking"),n=W("leading"),l=W("breakpoint"),o=W("container"),i=W("spacing"),c=W("radius"),d=W("shadow"),u=W("inset-shadow"),x=W("text-shadow"),m=W("drop-shadow"),p=W("blur"),h=W("perspective"),f=W("aspect"),g=W("ease"),v=W("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],y=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],j=()=>[...y(),ef,ed],w=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto","contain","none"],k=()=>[ef,ed,i],C=()=>[Z,"full","auto",...k()],S=()=>[ee,"none","subgrid",ef,ed],E=()=>["auto",{span:["full",ee,ef,ed]},ee,ef,ed],T=()=>[ee,"auto",ef,ed],R=()=>["auto","min","max","fr",ef,ed],M=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],D=()=>["start","end","center","stretch","center-safe","end-safe"],P=()=>["auto",...k()],A=()=>[Z,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],I=()=>[e,ef,ed],L=()=>[...y(),eb,em,{position:[ef,ed]}],O=()=>["no-repeat",{repeat:["","x","y","space","round"]}],q=()=>["auto","cover","contain",ey,ec,{size:[ef,ed]}],z=()=>[et,eg,eu],F=()=>["","none","full",c,ef,ed],_=()=>["",Q,eg,eu],U=()=>["solid","dashed","dotted","double"],V=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],$=()=>[Q,et,eb,em],B=()=>["","none",p,ef,ed],H=()=>["none",Q,ef,ed],K=()=>["none",Q,ef,ed],G=()=>[Q,ef,ed],J=()=>[Z,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[er],breakpoint:[er],color:[es],container:[er],"drop-shadow":[er],ease:["in","out","in-out"],font:[ei],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[er],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[er],shadow:[er],spacing:["px",Q],text:[er],"text-shadow":[er],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Z,ed,ef,f]}],container:["container"],columns:[{columns:[Q,ed,ef,o]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:j()}],overflow:[{overflow:w()}],"overflow-x":[{"overflow-x":w()}],"overflow-y":[{"overflow-y":w()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:C()}],"inset-x":[{"inset-x":C()}],"inset-y":[{"inset-y":C()}],start:[{start:C()}],end:[{end:C()}],top:[{top:C()}],right:[{right:C()}],bottom:[{bottom:C()}],left:[{left:C()}],visibility:["visible","invisible","collapse"],z:[{z:[ee,"auto",ef,ed]}],basis:[{basis:[Z,"full","auto",o,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Q,Z,"auto","initial","none",ed]}],grow:[{grow:["",Q,ef,ed]}],shrink:[{shrink:["",Q,ef,ed]}],order:[{order:[ee,"first","last","none",ef,ed]}],"grid-cols":[{"grid-cols":S()}],"col-start-end":[{col:E()}],"col-start":[{"col-start":T()}],"col-end":[{"col-end":T()}],"grid-rows":[{"grid-rows":S()}],"row-start-end":[{row:E()}],"row-start":[{"row-start":T()}],"row-end":[{"row-end":T()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":R()}],"auto-rows":[{"auto-rows":R()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...M(),"normal"]}],"justify-items":[{"justify-items":[...D(),"normal"]}],"justify-self":[{"justify-self":["auto",...D()]}],"align-content":[{content:["normal",...M()]}],"align-items":[{items:[...D(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...D(),{baseline:["","last"]}]}],"place-content":[{"place-content":M()}],"place-items":[{"place-items":[...D(),"baseline"]}],"place-self":[{"place-self":["auto",...D()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:P()}],mx:[{mx:P()}],my:[{my:P()}],ms:[{ms:P()}],me:[{me:P()}],mt:[{mt:P()}],mr:[{mr:P()}],mb:[{mb:P()}],ml:[{ml:P()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:A()}],w:[{w:[o,"screen",...A()]}],"min-w":[{"min-w":[o,"screen","none",...A()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[l]},...A()]}],h:[{h:["screen","lh",...A()]}],"min-h":[{"min-h":["screen","lh","none",...A()]}],"max-h":[{"max-h":["screen","lh",...A()]}],"font-size":[{text:["base",r,eg,eu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,ef,ex]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",et,ed]}],"font-family":[{font:[ev,ed,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,ef,ed]}],"line-clamp":[{"line-clamp":[Q,"none",ef,ex]}],leading:[{leading:[n,...k()]}],"list-image":[{"list-image":["none",ef,ed]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ef,ed]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:I()}],"text-color":[{text:I()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:[Q,"from-font","auto",ef,eu]}],"text-decoration-color":[{decoration:I()}],"underline-offset":[{"underline-offset":[Q,"auto",ef,ed]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ef,ed]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ef,ed]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:L()}],"bg-repeat":[{bg:O()}],"bg-size":[{bg:q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ee,ef,ed],radial:["",ef,ed],conic:[ee,ef,ed]},ej,ep]}],"bg-color":[{bg:I()}],"gradient-from-pos":[{from:z()}],"gradient-via-pos":[{via:z()}],"gradient-to-pos":[{to:z()}],"gradient-from":[{from:I()}],"gradient-via":[{via:I()}],"gradient-to":[{to:I()}],rounded:[{rounded:F()}],"rounded-s":[{"rounded-s":F()}],"rounded-e":[{"rounded-e":F()}],"rounded-t":[{"rounded-t":F()}],"rounded-r":[{"rounded-r":F()}],"rounded-b":[{"rounded-b":F()}],"rounded-l":[{"rounded-l":F()}],"rounded-ss":[{"rounded-ss":F()}],"rounded-se":[{"rounded-se":F()}],"rounded-ee":[{"rounded-ee":F()}],"rounded-es":[{"rounded-es":F()}],"rounded-tl":[{"rounded-tl":F()}],"rounded-tr":[{"rounded-tr":F()}],"rounded-br":[{"rounded-br":F()}],"rounded-bl":[{"rounded-bl":F()}],"border-w":[{border:_()}],"border-w-x":[{"border-x":_()}],"border-w-y":[{"border-y":_()}],"border-w-s":[{"border-s":_()}],"border-w-e":[{"border-e":_()}],"border-w-t":[{"border-t":_()}],"border-w-r":[{"border-r":_()}],"border-w-b":[{"border-b":_()}],"border-w-l":[{"border-l":_()}],"divide-x":[{"divide-x":_()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":_()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...U(),"hidden","none"]}],"divide-style":[{divide:[...U(),"hidden","none"]}],"border-color":[{border:I()}],"border-color-x":[{"border-x":I()}],"border-color-y":[{"border-y":I()}],"border-color-s":[{"border-s":I()}],"border-color-e":[{"border-e":I()}],"border-color-t":[{"border-t":I()}],"border-color-r":[{"border-r":I()}],"border-color-b":[{"border-b":I()}],"border-color-l":[{"border-l":I()}],"divide-color":[{divide:I()}],"outline-style":[{outline:[...U(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Q,ef,ed]}],"outline-w":[{outline:["",Q,eg,eu]}],"outline-color":[{outline:I()}],shadow:[{shadow:["","none",d,ew,eh]}],"shadow-color":[{shadow:I()}],"inset-shadow":[{"inset-shadow":["none",u,ew,eh]}],"inset-shadow-color":[{"inset-shadow":I()}],"ring-w":[{ring:_()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:I()}],"ring-offset-w":[{"ring-offset":[Q,eu]}],"ring-offset-color":[{"ring-offset":I()}],"inset-ring-w":[{"inset-ring":_()}],"inset-ring-color":[{"inset-ring":I()}],"text-shadow":[{"text-shadow":["none",x,ew,eh]}],"text-shadow-color":[{"text-shadow":I()}],opacity:[{opacity:[Q,ef,ed]}],"mix-blend":[{"mix-blend":[...V(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":V()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Q]}],"mask-image-linear-from-pos":[{"mask-linear-from":$()}],"mask-image-linear-to-pos":[{"mask-linear-to":$()}],"mask-image-linear-from-color":[{"mask-linear-from":I()}],"mask-image-linear-to-color":[{"mask-linear-to":I()}],"mask-image-t-from-pos":[{"mask-t-from":$()}],"mask-image-t-to-pos":[{"mask-t-to":$()}],"mask-image-t-from-color":[{"mask-t-from":I()}],"mask-image-t-to-color":[{"mask-t-to":I()}],"mask-image-r-from-pos":[{"mask-r-from":$()}],"mask-image-r-to-pos":[{"mask-r-to":$()}],"mask-image-r-from-color":[{"mask-r-from":I()}],"mask-image-r-to-color":[{"mask-r-to":I()}],"mask-image-b-from-pos":[{"mask-b-from":$()}],"mask-image-b-to-pos":[{"mask-b-to":$()}],"mask-image-b-from-color":[{"mask-b-from":I()}],"mask-image-b-to-color":[{"mask-b-to":I()}],"mask-image-l-from-pos":[{"mask-l-from":$()}],"mask-image-l-to-pos":[{"mask-l-to":$()}],"mask-image-l-from-color":[{"mask-l-from":I()}],"mask-image-l-to-color":[{"mask-l-to":I()}],"mask-image-x-from-pos":[{"mask-x-from":$()}],"mask-image-x-to-pos":[{"mask-x-to":$()}],"mask-image-x-from-color":[{"mask-x-from":I()}],"mask-image-x-to-color":[{"mask-x-to":I()}],"mask-image-y-from-pos":[{"mask-y-from":$()}],"mask-image-y-to-pos":[{"mask-y-to":$()}],"mask-image-y-from-color":[{"mask-y-from":I()}],"mask-image-y-to-color":[{"mask-y-to":I()}],"mask-image-radial":[{"mask-radial":[ef,ed]}],"mask-image-radial-from-pos":[{"mask-radial-from":$()}],"mask-image-radial-to-pos":[{"mask-radial-to":$()}],"mask-image-radial-from-color":[{"mask-radial-from":I()}],"mask-image-radial-to-color":[{"mask-radial-to":I()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":y()}],"mask-image-conic-pos":[{"mask-conic":[Q]}],"mask-image-conic-from-pos":[{"mask-conic-from":$()}],"mask-image-conic-to-pos":[{"mask-conic-to":$()}],"mask-image-conic-from-color":[{"mask-conic-from":I()}],"mask-image-conic-to-color":[{"mask-conic-to":I()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:L()}],"mask-repeat":[{mask:O()}],"mask-size":[{mask:q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ef,ed]}],filter:[{filter:["","none",ef,ed]}],blur:[{blur:B()}],brightness:[{brightness:[Q,ef,ed]}],contrast:[{contrast:[Q,ef,ed]}],"drop-shadow":[{"drop-shadow":["","none",m,ew,eh]}],"drop-shadow-color":[{"drop-shadow":I()}],grayscale:[{grayscale:["",Q,ef,ed]}],"hue-rotate":[{"hue-rotate":[Q,ef,ed]}],invert:[{invert:["",Q,ef,ed]}],saturate:[{saturate:[Q,ef,ed]}],sepia:[{sepia:["",Q,ef,ed]}],"backdrop-filter":[{"backdrop-filter":["","none",ef,ed]}],"backdrop-blur":[{"backdrop-blur":B()}],"backdrop-brightness":[{"backdrop-brightness":[Q,ef,ed]}],"backdrop-contrast":[{"backdrop-contrast":[Q,ef,ed]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Q,ef,ed]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Q,ef,ed]}],"backdrop-invert":[{"backdrop-invert":["",Q,ef,ed]}],"backdrop-opacity":[{"backdrop-opacity":[Q,ef,ed]}],"backdrop-saturate":[{"backdrop-saturate":[Q,ef,ed]}],"backdrop-sepia":[{"backdrop-sepia":["",Q,ef,ed]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ef,ed]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Q,"initial",ef,ed]}],ease:[{ease:["linear","initial",g,ef,ed]}],delay:[{delay:[Q,ef,ed]}],animate:[{animate:["none",v,ef,ed]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[h,ef,ed]}],"perspective-origin":[{"perspective-origin":j()}],rotate:[{rotate:H()}],"rotate-x":[{"rotate-x":H()}],"rotate-y":[{"rotate-y":H()}],"rotate-z":[{"rotate-z":H()}],scale:[{scale:K()}],"scale-x":[{"scale-x":K()}],"scale-y":[{"scale-y":K()}],"scale-z":[{"scale-z":K()}],"scale-3d":["scale-3d"],skew:[{skew:G()}],"skew-x":[{"skew-x":G()}],"skew-y":[{"skew-y":G()}],transform:[{transform:[ef,ed,"","none","gpu","cpu"]}],"transform-origin":[{origin:j()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:J()}],"translate-x":[{"translate-x":J()}],"translate-y":[{"translate-y":J()}],"translate-z":[{"translate-z":J()}],"translate-none":["translate-none"],accent:[{accent:I()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:I()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ef,ed]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ef,ed]}],fill:[{fill:["none",...I()]}],"stroke-w":[{stroke:[Q,eg,eu,ex]}],stroke:[{stroke:["none",...I()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function eA(...e){return eP(k(e))}let eI=S("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function eL({className:e,variant:t,size:r,asChild:s=!1,...a}){let n=s?y:"button";return(0,m.jsx)(n,{"data-slot":"button",className:eA(eI({variant:t,size:r,className:e})),...a})}function eO({className:e,type:t,...r}){return(0,m.jsx)("input",{type:t,"data-slot":"input",className:eA("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}function eq({className:e,...t}){return(0,m.jsx)("textarea",{"data-slot":"textarea",className:eA("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}function ez(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function eF(e,t=[]){let r=[],s=()=>{let t=r.map(e=>h.createContext(e));return function(r){let s=r?.[e]||t;return h.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let a=h.createContext(s),n=r.length;r=[...r,s];let l=t=>{let{scope:r,children:s,...l}=t,o=r?.[e]?.[n]||a,i=h.useMemo(()=>l,Object.values(l));return(0,m.jsx)(o.Provider,{value:i,children:s})};return l.displayName=t+"Provider",[l,function(r,l){let o=l?.[e]?.[n]||a,i=h.useContext(o);if(i)return i;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let a=r(e)[`__scope${s}`];return{...t,...a}},{});return h.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}var e_=globalThis?.document?h.useLayoutEffect:()=>{},eU=h["useId".toString()]||(()=>void 0),eV=0;function eW(e){let[t,r]=h.useState(eU());return e_(()=>{e||r(e=>e??String(eV++))},[e]),e||(t?`radix-${t}`:"")}function e$(e){let t=h.useRef(e);return h.useEffect(()=>{t.current=e}),h.useMemo(()=>(...e)=>t.current?.(...e),[])}function eB({prop:e,defaultProp:t,onChange:r=()=>{}}){let[s,a]=function({defaultProp:e,onChange:t}){let r=h.useState(e),[s]=r,a=h.useRef(s),n=e$(t);return h.useEffect(()=>{a.current!==s&&(n(s),a.current=s)},[s,a,n]),r}({defaultProp:t,onChange:r}),n=void 0!==e,l=n?e:s,o=e$(r);return[l,h.useCallback(t=>{if(n){let r="function"==typeof t?t(e):t;r!==e&&o(r)}else a(t)},[n,e,a,o])]}var eH=e.i(72942),eK=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=h.forwardRef((e,r)=>{let{asChild:s,...a}=e,n=s?y:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,m.jsx)(n,{...a,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function eG(e,t){e&&eH.flushSync(()=>e.dispatchEvent(t))}var eJ="dismissableLayer.update",eX=h.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),eY=h.forwardRef((e,t)=>{let{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:n,onInteractOutside:l,onDismiss:o,...i}=e,c=h.useContext(eX),[d,x]=h.useState(null),p=d?.ownerDocument??globalThis?.document,[,f]=h.useState({}),g=b(t,e=>x(e)),v=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),j=v.indexOf(y),w=d?v.indexOf(d):-1,N=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=j,C=function(e,t=globalThis?.document){let r=e$(e),s=h.useRef(!1),a=h.useRef(()=>{});return h.useEffect(()=>{let e=e=>{if(e.target&&!s.current){let s=function(){eQ("dismissableLayer.pointerDownOutside",r,n,{discrete:!0})},n={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",a.current),a.current=s,t.addEventListener("click",a.current,{once:!0})):s()}else t.removeEventListener("click",a.current);s.current=!1},n=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(n),t.removeEventListener("pointerdown",e),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>s.current=!0}}(e=>{let t=e.target,r=[...c.branches].some(e=>e.contains(t));k&&!r&&(a?.(e),l?.(e),e.defaultPrevented||o?.())},p),S=function(e,t=globalThis?.document){let r=e$(e),s=h.useRef(!1);return h.useEffect(()=>{let e=e=>{e.target&&!s.current&&eQ("dismissableLayer.focusOutside",r,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}(e=>{let t=e.target;![...c.branches].some(e=>e.contains(t))&&(n?.(e),l?.(e),e.defaultPrevented||o?.())},p);return!function(e,t=globalThis?.document){let r=e$(e);h.useEffect(()=>{let e=e=>{"Escape"===e.key&&r(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[r,t])}(e=>{w===c.layers.size-1&&(s?.(e),!e.defaultPrevented&&o&&(e.preventDefault(),o()))},p),h.useEffect(()=>{if(d)return r&&(0===c.layersWithOutsidePointerEventsDisabled.size&&(u=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),eZ(),()=>{r&&1===c.layersWithOutsidePointerEventsDisabled.size&&(p.body.style.pointerEvents=u)}},[d,p,r,c]),h.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),eZ())},[d,c]),h.useEffect(()=>{let e=()=>f({});return document.addEventListener(eJ,e),()=>document.removeEventListener(eJ,e)},[]),(0,m.jsx)(eK.div,{...i,ref:g,style:{pointerEvents:N?k?"auto":"none":void 0,...e.style},onFocusCapture:ez(e.onFocusCapture,S.onFocusCapture),onBlurCapture:ez(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:ez(e.onPointerDownCapture,C.onPointerDownCapture)})});function eZ(){let e=new CustomEvent(eJ);document.dispatchEvent(e)}function eQ(e,t,r,{discrete:s}){let a=r.originalEvent.target,n=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),s?eG(a,n):a.dispatchEvent(n)}eY.displayName="DismissableLayer",h.forwardRef((e,t)=>{let r=h.useContext(eX),s=h.useRef(null),a=b(t,s);return h.useEffect(()=>{let e=s.current;if(e)return r.branches.add(e),()=>{r.branches.delete(e)}},[r.branches]),(0,m.jsx)(eK.div,{...e,ref:a})}).displayName="DismissableLayerBranch";var e0="focusScope.autoFocusOnMount",e1="focusScope.autoFocusOnUnmount",e2={bubbles:!1,cancelable:!0},e5=h.forwardRef((e,t)=>{let{loop:r=!1,trapped:s=!1,onMountAutoFocus:a,onUnmountAutoFocus:n,...l}=e,[o,i]=h.useState(null),c=e$(a),d=e$(n),u=h.useRef(null),x=b(t,e=>i(e)),p=h.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;h.useEffect(()=>{if(s){let e=function(e){if(p.paused||!o)return;let t=e.target;o.contains(t)?u.current=t:e4(u.current,{select:!0})},t=function(e){if(p.paused||!o)return;let t=e.relatedTarget;null!==t&&(o.contains(t)||e4(u.current,{select:!0}))};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let r=new MutationObserver(function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&e4(o)});return o&&r.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),r.disconnect()}}},[s,o,p.paused]),h.useEffect(()=>{if(o){e6.add(p);let e=document.activeElement;if(!o.contains(e)){let t=new CustomEvent(e0,e2);o.addEventListener(e0,c),o.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){let r=document.activeElement;for(let s of e)if(e4(s,{select:t}),document.activeElement!==r)return}(e3(o).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&e4(o))}return()=>{o.removeEventListener(e0,c),setTimeout(()=>{let t=new CustomEvent(e1,e2);o.addEventListener(e1,d),o.dispatchEvent(t),t.defaultPrevented||e4(e??document.body,{select:!0}),o.removeEventListener(e1,d),e6.remove(p)},0)}}},[o,c,d,p]);let f=h.useCallback(e=>{if(!r&&!s||p.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,a=document.activeElement;if(t&&a){var n;let t,s=e.currentTarget,[l,o]=[e8(t=e3(n=s),n),e8(t.reverse(),n)];l&&o?e.shiftKey||a!==o?e.shiftKey&&a===l&&(e.preventDefault(),r&&e4(o,{select:!0})):(e.preventDefault(),r&&e4(l,{select:!0})):a===s&&e.preventDefault()}},[r,s,p.paused]);return(0,m.jsx)(eK.div,{tabIndex:-1,...l,ref:x,onKeyDown:f})});function e3(e){let t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function e8(e,t){for(let r of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(r,{upTo:t}))return r}function e4(e,{select:t=!1}={}){if(e&&e.focus){var r;let s=document.activeElement;e.focus({preventScroll:!0}),e!==s&&(r=e)instanceof HTMLInputElement&&"select"in r&&t&&e.select()}}e5.displayName="FocusScope";var e6=(s=[],{add(e){let t=s[0];e!==t&&t?.pause(),(s=e9(s,e)).unshift(e)},remove(e){s=e9(s,e),s[0]?.resume()}});function e9(e,t){let r=[...e],s=r.indexOf(t);return -1!==s&&r.splice(s,1),r}var e7=h.forwardRef((e,t)=>{let{container:r,...s}=e,[a,n]=h.useState(!1);e_(()=>n(!0),[]);let l=r||a&&globalThis?.document?.body;return l?eH.default.createPortal((0,m.jsx)(eK.div,{...s,ref:t}),l):null});e7.displayName="Portal";var te=e=>{var t;let r,s,{present:a,children:n}=e,l=function(e){var t,r;let[s,a]=h.useState(),n=h.useRef({}),l=h.useRef(e),o=h.useRef("none"),[i,c]=(t=e?"mounted":"unmounted",r={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},h.useReducer((e,t)=>r[e][t]??e,t));return h.useEffect(()=>{let e=tt(n.current);o.current="mounted"===i?e:"none"},[i]),e_(()=>{let t=n.current,r=l.current;if(r!==e){let s=o.current,a=tt(t);e?c("MOUNT"):"none"===a||t?.display==="none"?c("UNMOUNT"):r&&s!==a?c("ANIMATION_OUT"):c("UNMOUNT"),l.current=e}},[e,c]),e_(()=>{if(s){let e,t=s.ownerDocument.defaultView??window,r=r=>{let a=tt(n.current).includes(r.animationName);if(r.target===s&&a&&(c("ANIMATION_END"),!l.current)){let r=s.style.animationFillMode;s.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===s.style.animationFillMode&&(s.style.animationFillMode=r)})}},a=e=>{e.target===s&&(o.current=tt(n.current))};return s.addEventListener("animationstart",a),s.addEventListener("animationcancel",r),s.addEventListener("animationend",r),()=>{t.clearTimeout(e),s.removeEventListener("animationstart",a),s.removeEventListener("animationcancel",r),s.removeEventListener("animationend",r)}}c("ANIMATION_END")},[s,c]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:h.useCallback(e=>{e&&(n.current=getComputedStyle(e)),a(e)},[])}}(a),o="function"==typeof n?n({present:l.isPresent}):h.Children.only(n),i=b(l.ref,(t=o,(s=(r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?t.ref:(s=(r=Object.getOwnPropertyDescriptor(t,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?t.props.ref:t.props.ref||t.ref));return"function"==typeof n||l.isPresent?h.cloneElement(o,{ref:i}):null};function tt(e){return e?.animationName||"none"}te.displayName="Presence";var tr=0;function ts(){h.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??ta()),document.body.insertAdjacentElement("beforeend",e[1]??ta()),tr++,()=>{1===tr&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),tr--}},[])}function ta(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var tn=function(){return(tn=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function tl(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)0>t.indexOf(s[a])&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r}var to=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),ti="width-before-scroll-bar";function tc(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var td="undefined"!=typeof window?h.useLayoutEffect:h.useEffect,tu=new WeakMap,tx=(void 0===a&&(a={}),(void 0===n&&(n=function(e){return e}),l=[],o=!1,i={read:function(){if(o)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return l.length?l[l.length-1]:null},useMedium:function(e){var t=n(e,o);return l.push(t),function(){l=l.filter(function(e){return e!==t})}},assignSyncMedium:function(e){for(o=!0;l.length;){var t=l;l=[],t.forEach(e)}l={push:function(t){return e(t)},filter:function(){return l}}},assignMedium:function(e){o=!0;var t=[];if(l.length){var r=l;l=[],r.forEach(e),t=l}var s=function(){var r=t;t=[],r.forEach(e)},a=function(){return Promise.resolve().then(s)};a(),l={push:function(e){t.push(e),a()},filter:function(e){return t=t.filter(e),l}}}}).options=tn({async:!0,ssr:!1},a),i),tm=function(){},tp=h.forwardRef(function(e,t){var r,s,a,n,l=h.useRef(null),o=h.useState({onScrollCapture:tm,onWheelCapture:tm,onTouchMoveCapture:tm}),i=o[0],c=o[1],d=e.forwardProps,u=e.children,x=e.className,m=e.removeScrollBar,p=e.enabled,f=e.shards,g=e.sideCar,v=e.noRelative,b=e.noIsolation,y=e.inert,j=e.allowPinchZoom,w=e.as,N=e.gapMode,k=tl(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=(r=[l,t],s=function(e){return r.forEach(function(t){return tc(t,e)})},(a=(0,h.useState)(function(){return{value:null,callback:s,facade:{get current(){return a.value},set current(value){var e=a.value;e!==value&&(a.value=value,a.callback(value,e))}}}})[0]).callback=s,n=a.facade,td(function(){var e=tu.get(n);if(e){var t=new Set(e),s=new Set(r),a=n.current;t.forEach(function(e){s.has(e)||tc(e,null)}),s.forEach(function(e){t.has(e)||tc(e,a)})}tu.set(n,r)},[r]),n),S=tn(tn({},k),i);return h.createElement(h.Fragment,null,p&&h.createElement(g,{sideCar:tx,removeScrollBar:m,shards:f,noRelative:v,noIsolation:b,inert:y,setCallbacks:c,allowPinchZoom:!!j,lockRef:l,gapMode:N}),d?h.cloneElement(h.Children.only(u),tn(tn({},S),{ref:C})):h.createElement(void 0===w?"div":w,tn({},S,{className:x,ref:C}),u))});tp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},tp.classNames={fullWidth:ti,zeroRight:to};var th=function(e){var t=e.sideCar,r=tl(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw Error("Sidecar medium not found");return h.createElement(s,tn({},r))};th.isSideCarExport=!0;var tf=function(){var e=0,t=null;return{add:function(r){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=x||("undefined"!=typeof __webpack_nonce__?__webpack_nonce__:void 0);return t&&e.setAttribute("nonce",t),e}())){var s,a;(s=t).styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r)),a=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(a)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},tg=function(){var e=tf();return function(t,r){h.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},tv=function(){var e=tg();return function(t){return e(t.styles,t.dynamic),null}},tb={left:0,top:0,right:0,gap:0},ty=function(e){return parseInt(e||"",10)||0},tj=function(e){var t=window.getComputedStyle(document.body),r=t["padding"===e?"paddingLeft":"marginLeft"],s=t["padding"===e?"paddingTop":"marginTop"],a=t["padding"===e?"paddingRight":"marginRight"];return[ty(r),ty(s),ty(a)]},tw=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return tb;var t=tj(e),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,s-r+t[2]-t[0])}},tN=tv(),tk="data-scroll-locked",tC=function(e,t,r,s){var a=e.left,n=e.top,l=e.right,o=e.gap;return void 0===r&&(r="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(s,";\n   padding-right: ").concat(o,"px ").concat(s,";\n  }\n  body[").concat(tk,"] {\n    overflow: hidden ").concat(s,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(s,";"),"margin"===r&&"\n    padding-left: ".concat(a,"px;\n    padding-top: ").concat(n,"px;\n    padding-right: ").concat(l,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(s,";\n    "),"padding"===r&&"padding-right: ".concat(o,"px ").concat(s,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(to," {\n    right: ").concat(o,"px ").concat(s,";\n  }\n  \n  .").concat(ti," {\n    margin-right: ").concat(o,"px ").concat(s,";\n  }\n  \n  .").concat(to," .").concat(to," {\n    right: 0 ").concat(s,";\n  }\n  \n  .").concat(ti," .").concat(ti," {\n    margin-right: 0 ").concat(s,";\n  }\n  \n  body[").concat(tk,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(o,"px;\n  }\n")},tS=function(){var e=parseInt(document.body.getAttribute(tk)||"0",10);return isFinite(e)?e:0},tE=function(){h.useEffect(function(){return document.body.setAttribute(tk,(tS()+1).toString()),function(){var e=tS()-1;e<=0?document.body.removeAttribute(tk):document.body.setAttribute(tk,e.toString())}},[])},tT=function(e){var t=e.noRelative,r=e.noImportant,s=e.gapMode,a=void 0===s?"margin":s;tE();var n=h.useMemo(function(){return tw(a)},[a]);return h.createElement(tN,{styles:tC(n,!t,a,r?"":"!important")})},tR=!1;if("undefined"!=typeof window)try{var tM=Object.defineProperty({},"passive",{get:function(){return tR=!0,!0}});window.addEventListener("test",tM,tM),window.removeEventListener("test",tM,tM)}catch(e){tR=!1}var tD=!!tR&&{passive:!1},tP=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return"hidden"!==r[t]&&(r.overflowY!==r.overflowX||"TEXTAREA"===e.tagName||"visible"!==r[t])},tA=function(e,t){var r=t.ownerDocument,s=t;do{if("undefined"!=typeof ShadowRoot&&s instanceof ShadowRoot&&(s=s.host),tI(e,s)){var a=tL(e,s);if(a[1]>a[2])return!0}s=s.parentNode}while(s&&s!==r.body)return!1},tI=function(e,t){return"v"===e?tP(t,"overflowY"):tP(t,"overflowX")},tL=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},tO=function(e,t,r,s,a){var n,l=(n=window.getComputedStyle(t).direction,"h"===e&&"rtl"===n?-1:1),o=l*s,i=r.target,c=t.contains(i),d=!1,u=o>0,x=0,m=0;do{if(!i)break;var p=tL(e,i),h=p[0],f=p[1]-p[2]-l*h;(h||f)&&tI(e,i)&&(x+=f,m+=h);var g=i.parentNode;i=g&&g.nodeType===Node.DOCUMENT_FRAGMENT_NODE?g.host:g}while(!c&&i!==document.body||c&&(t.contains(i)||t===i))return u&&(a&&1>Math.abs(x)||!a&&o>x)?d=!0:!u&&(a&&1>Math.abs(m)||!a&&-o>m)&&(d=!0),d},tq=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},tz=function(e){return[e.deltaX,e.deltaY]},tF=function(e){return e&&"current"in e?e.current:e},t_=0,tU=[];let tV=(c=function(e){var t=h.useRef([]),r=h.useRef([0,0]),s=h.useRef(),a=h.useState(t_++)[0],n=h.useState(tv)[0],l=h.useRef(e);h.useEffect(function(){l.current=e},[e]),h.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var t=(function(e,t,r){if(r||2==arguments.length)for(var s,a=0,n=t.length;a<n;a++)!s&&a in t||(s||(s=Array.prototype.slice.call(t,0,a)),s[a]=t[a]);return e.concat(s||Array.prototype.slice.call(t))})([e.lockRef.current],(e.shards||[]).map(tF),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=h.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!l.current.allowPinchZoom;var a,n=tq(e),o=r.current,i="deltaX"in e?e.deltaX:o[0]-n[0],c="deltaY"in e?e.deltaY:o[1]-n[1],d=e.target,u=Math.abs(i)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===u&&"range"===d.type)return!1;var x=window.getSelection(),m=x&&x.anchorNode;if(m&&(m===d||m.contains(d)))return!1;var p=tA(u,d);if(!p)return!0;if(p?a=u:(a="v"===u?"h":"v",p=tA(u,d)),!p)return!1;if(!s.current&&"changedTouches"in e&&(i||c)&&(s.current=a),!a)return!0;var h=s.current||a;return tO(h,t,e,"h"===h?i:c,!0)},[]),i=h.useCallback(function(e){if(tU.length&&tU[tU.length-1]===n){var r="deltaY"in e?tz(e):tq(e),s=t.current.filter(function(t){var s;return t.name===e.type&&(t.target===e.target||e.target===t.shadowParent)&&(s=t.delta,s[0]===r[0]&&s[1]===r[1])})[0];if(s&&s.should){e.cancelable&&e.preventDefault();return}if(!s){var a=(l.current.shards||[]).map(tF).filter(Boolean).filter(function(t){return t.contains(e.target)});(a.length>0?o(e,a[0]):!l.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),c=h.useCallback(function(e,r,s,a){var n={name:e,delta:r,target:s,should:a,shadowParent:function(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}(s)};t.current.push(n),setTimeout(function(){t.current=t.current.filter(function(e){return e!==n})},1)},[]),d=h.useCallback(function(e){r.current=tq(e),s.current=void 0},[]),u=h.useCallback(function(t){c(t.type,tz(t),t.target,o(t,e.lockRef.current))},[]),x=h.useCallback(function(t){c(t.type,tq(t),t.target,o(t,e.lockRef.current))},[]);h.useEffect(function(){return tU.push(n),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:x}),document.addEventListener("wheel",i,tD),document.addEventListener("touchmove",i,tD),document.addEventListener("touchstart",d,tD),function(){tU=tU.filter(function(e){return e!==n}),document.removeEventListener("wheel",i,tD),document.removeEventListener("touchmove",i,tD),document.removeEventListener("touchstart",d,tD)}},[]);var m=e.removeScrollBar,p=e.inert;return h.createElement(h.Fragment,null,p?h.createElement(n,{styles:"\n  .block-interactivity-".concat(a," {pointer-events: none;}\n  .allow-interactivity-").concat(a," {pointer-events: all;}\n")}):null,m?h.createElement(tT,{noRelative:e.noRelative,gapMode:e.gapMode}):null)},tx.useMedium(c),th);var tW=h.forwardRef(function(e,t){return h.createElement(tp,tn({},e,{ref:t,sideCar:tV}))});tW.classNames=tp.classNames;var t$=new WeakMap,tB=new WeakMap,tH={},tK=0,tG=function(e){return e&&(e.host||tG(e.parentNode))},tJ=function(e,t,r,s){var a=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var r=tG(e);return r&&t.contains(r)?r:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return!!e});tH[r]||(tH[r]=new WeakMap);var n=tH[r],l=[],o=new Set,i=new Set(a),c=function(e){!e||o.has(e)||(o.add(e),c(e.parentNode))};a.forEach(c);var d=function(e){!e||i.has(e)||Array.prototype.forEach.call(e.children,function(e){if(o.has(e))d(e);else try{var t=e.getAttribute(s),a=null!==t&&"false"!==t,i=(t$.get(e)||0)+1,c=(n.get(e)||0)+1;t$.set(e,i),n.set(e,c),l.push(e),1===i&&a&&tB.set(e,!0),1===c&&e.setAttribute(r,"true"),a||e.setAttribute(s,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return d(t),o.clear(),tK++,function(){l.forEach(function(e){var t=t$.get(e)-1,a=n.get(e)-1;t$.set(e,t),n.set(e,a),t||(tB.has(e)||e.removeAttribute(s),tB.delete(e)),a||e.removeAttribute(r)}),--tK||(t$=new WeakMap,t$=new WeakMap,tB=new WeakMap,tH={})}},tX=function(e,t,r){void 0===r&&(r="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),a=t||("undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body);return a?(s.push.apply(s,Array.from(a.querySelectorAll("[aria-live], script"))),tJ(s,a,r,"aria-hidden")):function(){return null}},tY="Dialog",[tZ,tQ]=eF(tY),[t0,t1]=tZ(tY),t2=e=>{let{__scopeDialog:t,children:r,open:s,defaultOpen:a,onOpenChange:n,modal:l=!0}=e,o=h.useRef(null),i=h.useRef(null),[c=!1,d]=eB({prop:s,defaultProp:a,onChange:n});return(0,m.jsx)(t0,{scope:t,triggerRef:o,contentRef:i,contentId:eW(),titleId:eW(),descriptionId:eW(),open:c,onOpenChange:d,onOpenToggle:h.useCallback(()=>d(e=>!e),[d]),modal:l,children:r})};t2.displayName=tY;var t5="DialogTrigger",t3=h.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,a=t1(t5,r),n=b(t,a.triggerRef);return(0,m.jsx)(eK.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":rm(a.open),...s,ref:n,onClick:ez(e.onClick,a.onOpenToggle)})});t3.displayName=t5;var t8="DialogPortal",[t4,t6]=tZ(t8,{forceMount:void 0}),t9=e=>{let{__scopeDialog:t,forceMount:r,children:s,container:a}=e,n=t1(t8,t);return(0,m.jsx)(t4,{scope:t,forceMount:r,children:h.Children.map(s,e=>(0,m.jsx)(te,{present:r||n.open,children:(0,m.jsx)(e7,{asChild:!0,container:a,children:e})}))})};t9.displayName=t8;var t7="DialogOverlay",re=h.forwardRef((e,t)=>{let r=t6(t7,e.__scopeDialog),{forceMount:s=r.forceMount,...a}=e,n=t1(t7,e.__scopeDialog);return n.modal?(0,m.jsx)(te,{present:s||n.open,children:(0,m.jsx)(rt,{...a,ref:t})}):null});re.displayName=t7;var rt=h.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,a=t1(t7,r);return(0,m.jsx)(tW,{as:y,allowPinchZoom:!0,shards:[a.contentRef],children:(0,m.jsx)(eK.div,{"data-state":rm(a.open),...s,ref:t,style:{pointerEvents:"auto",...s.style}})})}),rr="DialogContent",rs=h.forwardRef((e,t)=>{let r=t6(rr,e.__scopeDialog),{forceMount:s=r.forceMount,...a}=e,n=t1(rr,e.__scopeDialog);return(0,m.jsx)(te,{present:s||n.open,children:n.modal?(0,m.jsx)(ra,{...a,ref:t}):(0,m.jsx)(rn,{...a,ref:t})})});rs.displayName=rr;var ra=h.forwardRef((e,t)=>{let r=t1(rr,e.__scopeDialog),s=h.useRef(null),a=b(t,r.contentRef,s);return h.useEffect(()=>{let e=s.current;if(e)return tX(e)},[]),(0,m.jsx)(rl,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ez(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:ez(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:ez(e.onFocusOutside,e=>e.preventDefault())})}),rn=h.forwardRef((e,t)=>{let r=t1(rr,e.__scopeDialog),s=h.useRef(!1),a=h.useRef(!1);return(0,m.jsx)(rl,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(s.current||r.triggerRef.current?.focus(),t.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(a.current=!0));let n=t.target;r.triggerRef.current?.contains(n)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&a.current&&t.preventDefault()}})}),rl=h.forwardRef((e,t)=>{let{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:n,...l}=e,o=t1(rr,r),i=h.useRef(null),c=b(t,i);return ts(),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(e5,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:n,children:(0,m.jsx)(eY,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":rm(o.open),...l,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(rg,{titleId:o.titleId}),(0,m.jsx)(rv,{contentRef:i,descriptionId:o.descriptionId})]})]})}),ro="DialogTitle",ri=h.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,a=t1(ro,r);return(0,m.jsx)(eK.h2,{id:a.titleId,...s,ref:t})});ri.displayName=ro;var rc="DialogDescription",rd=h.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,a=t1(rc,r);return(0,m.jsx)(eK.p,{id:a.descriptionId,...s,ref:t})});rd.displayName=rc;var ru="DialogClose",rx=h.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,a=t1(ru,r);return(0,m.jsx)(eK.button,{type:"button",...s,ref:t,onClick:ez(e.onClick,()=>a.onOpenChange(!1))})});function rm(e){return e?"open":"closed"}rx.displayName=ru;var rp="DialogTitleWarning",[rh,rf]=(d={contentName:rr,titleName:ro,docsSlug:"dialog"},t=h.createContext(d),(r=e=>{let{children:r,...s}=e,a=h.useMemo(()=>s,Object.values(s));return(0,m.jsx)(t.Provider,{value:a,children:r})}).displayName=rp+"Provider",[r,function(e){let r=h.useContext(t);if(r)return r;if(void 0!==d)return d;throw Error(`\`${e}\` must be used within \`${rp}\``)}]),rg=({titleId:e})=>{let t=rf(rp),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return h.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},rv=({contentRef:e,descriptionId:t})=>{let r=rf("DialogDescriptionWarning"),s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${r.contentName}}.`;return h.useEffect(()=>{let r=e.current?.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(s))},[s,e,t]),null};let rb=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var ry={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let rj=(0,h.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:a="",children:n,iconNode:l,...o},i)=>(0,h.createElement)("svg",{ref:i,...ry,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:rb("lucide",a),...o},[...l.map(([e,t])=>(0,h.createElement)(e,t)),...Array.isArray(n)?n:[n]])),rw=(e,t)=>{let r=(0,h.forwardRef)(({className:r,...s},a)=>(0,h.createElement)(rj,{ref:a,iconNode:t,className:rb(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,r),...s}));return r.displayName=`${e}`,r},rN=rw("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function rk({...e}){return(0,m.jsx)(t2,{"data-slot":"dialog",...e})}function rC({...e}){return(0,m.jsx)(t3,{"data-slot":"dialog-trigger",...e})}function rS({...e}){return(0,m.jsx)(t9,{"data-slot":"dialog-portal",...e})}function rE({className:e,...t}){return(0,m.jsx)(re,{"data-slot":"dialog-overlay",className:eA("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function rT({className:e,children:t,showCloseButton:r=!0,...s}){return(0,m.jsxs)(rS,{"data-slot":"dialog-portal",children:[(0,m.jsx)(rE,{}),(0,m.jsxs)(rs,{"data-slot":"dialog-content",className:eA("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...s,children:[t,r&&(0,m.jsxs)(rx,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,m.jsx)(rN,{}),(0,m.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function rR({className:e,...t}){return(0,m.jsx)("div",{"data-slot":"dialog-header",className:eA("flex flex-col gap-2 text-center sm:text-left",e),...t})}function rM({className:e,...t}){return(0,m.jsx)("div",{"data-slot":"dialog-footer",className:eA("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function rD({className:e,...t}){return(0,m.jsx)(ri,{"data-slot":"dialog-title",className:eA("text-lg leading-none font-semibold",e),...t})}function rP({className:e,...t}){return(0,m.jsx)(rd,{"data-slot":"dialog-description",className:eA("text-muted-foreground text-sm",e),...t})}let rA=rw("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),rI=rw("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),rL=rw("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),rO=rw("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),rq=rw("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),rz=rw("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),rF=rw("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);var r_=e.i(4831);function rU(){return window.parent&&window.parent!==window}function rV(){let{projects:e,setSelectedProjectId:t,addProject:r}=(0,p.useProject)(),{setWorkflowsForProject:s,getWorkflowsForProject:a}=(0,f.useAutomation)(),[n,l]=(0,h.useState)(!1),[o,i]=(0,h.useState)(""),[c,d]=(0,h.useState)(""),[u,x]=(0,h.useState)(!1),[g,v]=(0,h.useState)(!1),[b,y]=(0,h.useState)(null),[j,w]=(0,h.useState)(null),[N,k]=(0,h.useState)(""),C=(0,h.useRef)(null),[S,E]=(0,h.useState)(!1),[T,R]=(0,h.useState)(!1),[M,D]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{let e=setTimeout(()=>E(!0),100),t=setTimeout(()=>R(!0),300),r=setTimeout(()=>D(!0),500);return()=>{clearTimeout(e),clearTimeout(t),clearTimeout(r)}},[]),(0,m.jsxs)("div",{className:"h-screen w-screen bg-background flex flex-col items-center justify-center p-6",children:[(0,m.jsxs)("div",{className:"flex flex-col items-center mb-10",children:[(0,m.jsxs)("div",{className:`flex items-center gap-3 mb-2 transition-all duration-500 ease-out ${S?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[(0,m.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center",children:(0,m.jsx)(rL,{className:"w-7 h-7 text-primary"})}),(0,m.jsx)("h1",{className:"text-4xl font-bold text-foreground tracking-tight",children:"Runyx"})]}),(0,m.jsx)("p",{className:`text-muted-foreground text-sm transition-all duration-500 ease-out ${T?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:"Browser automation for developers"})]}),(0,m.jsxs)("div",{className:`w-full max-w-md transition-all duration-500 ease-out ${M?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[(0,m.jsx)("h2",{className:"text-sm font-medium text-muted-foreground mb-3 px-1",children:"Your Projects"}),(0,m.jsx)("div",{className:"space-y-2 mb-6",children:0===e.length?(0,m.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,m.jsx)(rA,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),(0,m.jsx)("p",{className:"text-sm",children:"No projects yet"}),(0,m.jsx)("p",{className:"text-xs",children:"Create your first project to get started"})]}):e.map((e,r)=>(0,m.jsx)("button",{onClick:()=>{t(e.id)},className:"w-full p-4 rounded-lg border border-border bg-card hover:bg-accent/50 hover:border-primary/30 transition-all group text-left",style:{animationDelay:`${100*r}ms`},children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex items-center gap-3",children:[(0,m.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/10 border border-primary/20 flex items-center justify-center",children:(0,m.jsx)(rA,{className:"w-5 h-5 text-primary"})}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{className:"font-medium text-foreground",children:e.name}),(0,m.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description||"No description"})]})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsxs)("span",{className:"text-xs text-muted-foreground bg-secondary px-2 py-1 rounded",children:[e.workflowIds.length," workflow",1!==e.workflowIds.length?"s":""]}),(0,m.jsx)(rO,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})]})]})},e.id))}),(0,m.jsxs)(eL,{onClick:()=>l(!0),className:"w-full",variant:"outline",children:[(0,m.jsx)(rI,{className:"w-4 h-4 mr-2"}),"New Project"]}),(0,m.jsxs)("div",{className:"flex flex-col gap-2 mt-3",children:[(0,m.jsxs)(eL,{variant:"outline",className:"w-full",onClick:()=>x(!0),children:[(0,m.jsx)(rq,{className:"w-4 h-4 mr-2"}),"Import Project"]}),(0,m.jsxs)(eL,{variant:"outline",className:"w-full",onClick:()=>{e.length>0&&!N&&k(e[0].id),v(!0)},disabled:0===e.length,children:[(0,m.jsx)(rz,{className:"w-4 h-4 mr-2"}),"Export Project"]})]})]}),(0,m.jsx)(rk,{open:n,onOpenChange:l,children:(0,m.jsxs)(rT,{className:"sm:max-w-md",children:[(0,m.jsx)(rR,{children:(0,m.jsx)(rD,{children:"Create New Project"})}),(0,m.jsxs)("div",{className:"space-y-4 py-4",children:[(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)("label",{htmlFor:"project-name",className:"text-sm font-medium text-foreground",children:"Project Name"}),(0,m.jsx)(eO,{id:"project-name",placeholder:"My Awesome Project",value:o,onChange:e=>i(e.target.value),autoFocus:!0})]}),(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)("label",{htmlFor:"project-description",className:"text-sm font-medium text-foreground",children:"Description"}),(0,m.jsx)(eq,{id:"project-description",placeholder:"Describe what this project is for...",value:c,onChange:e=>d(e.target.value),rows:3})]})]}),(0,m.jsxs)(rM,{children:[(0,m.jsx)(eL,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),(0,m.jsx)(eL,{onClick:()=>{if(!o.trim())return;let e={id:`proj-${crypto.randomUUID()}`,name:o.trim(),description:c.trim(),workflowIds:[],createdAt:Date.now(),updatedAt:Date.now()};r(e),t(e.id),l(!1),i(""),d("")},disabled:!o.trim(),children:"Create Project"})]})]})}),(0,m.jsx)(rk,{open:u,onOpenChange:e=>{x(e),!e&&(w(null),y(null),C.current&&(C.current.value=""))},children:(0,m.jsxs)(rT,{className:"sm:max-w-md",children:[(0,m.jsx)(rR,{children:(0,m.jsx)(rD,{children:"Import Project"})}),(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center",children:[(0,m.jsx)("input",{ref:C,type:"file",accept:".json",className:"hidden",id:"project-file",onChange:e=>{let t=e.target.files?.[0];if(!t)return;y(null),w(null);let r=new FileReader;r.onload=e=>{try{let t=e.target?.result,r=JSON.parse(t);if(!r?.project||!r?.workflows||!Array.isArray(r.workflows))return void y("Invalid project file. Expected { project, workflows }");w({project:r.project,workflows:r.workflows})}catch{y("Failed to parse JSON file. Please ensure it's valid JSON.")}},r.readAsText(t)}}),(0,m.jsxs)("label",{htmlFor:"project-file",className:"cursor-pointer flex flex-col items-center gap-2",children:[(0,m.jsx)(rF,{className:"h-10 w-10 text-muted-foreground"}),(0,m.jsx)("span",{className:"text-sm text-muted-foreground",children:"Click to select a .json project file"})]})]}),b&&(0,m.jsx)("p",{className:"text-xs text-destructive",children:b}),j&&(0,m.jsxs)("div",{className:"p-3 rounded-lg border border-border bg-secondary/50",children:[(0,m.jsx)("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Preview"}),(0,m.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Name:"}),(0,m.jsx)("span",{className:"text-foreground font-medium",children:j.project?.name||"Imported Project"})]}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Description:"}),(0,m.jsx)("span",{className:"text-foreground",children:j.project?.description||"No description"})]}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Workflows:"}),(0,m.jsx)("span",{className:"text-foreground font-medium",children:j.workflows.length})]})]})]}),(0,m.jsxs)(rM,{className:"flex justify-end gap-2",children:[(0,m.jsx)(eL,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),(0,m.jsx)(eL,{onClick:()=>{if(!j)return;let a=j.workflows,n=j.project||{},l="string"==typeof n.id&&n.id.trim()?n.id.trim():`proj-${crypto.randomUUID()}`,o=e.some(e=>e.id===l)?`proj-${crypto.randomUUID()}`:l,i=a.map((e,t)=>({id:"string"==typeof e.id&&e.id.trim()?e.id.trim():`wf-${Date.now()}-${t}-${crypto.randomUUID()}`,name:"string"==typeof e.name&&e.name.trim()?e.name.trim():"Imported Workflow",description:"string"==typeof e.description?e.description:"",status:"paused"===e.status||"error"===e.status?e.status:"idle",steps:Array.isArray(e.steps)?e.steps:[],triggers:Array.isArray(e.triggers)?e.triggers:[],variables:e.variables&&"object"==typeof e.variables?e.variables:{},runs:[],settings:(0,r_.mergeSettingsWithDefaults)(e.settings),createdAt:"number"==typeof e.createdAt?e.createdAt:Date.now(),updatedAt:Date.now(),runCount:"number"==typeof e.runCount?e.runCount:0,lastRun:e.lastRun}));r({id:o,name:"string"==typeof n.name&&n.name.trim()?n.name.trim():"Imported Project",description:"string"==typeof n.description?n.description:"",workflowIds:i.map(e=>e.id),createdAt:"number"==typeof n.createdAt?n.createdAt:Date.now(),updatedAt:Date.now()}),s(o,i),t(o),x(!1),w(null),C.current&&(C.current.value="")},disabled:!j,children:"Import Project"})]})]})]})}),(0,m.jsx)(rk,{open:g,onOpenChange:t=>{v(t),t&&e.length>0&&k(t=>t||e[0].id)},children:(0,m.jsxs)(rT,{className:"sm:max-w-md",children:[(0,m.jsx)(rR,{children:(0,m.jsx)(rD,{children:"Export Project"})}),(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)("label",{className:"text-xs text-muted-foreground",children:"Choose project"}),(0,m.jsx)("select",{className:"w-full h-10 rounded-md border border-border bg-background px-3 text-sm",value:N,onChange:e=>k(e.target.value),children:e.map(e=>(0,m.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,m.jsxs)(rM,{children:[(0,m.jsx)(eL,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),(0,m.jsx)(eL,{onClick:async()=>{let t=e.find(e=>e.id===N)||e[0];if(!t)return;let r=JSON.stringify({version:"1.0.0",exportedAt:Date.now(),project:t,workflows:a(t.id)},null,2),s=`${t.name.toLowerCase().replace(/\s+/g,"-")}-project.json`;try{if(rU())await function(e){if(!rU())return Promise.reject(Error("Not in sandbox"));let t=crypto.randomUUID();return window.parent.postMessage({__fromSandbox:!0,requestId:t,payload:e},"*"),new Promise((e,r)=>{let s=setTimeout(()=>{window.removeEventListener("message",a),r(Error("Sandbox RPC timeout"))},3e3),a=n=>{let l=n.data;l?.__fromExtension&&l.requestId===t&&(clearTimeout(s),window.removeEventListener("message",a),l.error?r(Error(l.error)):e(l.response))};window.addEventListener("message",a)})}({type:"download.workflow",fileName:s,content:r});else{let e=new Blob([r],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)}}catch(e){console.warn("[export project] failed",e)}finally{v(!1)}},disabled:0===e.length,children:"Export Project"})]})]})]})})]})}function rW(e,[t,r]){return Math.min(r,Math.max(t,e))}function r$(e){let t=e+"CollectionProvider",[r,s]=eF(t),[a,n]=r(t,{collectionRef:{current:null},itemMap:new Map}),l=e=>{let{scope:t,children:r}=e,s=h.default.useRef(null),n=h.default.useRef(new Map).current;return(0,m.jsx)(a,{scope:t,itemMap:n,collectionRef:s,children:r})};l.displayName=t;let o=e+"CollectionSlot",i=h.default.forwardRef((e,t)=>{let{scope:r,children:s}=e,a=b(t,n(o,r).collectionRef);return(0,m.jsx)(y,{ref:a,children:s})});i.displayName=o;let c=e+"CollectionItemSlot",d="data-radix-collection-item",u=h.default.forwardRef((e,t)=>{let{scope:r,children:s,...a}=e,l=h.default.useRef(null),o=b(t,l),i=n(c,r);return h.default.useEffect(()=>(i.itemMap.set(l,{ref:l,...a}),()=>void i.itemMap.delete(l))),(0,m.jsx)(y,{...{[d]:""},ref:o,children:s})});return u.displayName=c,[{Provider:l,Slot:i,ItemSlot:u},function(t){let r=n(e+"CollectionConsumer",t);return h.default.useCallback(()=>{let e=r.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${d}]`));return Array.from(r.itemMap.values()).sort((e,r)=>t.indexOf(e.ref.current)-t.indexOf(r.ref.current))},[r.collectionRef,r.itemMap])},s]}var rB=h.createContext(void 0);function rH(e){let t=h.useContext(rB);return e||t||"ltr"}let rK=["top","right","bottom","left"],rG=Math.min,rJ=Math.max,rX=Math.round,rY=Math.floor,rZ=e=>({x:e,y:e}),rQ={left:"right",right:"left",bottom:"top",top:"bottom"},r0={start:"end",end:"start"};function r1(e,t){return"function"==typeof e?e(t):e}function r2(e){return e.split("-")[0]}function r5(e){return e.split("-")[1]}function r3(e){return"x"===e?"y":"x"}function r8(e){return"y"===e?"height":"width"}let r4=new Set(["top","bottom"]);function r6(e){return r4.has(r2(e))?"y":"x"}function r9(e){return e.replace(/start|end/g,e=>r0[e])}let r7=["left","right"],se=["right","left"],st=["top","bottom"],sr=["bottom","top"];function ss(e){return e.replace(/left|right|bottom|top/g,e=>rQ[e])}function sa(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function sn(e){let{x:t,y:r,width:s,height:a}=e;return{width:s,height:a,top:r,left:t,right:t+s,bottom:r+a,x:t,y:r}}function sl(e,t,r){let s,{reference:a,floating:n}=e,l=r6(t),o=r3(r6(t)),i=r8(o),c=r2(t),d="y"===l,u=a.x+a.width/2-n.width/2,x=a.y+a.height/2-n.height/2,m=a[i]/2-n[i]/2;switch(c){case"top":s={x:u,y:a.y-n.height};break;case"bottom":s={x:u,y:a.y+a.height};break;case"right":s={x:a.x+a.width,y:x};break;case"left":s={x:a.x-n.width,y:x};break;default:s={x:a.x,y:a.y}}switch(r5(t)){case"start":s[o]-=m*(r&&d?-1:1);break;case"end":s[o]+=m*(r&&d?-1:1)}return s}let so=async(e,t,r)=>{let{placement:s="bottom",strategy:a="absolute",middleware:n=[],platform:l}=r,o=n.filter(Boolean),i=await (null==l.isRTL?void 0:l.isRTL(t)),c=await l.getElementRects({reference:e,floating:t,strategy:a}),{x:d,y:u}=sl(c,s,i),x=s,m={},p=0;for(let r=0;r<o.length;r++){let{name:n,fn:h}=o[r],{x:f,y:g,data:v,reset:b}=await h({x:d,y:u,initialPlacement:s,placement:x,strategy:a,middlewareData:m,rects:c,platform:l,elements:{reference:e,floating:t}});d=null!=f?f:d,u=null!=g?g:u,m={...m,[n]:{...m[n],...v}},b&&p<=50&&(p++,"object"==typeof b&&(b.placement&&(x=b.placement),b.rects&&(c=!0===b.rects?await l.getElementRects({reference:e,floating:t,strategy:a}):b.rects),{x:d,y:u}=sl(c,x,i)),r=-1)}return{x:d,y:u,placement:x,strategy:a,middlewareData:m}};async function si(e,t){var r;void 0===t&&(t={});let{x:s,y:a,platform:n,rects:l,elements:o,strategy:i}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:x=!1,padding:m=0}=r1(t,e),p=sa(m),h=o[x?"floating"===u?"reference":"floating":u],f=sn(await n.getClippingRect({element:null==(r=await (null==n.isElement?void 0:n.isElement(h)))||r?h:h.contextElement||await (null==n.getDocumentElement?void 0:n.getDocumentElement(o.floating)),boundary:c,rootBoundary:d,strategy:i})),g="floating"===u?{x:s,y:a,width:l.floating.width,height:l.floating.height}:l.reference,v=await (null==n.getOffsetParent?void 0:n.getOffsetParent(o.floating)),b=await (null==n.isElement?void 0:n.isElement(v))&&await (null==n.getScale?void 0:n.getScale(v))||{x:1,y:1},y=sn(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:g,offsetParent:v,strategy:i}):g);return{top:(f.top-y.top+p.top)/b.y,bottom:(y.bottom-f.bottom+p.bottom)/b.y,left:(f.left-y.left+p.left)/b.x,right:(y.right-f.right+p.right)/b.x}}function sc(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function sd(e){return rK.some(t=>e[t]>=0)}let su=new Set(["left","top"]);async function sx(e,t){let{placement:r,platform:s,elements:a}=e,n=await (null==s.isRTL?void 0:s.isRTL(a.floating)),l=r2(r),o=r5(r),i="y"===r6(r),c=su.has(l)?-1:1,d=n&&i?-1:1,u=r1(t,e),{mainAxis:x,crossAxis:m,alignmentAxis:p}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return o&&"number"==typeof p&&(m="end"===o?-1*p:p),i?{x:m*d,y:x*c}:{x:x*c,y:m*d}}function sm(){return"undefined"!=typeof window}function sp(e){return sg(e)?(e.nodeName||"").toLowerCase():"#document"}function sh(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function sf(e){var t;return null==(t=(sg(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function sg(e){return!!sm()&&(e instanceof Node||e instanceof sh(e).Node)}function sv(e){return!!sm()&&(e instanceof Element||e instanceof sh(e).Element)}function sb(e){return!!sm()&&(e instanceof HTMLElement||e instanceof sh(e).HTMLElement)}function sy(e){return!!sm()&&"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof sh(e).ShadowRoot)}let sj=new Set(["inline","contents"]);function sw(e){let{overflow:t,overflowX:r,overflowY:s,display:a}=sA(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+r)&&!sj.has(a)}let sN=new Set(["table","td","th"]),sk=[":popover-open",":modal"];function sC(e){return sk.some(t=>{try{return e.matches(t)}catch(e){return!1}})}let sS=["transform","translate","scale","rotate","perspective"],sE=["transform","translate","scale","rotate","perspective","filter"],sT=["paint","layout","strict","content"];function sR(e){let t=sM(),r=sv(e)?sA(e):e;return sS.some(e=>!!r[e]&&"none"!==r[e])||!!r.containerType&&"normal"!==r.containerType||!t&&!!r.backdropFilter&&"none"!==r.backdropFilter||!t&&!!r.filter&&"none"!==r.filter||sE.some(e=>(r.willChange||"").includes(e))||sT.some(e=>(r.contain||"").includes(e))}function sM(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}let sD=new Set(["html","body","#document"]);function sP(e){return sD.has(sp(e))}function sA(e){return sh(e).getComputedStyle(e)}function sI(e){return sv(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function sL(e){if("html"===sp(e))return e;let t=e.assignedSlot||e.parentNode||sy(e)&&e.host||sf(e);return sy(t)?t.host:t}function sO(e,t,r){var s;void 0===t&&(t=[]),void 0===r&&(r=!0);let a=function e(t){let r=sL(t);return sP(r)?t.ownerDocument?t.ownerDocument.body:t.body:sb(r)&&sw(r)?r:e(r)}(e),n=a===(null==(s=e.ownerDocument)?void 0:s.body),l=sh(a);if(n){let e=sq(l);return t.concat(l,l.visualViewport||[],sw(a)?a:[],e&&r?sO(e):[])}return t.concat(a,sO(a,[],r))}function sq(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function sz(e){let t=sA(e),r=parseFloat(t.width)||0,s=parseFloat(t.height)||0,a=sb(e),n=a?e.offsetWidth:r,l=a?e.offsetHeight:s,o=rX(r)!==n||rX(s)!==l;return o&&(r=n,s=l),{width:r,height:s,$:o}}function sF(e){return sv(e)?e:e.contextElement}function s_(e){let t=sF(e);if(!sb(t))return rZ(1);let r=t.getBoundingClientRect(),{width:s,height:a,$:n}=sz(t),l=(n?rX(r.width):r.width)/s,o=(n?rX(r.height):r.height)/a;return l&&Number.isFinite(l)||(l=1),o&&Number.isFinite(o)||(o=1),{x:l,y:o}}let sU=rZ(0);function sV(e){let t=sh(e);return sM()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:sU}function sW(e,t,r,s){var a;void 0===t&&(t=!1),void 0===r&&(r=!1);let n=e.getBoundingClientRect(),l=sF(e),o=rZ(1);t&&(s?sv(s)&&(o=s_(s)):o=s_(e));let i=(void 0===(a=r)&&(a=!1),s&&(!a||s===sh(l))&&a)?sV(l):rZ(0),c=(n.left+i.x)/o.x,d=(n.top+i.y)/o.y,u=n.width/o.x,x=n.height/o.y;if(l){let e=sh(l),t=s&&sv(s)?sh(s):s,r=e,a=sq(r);for(;a&&s&&t!==r;){let e=s_(a),t=a.getBoundingClientRect(),s=sA(a),n=t.left+(a.clientLeft+parseFloat(s.paddingLeft))*e.x,l=t.top+(a.clientTop+parseFloat(s.paddingTop))*e.y;c*=e.x,d*=e.y,u*=e.x,x*=e.y,c+=n,d+=l,a=sq(r=sh(a))}}return sn({width:u,height:x,x:c,y:d})}function s$(e,t){let r=sI(e).scrollLeft;return t?t.left+r:sW(sf(e)).left+r}function sB(e,t){let r=e.getBoundingClientRect();return{x:r.left+t.scrollLeft-s$(e,r),y:r.top+t.scrollTop}}let sH=new Set(["absolute","fixed"]);function sK(e,t,r){var s;let a;if("viewport"===t)a=function(e,t){let r=sh(e),s=sf(e),a=r.visualViewport,n=s.clientWidth,l=s.clientHeight,o=0,i=0;if(a){n=a.width,l=a.height;let e=sM();(!e||e&&"fixed"===t)&&(o=a.offsetLeft,i=a.offsetTop)}let c=s$(s);if(c<=0){let e=s.ownerDocument,t=e.body,r=getComputedStyle(t),a="CSS1Compat"===e.compatMode&&parseFloat(r.marginLeft)+parseFloat(r.marginRight)||0,l=Math.abs(s.clientWidth-t.clientWidth-a);l<=25&&(n-=l)}else c<=25&&(n+=c);return{width:n,height:l,x:o,y:i}}(e,r);else if("document"===t){let t,r,n,l,o,i,c;s=sf(e),t=sf(s),r=sI(s),n=s.ownerDocument.body,l=rJ(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),o=rJ(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight),i=-r.scrollLeft+s$(s),c=-r.scrollTop,"rtl"===sA(n).direction&&(i+=rJ(t.clientWidth,n.clientWidth)-l),a={width:l,height:o,x:i,y:c}}else if(sv(t)){let e,s,n,l,o,i;s=(e=sW(t,!0,"fixed"===r)).top+t.clientTop,n=e.left+t.clientLeft,l=sb(t)?s_(t):rZ(1),o=t.clientWidth*l.x,i=t.clientHeight*l.y,a={width:o,height:i,x:n*l.x,y:s*l.y}}else{let r=sV(e);a={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return sn(a)}function sG(e){return"static"===sA(e).position}function sJ(e,t){if(!sb(e)||"fixed"===sA(e).position)return null;if(t)return t(e);let r=e.offsetParent;return sf(e)===r&&(r=r.ownerDocument.body),r}function sX(e,t){var r;let s=sh(e);if(sC(e))return s;if(!sb(e)){let t=sL(e);for(;t&&!sP(t);){if(sv(t)&&!sG(t))return t;t=sL(t)}return s}let a=sJ(e,t);for(;a&&(r=a,sN.has(sp(r)))&&sG(a);)a=sJ(a,t);return a&&sP(a)&&sG(a)&&!sR(a)?s:a||function(e){let t=sL(e);for(;sb(t)&&!sP(t);){if(sR(t))return t;if(sC(t))break;t=sL(t)}return null}(e)||s}let sY=async function(e){let t=this.getOffsetParent||sX,r=this.getDimensions,s=await r(e.floating);return{reference:function(e,t,r){let s=sb(t),a=sf(t),n="fixed"===r,l=sW(e,!0,n,t),o={scrollLeft:0,scrollTop:0},i=rZ(0);if(s||!s&&!n)if(("body"!==sp(t)||sw(a))&&(o=sI(t)),s){let e=sW(t,!0,n,t);i.x=e.x+t.clientLeft,i.y=e.y+t.clientTop}else a&&(i.x=s$(a));n&&!s&&a&&(i.x=s$(a));let c=!a||s||n?rZ(0):sB(a,o);return{x:l.left+o.scrollLeft-i.x-c.x,y:l.top+o.scrollTop-i.y-c.y,width:l.width,height:l.height}}(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}},sZ={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:r,offsetParent:s,strategy:a}=e,n="fixed"===a,l=sf(s),o=!!t&&sC(t.floating);if(s===l||o&&n)return r;let i={scrollLeft:0,scrollTop:0},c=rZ(1),d=rZ(0),u=sb(s);if((u||!u&&!n)&&(("body"!==sp(s)||sw(l))&&(i=sI(s)),sb(s))){let e=sW(s);c=s_(s),d.x=e.x+s.clientLeft,d.y=e.y+s.clientTop}let x=!l||u||n?rZ(0):sB(l,i);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-i.scrollLeft*c.x+d.x+x.x,y:r.y*c.y-i.scrollTop*c.y+d.y+x.y}},getDocumentElement:sf,getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:s,strategy:a}=e,n=[..."clippingAncestors"===r?sC(t)?[]:function(e,t){let r=t.get(e);if(r)return r;let s=sO(e,[],!1).filter(e=>sv(e)&&"body"!==sp(e)),a=null,n="fixed"===sA(e).position,l=n?sL(e):e;for(;sv(l)&&!sP(l);){let t=sA(l),r=sR(l);r||"fixed"!==t.position||(a=null),(n?!r&&!a:!r&&"static"===t.position&&!!a&&sH.has(a.position)||sw(l)&&!r&&function e(t,r){let s=sL(t);return!(s===r||!sv(s)||sP(s))&&("fixed"===sA(s).position||e(s,r))}(e,l))?s=s.filter(e=>e!==l):a=t,l=sL(l)}return t.set(e,s),s}(t,this._c):[].concat(r),s],l=n[0],o=n.reduce((e,r)=>{let s=sK(t,r,a);return e.top=rJ(s.top,e.top),e.right=rG(s.right,e.right),e.bottom=rG(s.bottom,e.bottom),e.left=rJ(s.left,e.left),e},sK(t,l,a));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:sX,getElementRects:sY,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){let{width:t,height:r}=sz(e);return{width:t,height:r}},getScale:s_,isElement:sv,isRTL:function(e){return"rtl"===sA(e).direction}};function sQ(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}let s0=e=>({name:"arrow",options:e,async fn(t){let{x:r,y:s,placement:a,rects:n,platform:l,elements:o,middlewareData:i}=t,{element:c,padding:d=0}=r1(e,t)||{};if(null==c)return{};let u=sa(d),x={x:r,y:s},m=r3(r6(a)),p=r8(m),h=await l.getDimensions(c),f="y"===m,g=f?"clientHeight":"clientWidth",v=n.reference[p]+n.reference[m]-x[m]-n.floating[p],b=x[m]-n.reference[m],y=await (null==l.getOffsetParent?void 0:l.getOffsetParent(c)),j=y?y[g]:0;j&&await (null==l.isElement?void 0:l.isElement(y))||(j=o.floating[g]||n.floating[p]);let w=j/2-h[p]/2-1,N=rG(u[f?"top":"left"],w),k=rG(u[f?"bottom":"right"],w),C=j-h[p]-k,S=j/2-h[p]/2+(v/2-b/2),E=rJ(N,rG(S,C)),T=!i.arrow&&null!=r5(a)&&S!==E&&n.reference[p]/2-(S<N?N:k)-h[p]/2<0,R=T?S<N?S-N:S-C:0;return{[m]:x[m]+R,data:{[m]:E,centerOffset:S-E-R,...T&&{alignmentOffset:R}},reset:T}}});var s1="undefined"!=typeof document?h.useLayoutEffect:function(){};function s2(e,t){let r,s,a;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((r=e.length)!==t.length)return!1;for(s=r;0!=s--;)if(!s2(e[s],t[s]))return!1;return!0}if((r=(a=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(s=r;0!=s--;)if(!({}).hasOwnProperty.call(t,a[s]))return!1;for(s=r;0!=s--;){let r=a[s];if(("_owner"!==r||!e.$$typeof)&&!s2(e[r],t[r]))return!1}return!0}return e!=e&&t!=t}function s5(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function s3(e,t){let r=s5(e);return Math.round(t*r)/r}function s8(e){let t=h.useRef(e);return s1(()=>{t.current=e}),t}var s4=h.forwardRef((e,t)=>{let{children:r,width:s=10,height:a=5,...n}=e;return(0,m.jsx)(eK.svg,{...n,ref:t,width:s,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:(0,m.jsx)("polygon",{points:"0,0 30,0 15,10"})})});function s6(e){let[t,r]=h.useState(void 0);return e_(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,a;if(!Array.isArray(t)||!t.length)return;let n=t[0];if("borderBoxSize"in n){let e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,a=t.blockSize}else s=e.offsetWidth,a=e.offsetHeight;r({width:s,height:a})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}s4.displayName="Arrow";var s9="Popper",[s7,ae]=eF(s9),[at,ar]=s7(s9),as=e=>{let{__scopePopper:t,children:r}=e,[s,a]=h.useState(null);return(0,m.jsx)(at,{scope:t,anchor:s,onAnchorChange:a,children:r})};as.displayName=s9;var aa="PopperAnchor",an=h.forwardRef((e,t)=>{let{__scopePopper:r,virtualRef:s,...a}=e,n=ar(aa,r),l=h.useRef(null),o=b(t,l);return h.useEffect(()=>{n.onAnchorChange(s?.current||l.current)}),s?null:(0,m.jsx)(eK.div,{...a,ref:o})});an.displayName=aa;var al="PopperContent",[ao,ai]=s7(al),ac=h.forwardRef((e,t)=>{var r,s,a,n,l,o,i,c,d,u,x,p,f,g,v,y,j,w,N,k,C;let{__scopePopper:S,side:E="bottom",sideOffset:T=0,align:R="center",alignOffset:M=0,arrowPadding:D=0,avoidCollisions:P=!0,collisionBoundary:A=[],collisionPadding:I=0,sticky:L="partial",hideWhenDetached:O=!1,updatePositionStrategy:q="optimized",onPlaced:z,...F}=e,_=ar(al,S),[U,V]=h.useState(null),W=b(t,e=>V(e)),[$,B]=h.useState(null),H=s6($),K=H?.width??0,G=H?.height??0,J="number"==typeof I?I:{top:0,right:0,bottom:0,left:0,...I},X=Array.isArray(A)?A:[A],Y=X.length>0,Z={padding:J,boundary:X.filter(am),altBoundary:Y},{refs:Q,floatingStyles:ee,placement:et,isPositioned:er,middlewareData:es}=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:r="absolute",middleware:s=[],platform:a,elements:{reference:n,floating:l}={},transform:o=!0,whileElementsMounted:i,open:c}=e,[d,u]=h.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[x,m]=h.useState(s);s2(x,s)||m(s);let[p,f]=h.useState(null),[g,v]=h.useState(null),b=h.useCallback(e=>{e!==N.current&&(N.current=e,f(e))},[]),y=h.useCallback(e=>{e!==k.current&&(k.current=e,v(e))},[]),j=n||p,w=l||g,N=h.useRef(null),k=h.useRef(null),C=h.useRef(d),S=null!=i,E=s8(i),T=s8(a),R=s8(c),M=h.useCallback(()=>{var e,s;let a,n,l;if(!N.current||!k.current)return;let o={placement:t,strategy:r,middleware:x};T.current&&(o.platform=T.current),(e=N.current,s=k.current,a=new Map,l={...(n={platform:sZ,...o}).platform,_c:a},so(e,s,{...n,platform:l})).then(e=>{let t={...e,isPositioned:!1!==R.current};D.current&&!s2(C.current,t)&&(C.current=t,eH.flushSync(()=>{u(t)}))})},[x,t,r,T,R]);s1(()=>{!1===c&&C.current.isPositioned&&(C.current.isPositioned=!1,u(e=>({...e,isPositioned:!1})))},[c]);let D=h.useRef(!1);s1(()=>(D.current=!0,()=>{D.current=!1}),[]),s1(()=>{if(j&&(N.current=j),w&&(k.current=w),j&&w){if(E.current)return E.current(j,w,M);M()}},[j,w,M,E,S]);let P=h.useMemo(()=>({reference:N,floating:k,setReference:b,setFloating:y}),[b,y]),A=h.useMemo(()=>({reference:j,floating:w}),[j,w]),I=h.useMemo(()=>{let e={position:r,left:0,top:0};if(!A.floating)return e;let t=s3(A.floating,d.x),s=s3(A.floating,d.y);return o?{...e,transform:"translate("+t+"px, "+s+"px)",...s5(A.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:s}},[r,o,A.floating,d.x,d.y]);return h.useMemo(()=>({...d,update:M,refs:P,elements:A,floatingStyles:I}),[d,M,P,A,I])}({strategy:"fixed",placement:E+("center"!==R?"-"+R:""),whileElementsMounted:(...e)=>(function(e,t,r,s){let a;void 0===s&&(s={});let{ancestorScroll:n=!0,ancestorResize:l=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:i="function"==typeof IntersectionObserver,animationFrame:c=!1}=s,d=sF(e),u=n||l?[...d?sO(d):[],...sO(t)]:[];u.forEach(e=>{n&&e.addEventListener("scroll",r,{passive:!0}),l&&e.addEventListener("resize",r)});let x=d&&i?function(e,t){let r,s=null,a=sf(e);function n(){var e;clearTimeout(r),null==(e=s)||e.disconnect(),s=null}return!function l(o,i){void 0===o&&(o=!1),void 0===i&&(i=1),n();let c=e.getBoundingClientRect(),{left:d,top:u,width:x,height:m}=c;if(o||t(),!x||!m)return;let p={rootMargin:-rY(u)+"px "+-rY(a.clientWidth-(d+x))+"px "+-rY(a.clientHeight-(u+m))+"px "+-rY(d)+"px",threshold:rJ(0,rG(1,i))||1},h=!0;function f(t){let s=t[0].intersectionRatio;if(s!==i){if(!h)return l();s?l(!1,s):r=setTimeout(()=>{l(!1,1e-7)},1e3)}1!==s||sQ(c,e.getBoundingClientRect())||l(),h=!1}try{s=new IntersectionObserver(f,{...p,root:a.ownerDocument})}catch(e){s=new IntersectionObserver(f,p)}s.observe(e)}(!0),n}(d,r):null,m=-1,p=null;o&&(p=new ResizeObserver(e=>{let[s]=e;s&&s.target===d&&p&&(p.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var e;null==(e=p)||e.observe(t)})),r()}),d&&!c&&p.observe(d),p.observe(t));let h=c?sW(e):null;return c&&function t(){let s=sW(e);h&&!sQ(h,s)&&r(),h=s,a=requestAnimationFrame(t)}(),r(),()=>{var e;u.forEach(e=>{n&&e.removeEventListener("scroll",r),l&&e.removeEventListener("resize",r)}),null==x||x(),null==(e=p)||e.disconnect(),p=null,c&&cancelAnimationFrame(a)}})(...e,{animationFrame:"always"===q}),elements:{reference:_.anchor},middleware:[{...{name:"offset",options:a=r={mainAxis:T+G,alignmentAxis:M},async fn(e){var t,r;let{x:s,y:n,placement:l,middlewareData:o}=e,i=await sx(e,a);return l===(null==(t=o.offset)?void 0:t.placement)&&null!=(r=o.arrow)&&r.alignmentOffset?{}:{x:s+i.x,y:n+i.y,data:{...i,placement:l}}}},options:[r,s]},P&&{...{name:"shift",options:d=i={mainAxis:!0,crossAxis:!1,limiter:"partial"===L?{...(void 0===(o=n)&&(o={}),{options:o,fn(e){let{x:t,y:r,placement:s,rects:a,middlewareData:n}=e,{offset:l=0,mainAxis:i=!0,crossAxis:c=!0}=r1(o,e),d={x:t,y:r},u=r6(s),x=r3(u),m=d[x],p=d[u],h=r1(l,e),f="number"==typeof h?{mainAxis:h,crossAxis:0}:{mainAxis:0,crossAxis:0,...h};if(i){let e="y"===x?"height":"width",t=a.reference[x]-a.floating[e]+f.mainAxis,r=a.reference[x]+a.reference[e]-f.mainAxis;m<t?m=t:m>r&&(m=r)}if(c){var g,v;let e="y"===x?"width":"height",t=su.has(r2(s)),r=a.reference[u]-a.floating[e]+(t&&(null==(g=n.offset)?void 0:g[u])||0)+(t?0:f.crossAxis),l=a.reference[u]+a.reference[e]+(t?0:(null==(v=n.offset)?void 0:v[u])||0)-(t?f.crossAxis:0);p<r?p=r:p>l&&(p=l)}return{[x]:m,[u]:p}}}),options:[n,l]}:void 0,...Z},async fn(e){let{x:t,y:r,placement:s}=e,{mainAxis:a=!0,crossAxis:n=!1,limiter:l={fn:e=>{let{x:t,y:r}=e;return{x:t,y:r}}},...o}=r1(d,e),i={x:t,y:r},c=await si(e,o),u=r6(r2(s)),x=r3(u),m=i[x],p=i[u];if(a){let e="y"===x?"top":"left",t="y"===x?"bottom":"right",r=m+c[e],s=m-c[t];m=rJ(r,rG(m,s))}if(n){let e="y"===u?"top":"left",t="y"===u?"bottom":"right",r=p+c[e],s=p-c[t];p=rJ(r,rG(p,s))}let h=l.fn({...e,[x]:m,[u]:p});return{...h,data:{x:h.x-t,y:h.y-r,enabled:{[x]:a,[u]:n}}}}},options:[i,c]},P&&{...{name:"flip",options:p=u={...Z},async fn(e){var t,r,s,a,n,l,o,i;let c,d,u,{placement:x,middlewareData:m,rects:h,initialPlacement:f,platform:g,elements:v}=e,{mainAxis:b=!0,crossAxis:y=!0,fallbackPlacements:j,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:k=!0,...C}=r1(p,e);if(null!=(t=m.arrow)&&t.alignmentOffset)return{};let S=r2(x),E=r6(f),T=r2(f)===f,R=await (null==g.isRTL?void 0:g.isRTL(v.floating)),M=j||(T||!k?[ss(f)]:(c=ss(f),[r9(f),c,r9(c)])),D="none"!==N;!j&&D&&M.push(...(d=r5(f),u=function(e,t,r){switch(e){case"top":case"bottom":if(r)return t?se:r7;return t?r7:se;case"left":case"right":return t?st:sr;default:return[]}}(r2(f),"start"===N,R),d&&(u=u.map(e=>e+"-"+d),k&&(u=u.concat(u.map(r9)))),u));let P=[f,...M],A=await si(e,C),I=[],L=(null==(r=m.flip)?void 0:r.overflows)||[];if(b&&I.push(A[S]),y){let e,t,r,s,a=(l=x,o=h,void 0===(i=R)&&(i=!1),e=r5(l),r=r8(t=r3(r6(l))),s="x"===t?e===(i?"end":"start")?"right":"left":"start"===e?"bottom":"top",o.reference[r]>o.floating[r]&&(s=ss(s)),[s,ss(s)]);I.push(A[a[0]],A[a[1]])}if(L=[...L,{placement:x,overflows:I}],!I.every(e=>e<=0)){let e=((null==(s=m.flip)?void 0:s.index)||0)+1,t=P[e];if(t&&("alignment"!==y||E===r6(t)||L.every(e=>r6(e.placement)!==E||e.overflows[0]>0)))return{data:{index:e,overflows:L},reset:{placement:t}};let r=null==(a=L.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:a.placement;if(!r)switch(w){case"bestFit":{let e=null==(n=L.filter(e=>{if(D){let t=r6(e.placement);return t===E||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:n[0];e&&(r=e);break}case"initialPlacement":r=f}if(x!==r)return{reset:{placement:r}}}return{}}},options:[u,x]},{...{name:"size",options:v=f={...Z,apply:({elements:e,rects:t,availableWidth:r,availableHeight:s})=>{let{width:a,height:n}=t.reference,l=e.floating.style;l.setProperty("--radix-popper-available-width",`${r}px`),l.setProperty("--radix-popper-available-height",`${s}px`),l.setProperty("--radix-popper-anchor-width",`${a}px`),l.setProperty("--radix-popper-anchor-height",`${n}px`)}},async fn(e){var t,r;let s,a,{placement:n,rects:l,platform:o,elements:i}=e,{apply:c=()=>{},...d}=r1(v,e),u=await si(e,d),x=r2(n),m=r5(n),p="y"===r6(n),{width:h,height:f}=l.floating;"top"===x||"bottom"===x?(s=x,a=m===(await (null==o.isRTL?void 0:o.isRTL(i.floating))?"start":"end")?"left":"right"):(a=x,s="end"===m?"top":"bottom");let g=f-u.top-u.bottom,b=h-u.left-u.right,y=rG(f-u[s],g),j=rG(h-u[a],b),w=!e.middlewareData.shift,N=y,k=j;if(null!=(t=e.middlewareData.shift)&&t.enabled.x&&(k=b),null!=(r=e.middlewareData.shift)&&r.enabled.y&&(N=g),w&&!m){let e=rJ(u.left,0),t=rJ(u.right,0),r=rJ(u.top,0),s=rJ(u.bottom,0);p?k=h-2*(0!==e||0!==t?e+t:rJ(u.left,u.right)):N=f-2*(0!==r||0!==s?r+s:rJ(u.top,u.bottom))}await c({...e,availableWidth:k,availableHeight:N});let C=await o.getDimensions(i.floating);return h!==C.width||f!==C.height?{reset:{rects:!0}}:{}}},options:[f,g]},$&&{...{name:"arrow",options:w=y={element:$,padding:D},fn(e){let{element:t,padding:r}="function"==typeof w?w(e):w;return t&&({}).hasOwnProperty.call(t,"current")?null!=t.current?s0({element:t.current,padding:r}).fn(e):{}:t?s0({element:t,padding:r}).fn(e):{}}},options:[y,j]},ap({arrowWidth:K,arrowHeight:G}),O&&{...{name:"hide",options:C=N={strategy:"referenceHidden",...Z},async fn(e){let{rects:t}=e,{strategy:r="referenceHidden",...s}=r1(C,e);switch(r){case"referenceHidden":{let r=sc(await si(e,{...s,elementContext:"reference"}),t.reference);return{data:{referenceHiddenOffsets:r,referenceHidden:sd(r)}}}case"escaped":{let r=sc(await si(e,{...s,altBoundary:!0}),t.floating);return{data:{escapedOffsets:r,escaped:sd(r)}}}default:return{}}}},options:[N,k]}]}),[ea,en]=ah(et),el=e$(z);e_(()=>{er&&el?.()},[er,el]);let eo=es.arrow?.x,ei=es.arrow?.y,ec=es.arrow?.centerOffset!==0,[ed,eu]=h.useState();return e_(()=>{U&&eu(window.getComputedStyle(U).zIndex)},[U]),(0,m.jsx)("div",{ref:Q.setFloating,"data-radix-popper-content-wrapper":"",style:{...ee,transform:er?ee.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ed,"--radix-popper-transform-origin":[es.transformOrigin?.x,es.transformOrigin?.y].join(" "),...es.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:(0,m.jsx)(ao,{scope:S,placedSide:ea,onArrowChange:B,arrowX:eo,arrowY:ei,shouldHideArrow:ec,children:(0,m.jsx)(eK.div,{"data-side":ea,"data-align":en,...F,ref:W,style:{...F.style,animation:er?void 0:"none"}})})})});ac.displayName=al;var ad="PopperArrow",au={top:"bottom",right:"left",bottom:"top",left:"right"},ax=h.forwardRef(function(e,t){let{__scopePopper:r,...s}=e,a=ai(ad,r),n=au[a.placedSide];return(0,m.jsx)("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[n]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:(0,m.jsx)(s4,{...s,ref:t,style:{...s.style,display:"block"}})})});function am(e){return null!==e}ax.displayName=ad;var ap=e=>({name:"transformOrigin",options:e,fn(t){let{placement:r,rects:s,middlewareData:a}=t,n=a.arrow?.centerOffset!==0,l=n?0:e.arrowWidth,o=n?0:e.arrowHeight,[i,c]=ah(r),d={start:"0%",center:"50%",end:"100%"}[c],u=(a.arrow?.x??0)+l/2,x=(a.arrow?.y??0)+o/2,m="",p="";return"bottom"===i?(m=n?d:`${u}px`,p=`${-o}px`):"top"===i?(m=n?d:`${u}px`,p=`${s.floating.height+o}px`):"right"===i?(m=`${-o}px`,p=n?d:`${x}px`):"left"===i&&(m=`${s.floating.width+o}px`,p=n?d:`${x}px`),{data:{x:m,y:p}}}});function ah(e){let[t,r="center"]=e.split("-");return[t,r]}function af(e){let t=h.useRef({value:e,previous:e});return h.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var ag=h.forwardRef((e,t)=>(0,m.jsx)(eK.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));ag.displayName="VisuallyHidden";var av=[" ","Enter","ArrowUp","ArrowDown"],ab=[" ","Enter"],ay="Select",[aj,aw,aN]=r$(ay),[ak,aC]=eF(ay,[aN,ae]),aS=ae(),[aE,aT]=ak(ay),[aR,aM]=ak(ay),aD=e=>{let{__scopeSelect:t,children:r,open:s,defaultOpen:a,onOpenChange:n,value:l,defaultValue:o,onValueChange:i,dir:c,name:d,autoComplete:u,disabled:x,required:p,form:f}=e,g=aS(t),[v,b]=h.useState(null),[y,j]=h.useState(null),[w,N]=h.useState(!1),k=rH(c),[C=!1,S]=eB({prop:s,defaultProp:a,onChange:n}),[E,T]=eB({prop:l,defaultProp:o,onChange:i}),R=h.useRef(null),M=!v||f||!!v.closest("form"),[D,P]=h.useState(new Set),A=Array.from(D).map(e=>e.props.value).join(";");return(0,m.jsx)(as,{...g,children:(0,m.jsxs)(aE,{required:p,scope:t,trigger:v,onTriggerChange:b,valueNode:y,onValueNodeChange:j,valueNodeHasChildren:w,onValueNodeHasChildrenChange:N,contentId:eW(),value:E,onValueChange:T,open:C,onOpenChange:S,dir:k,triggerPointerDownPosRef:R,disabled:x,children:[(0,m.jsx)(aj.Provider,{scope:t,children:(0,m.jsx)(aR,{scope:e.__scopeSelect,onNativeOptionAdd:h.useCallback(e=>{P(t=>new Set(t).add(e))},[]),onNativeOptionRemove:h.useCallback(e=>{P(t=>{let r=new Set(t);return r.delete(e),r})},[]),children:r})}),M?(0,m.jsxs)(na,{"aria-hidden":!0,required:p,tabIndex:-1,name:d,autoComplete:u,value:E,onChange:e=>T(e.target.value),disabled:x,form:f,children:[void 0===E?(0,m.jsx)("option",{value:""}):null,Array.from(D)]},A):null]})})};aD.displayName=ay;var aP="SelectTrigger",aA=h.forwardRef((e,t)=>{let{__scopeSelect:r,disabled:s=!1,...a}=e,n=aS(r),l=aT(aP,r),o=l.disabled||s,i=b(t,l.onTriggerChange),c=aw(r),d=h.useRef("touch"),[u,x,p]=nn(e=>{let t=c().filter(e=>!e.disabled),r=t.find(e=>e.value===l.value),s=nl(t,e,r);void 0!==s&&l.onValueChange(s.value)}),f=e=>{o||(l.onOpenChange(!0),p()),e&&(l.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return(0,m.jsx)(an,{asChild:!0,...n,children:(0,m.jsx)(eK.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":ns(l.value)?"":void 0,...a,ref:i,onClick:ez(a.onClick,e=>{e.currentTarget.focus(),"mouse"!==d.current&&f(e)}),onPointerDown:ez(a.onPointerDown,e=>{d.current=e.pointerType;let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(f(e),e.preventDefault())}),onKeyDown:ez(a.onKeyDown,e=>{let t=""!==u.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||x(e.key),(!t||" "!==e.key)&&av.includes(e.key)&&(f(),e.preventDefault())})})})});aA.displayName=aP;var aI="SelectValue",aL=h.forwardRef((e,t)=>{let{__scopeSelect:r,className:s,style:a,children:n,placeholder:l="",...o}=e,i=aT(aI,r),{onValueNodeHasChildrenChange:c}=i,d=void 0!==n,u=b(t,i.onValueNodeChange);return e_(()=>{c(d)},[c,d]),(0,m.jsx)(eK.span,{...o,ref:u,style:{pointerEvents:"none"},children:ns(i.value)?(0,m.jsx)(m.Fragment,{children:l}):n})});aL.displayName=aI;var aO=h.forwardRef((e,t)=>{let{__scopeSelect:r,children:s,...a}=e;return(0,m.jsx)(eK.span,{"aria-hidden":!0,...a,ref:t,children:s||""})});aO.displayName="SelectIcon";var aq=e=>(0,m.jsx)(e7,{asChild:!0,...e});aq.displayName="SelectPortal";var az="SelectContent",aF=h.forwardRef((e,t)=>{let r=aT(az,e.__scopeSelect),[s,a]=h.useState();return(e_(()=>{a(new DocumentFragment)},[]),r.open)?(0,m.jsx)(aV,{...e,ref:t}):s?eH.createPortal((0,m.jsx)(a_,{scope:e.__scopeSelect,children:(0,m.jsx)(aj.Slot,{scope:e.__scopeSelect,children:(0,m.jsx)("div",{children:e.children})})}),s):null});aF.displayName=az;var[a_,aU]=ak(az),aV=h.forwardRef((e,t)=>{let{__scopeSelect:r,position:s="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:n,onPointerDownOutside:l,side:o,sideOffset:i,align:c,alignOffset:d,arrowPadding:u,collisionBoundary:x,collisionPadding:p,sticky:f,hideWhenDetached:g,avoidCollisions:v,...j}=e,w=aT(az,r),[N,k]=h.useState(null),[C,S]=h.useState(null),E=b(t,e=>k(e)),[T,R]=h.useState(null),[M,D]=h.useState(null),P=aw(r),[A,I]=h.useState(!1),L=h.useRef(!1);h.useEffect(()=>{if(N)return tX(N)},[N]),ts();let O=h.useCallback(e=>{let[t,...r]=P().map(e=>e.ref.current),[s]=r.slice(-1),a=document.activeElement;for(let r of e)if(r===a||(r?.scrollIntoView({block:"nearest"}),r===t&&C&&(C.scrollTop=0),r===s&&C&&(C.scrollTop=C.scrollHeight),r?.focus(),document.activeElement!==a))return},[P,C]),q=h.useCallback(()=>O([T,N]),[O,T,N]);h.useEffect(()=>{A&&q()},[A,q]);let{onOpenChange:z,triggerPointerDownPosRef:F}=w;h.useEffect(()=>{if(N){let e={x:0,y:0},t=t=>{e={x:Math.abs(Math.round(t.pageX)-(F.current?.x??0)),y:Math.abs(Math.round(t.pageY)-(F.current?.y??0))}},r=r=>{e.x<=10&&e.y<=10?r.preventDefault():N.contains(r.target)||z(!1),document.removeEventListener("pointermove",t),F.current=null};return null!==F.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",r,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",r,{capture:!0})}}},[N,z,F]),h.useEffect(()=>{let e=()=>z(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[z]);let[_,U]=nn(e=>{let t=P().filter(e=>!e.disabled),r=t.find(e=>e.ref.current===document.activeElement),s=nl(t,e,r);s&&setTimeout(()=>s.ref.current.focus())}),V=h.useCallback((e,t,r)=>{let s=!L.current&&!r;(void 0!==w.value&&w.value===t||s)&&(R(e),s&&(L.current=!0))},[w.value]),W=h.useCallback(()=>N?.focus(),[N]),$=h.useCallback((e,t,r)=>{let s=!L.current&&!r;(void 0!==w.value&&w.value===t||s)&&D(e)},[w.value]),B="popper"===s?a$:aW,H=B===a$?{side:o,sideOffset:i,align:c,alignOffset:d,arrowPadding:u,collisionBoundary:x,collisionPadding:p,sticky:f,hideWhenDetached:g,avoidCollisions:v}:{};return(0,m.jsx)(a_,{scope:r,content:N,viewport:C,onViewportChange:S,itemRefCallback:V,selectedItem:T,onItemLeave:W,itemTextRefCallback:$,focusSelectedItem:q,selectedItemText:M,position:s,isPositioned:A,searchRef:_,children:(0,m.jsx)(tW,{as:y,allowPinchZoom:!0,children:(0,m.jsx)(e5,{asChild:!0,trapped:w.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:ez(a,e=>{w.trigger?.focus({preventScroll:!0}),e.preventDefault()}),children:(0,m.jsx)(eY,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:n,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:(0,m.jsx)(B,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:e=>e.preventDefault(),...j,...H,onPlaced:()=>I(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...j.style},onKeyDown:ez(j.onKeyDown,e=>{let t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||U(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=P().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){let r=e.target,s=t.indexOf(r);t=t.slice(s+1)}setTimeout(()=>O(t)),e.preventDefault()}})})})})})})});aV.displayName="SelectContentImpl";var aW=h.forwardRef((e,t)=>{let{__scopeSelect:r,onPlaced:s,...a}=e,n=aT(az,r),l=aU(az,r),[o,i]=h.useState(null),[c,d]=h.useState(null),u=b(t,e=>d(e)),x=aw(r),p=h.useRef(!1),f=h.useRef(!0),{viewport:g,selectedItem:v,selectedItemText:y,focusSelectedItem:j}=l,w=h.useCallback(()=>{if(n.trigger&&n.valueNode&&o&&c&&g&&v&&y){let e=n.trigger.getBoundingClientRect(),t=c.getBoundingClientRect(),r=n.valueNode.getBoundingClientRect(),a=y.getBoundingClientRect();if("rtl"!==n.dir){let s=a.left-t.left,n=r.left-s,l=e.left-n,i=e.width+l,c=Math.max(i,t.width),d=rW(n,[10,Math.max(10,window.innerWidth-10-c)]);o.style.minWidth=i+"px",o.style.left=d+"px"}else{let s=t.right-a.right,n=window.innerWidth-r.right-s,l=window.innerWidth-e.right-n,i=e.width+l,c=Math.max(i,t.width),d=rW(n,[10,Math.max(10,window.innerWidth-10-c)]);o.style.minWidth=i+"px",o.style.right=d+"px"}let l=x(),i=window.innerHeight-20,d=g.scrollHeight,u=window.getComputedStyle(c),m=parseInt(u.borderTopWidth,10),h=parseInt(u.paddingTop,10),f=parseInt(u.borderBottomWidth,10),b=m+h+d+parseInt(u.paddingBottom,10)+f,j=Math.min(5*v.offsetHeight,b),w=window.getComputedStyle(g),N=parseInt(w.paddingTop,10),k=parseInt(w.paddingBottom,10),C=e.top+e.height/2-10,S=v.offsetHeight/2,E=m+h+(v.offsetTop+S);if(E<=C){let e=l.length>0&&v===l[l.length-1].ref.current;o.style.bottom="0px";let t=Math.max(i-C,S+(e?k:0)+(c.clientHeight-g.offsetTop-g.offsetHeight)+f);o.style.height=E+t+"px"}else{let e=l.length>0&&v===l[0].ref.current;o.style.top="0px";let t=Math.max(C,m+g.offsetTop+(e?N:0)+S);o.style.height=t+(b-E)+"px",g.scrollTop=E-C+g.offsetTop}o.style.margin="10px 0",o.style.minHeight=j+"px",o.style.maxHeight=i+"px",s?.(),requestAnimationFrame(()=>p.current=!0)}},[x,n.trigger,n.valueNode,o,c,g,v,y,n.dir,s]);e_(()=>w(),[w]);let[N,k]=h.useState();e_(()=>{c&&k(window.getComputedStyle(c).zIndex)},[c]);let C=h.useCallback(e=>{e&&!0===f.current&&(w(),j?.(),f.current=!1)},[w,j]);return(0,m.jsx)(aB,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:C,children:(0,m.jsx)("div",{ref:i,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:(0,m.jsx)(eK.div,{...a,ref:u,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});aW.displayName="SelectItemAlignedPosition";var a$=h.forwardRef((e,t)=>{let{__scopeSelect:r,align:s="start",collisionPadding:a=10,...n}=e,l=aS(r);return(0,m.jsx)(ac,{...l,...n,ref:t,align:s,collisionPadding:a,style:{boxSizing:"border-box",...n.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});a$.displayName="SelectPopperPosition";var[aB,aH]=ak(az,{}),aK="SelectViewport",aG=h.forwardRef((e,t)=>{let{__scopeSelect:r,nonce:s,...a}=e,n=aU(aK,r),l=aH(aK,r),o=b(t,n.onViewportChange),i=h.useRef(0);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),(0,m.jsx)(aj.Slot,{scope:r,children:(0,m.jsx)(eK.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ez(a.onScroll,e=>{let t=e.currentTarget,{contentWrapper:r,shouldExpandOnScrollRef:s}=l;if(s?.current&&r){let e=Math.abs(i.current-t.scrollTop);if(e>0){let s=window.innerHeight-20,a=Math.max(parseFloat(r.style.minHeight),parseFloat(r.style.height));if(a<s){let n=a+e,l=Math.min(s,n),o=n-l;r.style.height=l+"px","0px"===r.style.bottom&&(t.scrollTop=o>0?o:0,r.style.justifyContent="flex-end")}}}i.current=t.scrollTop})})})]})});aG.displayName=aK;var aJ="SelectGroup",[aX,aY]=ak(aJ);h.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e,a=eW();return(0,m.jsx)(aX,{scope:r,id:a,children:(0,m.jsx)(eK.div,{role:"group","aria-labelledby":a,...s,ref:t})})}).displayName=aJ;var aZ="SelectLabel";h.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e,a=aY(aZ,r);return(0,m.jsx)(eK.div,{id:a.id,...s,ref:t})}).displayName=aZ;var aQ="SelectItem",[a0,a1]=ak(aQ),a2=h.forwardRef((e,t)=>{let{__scopeSelect:r,value:s,disabled:a=!1,textValue:n,...l}=e,o=aT(aQ,r),i=aU(aQ,r),c=o.value===s,[d,u]=h.useState(n??""),[x,p]=h.useState(!1),f=b(t,e=>i.itemRefCallback?.(e,s,a)),g=eW(),v=h.useRef("touch"),y=()=>{a||(o.onValueChange(s),o.onOpenChange(!1))};if(""===s)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,m.jsx)(a0,{scope:r,value:s,disabled:a,textId:g,isSelected:c,onItemTextChange:h.useCallback(e=>{u(t=>t||(e?.textContent??"").trim())},[]),children:(0,m.jsx)(aj.ItemSlot,{scope:r,value:s,disabled:a,textValue:d,children:(0,m.jsx)(eK.div,{role:"option","aria-labelledby":g,"data-highlighted":x?"":void 0,"aria-selected":c&&x,"data-state":c?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...l,ref:f,onFocus:ez(l.onFocus,()=>p(!0)),onBlur:ez(l.onBlur,()=>p(!1)),onClick:ez(l.onClick,()=>{"mouse"!==v.current&&y()}),onPointerUp:ez(l.onPointerUp,()=>{"mouse"===v.current&&y()}),onPointerDown:ez(l.onPointerDown,e=>{v.current=e.pointerType}),onPointerMove:ez(l.onPointerMove,e=>{v.current=e.pointerType,a?i.onItemLeave?.():"mouse"===v.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ez(l.onPointerLeave,e=>{e.currentTarget===document.activeElement&&i.onItemLeave?.()}),onKeyDown:ez(l.onKeyDown,e=>{(i.searchRef?.current===""||" "!==e.key)&&(ab.includes(e.key)&&y()," "===e.key&&e.preventDefault())})})})})});a2.displayName=aQ;var a5="SelectItemText",a3=h.forwardRef((e,t)=>{let{__scopeSelect:r,className:s,style:a,...n}=e,l=aT(a5,r),o=aU(a5,r),i=a1(a5,r),c=aM(a5,r),[d,u]=h.useState(null),x=b(t,e=>u(e),i.onItemTextChange,e=>o.itemTextRefCallback?.(e,i.value,i.disabled)),p=d?.textContent,f=h.useMemo(()=>(0,m.jsx)("option",{value:i.value,disabled:i.disabled,children:p},i.value),[i.disabled,i.value,p]),{onNativeOptionAdd:g,onNativeOptionRemove:v}=c;return e_(()=>(g(f),()=>v(f)),[g,v,f]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(eK.span,{id:i.textId,...n,ref:x}),i.isSelected&&l.valueNode&&!l.valueNodeHasChildren?eH.createPortal(n.children,l.valueNode):null]})});a3.displayName=a5;var a8="SelectItemIndicator",a4=h.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e;return a1(a8,r).isSelected?(0,m.jsx)(eK.span,{"aria-hidden":!0,...s,ref:t}):null});a4.displayName=a8;var a6="SelectScrollUpButton",a9=h.forwardRef((e,t)=>{let r=aU(a6,e.__scopeSelect),s=aH(a6,e.__scopeSelect),[a,n]=h.useState(!1),l=b(t,s.onScrollButtonChange);return e_(()=>{if(r.viewport&&r.isPositioned){let e=function(){n(t.scrollTop>0)},t=r.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[r.viewport,r.isPositioned]),a?(0,m.jsx)(nt,{...e,ref:l,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=r;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null});a9.displayName=a6;var a7="SelectScrollDownButton",ne=h.forwardRef((e,t)=>{let r=aU(a7,e.__scopeSelect),s=aH(a7,e.__scopeSelect),[a,n]=h.useState(!1),l=b(t,s.onScrollButtonChange);return e_(()=>{if(r.viewport&&r.isPositioned){let e=function(){let e=t.scrollHeight-t.clientHeight;n(Math.ceil(t.scrollTop)<e)},t=r.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[r.viewport,r.isPositioned]),a?(0,m.jsx)(nt,{...e,ref:l,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=r;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null});ne.displayName=a7;var nt=h.forwardRef((e,t)=>{let{__scopeSelect:r,onAutoScroll:s,...a}=e,n=aU("SelectScrollButton",r),l=h.useRef(null),o=aw(r),i=h.useCallback(()=>{null!==l.current&&(window.clearInterval(l.current),l.current=null)},[]);return h.useEffect(()=>()=>i(),[i]),e_(()=>{let e=o().find(e=>e.ref.current===document.activeElement);e?.ref.current?.scrollIntoView({block:"nearest"})},[o]),(0,m.jsx)(eK.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ez(a.onPointerDown,()=>{null===l.current&&(l.current=window.setInterval(s,50))}),onPointerMove:ez(a.onPointerMove,()=>{n.onItemLeave?.(),null===l.current&&(l.current=window.setInterval(s,50))}),onPointerLeave:ez(a.onPointerLeave,()=>{i()})})});h.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e;return(0,m.jsx)(eK.div,{"aria-hidden":!0,...s,ref:t})}).displayName="SelectSeparator";var nr="SelectArrow";function ns(e){return""===e||void 0===e}h.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e,a=aS(r),n=aT(nr,r),l=aU(nr,r);return n.open&&"popper"===l.position?(0,m.jsx)(ax,{...a,...s,ref:t}):null}).displayName=nr;var na=h.forwardRef((e,t)=>{let{value:r,...s}=e,a=h.useRef(null),n=b(t,a),l=af(r);return h.useEffect(()=>{let e=a.current,t=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(l!==r&&t){let s=new Event("change",{bubbles:!0});t.call(e,r),e.dispatchEvent(s)}},[l,r]),(0,m.jsx)(ag,{asChild:!0,children:(0,m.jsx)("select",{...s,ref:n,defaultValue:r})})});function nn(e){let t=e$(e),r=h.useRef(""),s=h.useRef(0),a=h.useCallback(e=>{let a=r.current+e;t(a),function e(t){r.current=t,window.clearTimeout(s.current),""!==t&&(s.current=window.setTimeout(()=>e(""),1e3))}(a)},[t]),n=h.useCallback(()=>{r.current="",window.clearTimeout(s.current)},[]);return h.useEffect(()=>()=>window.clearTimeout(s.current),[]),[r,a,n]}function nl(e,t,r){var s,a;let n=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,l=r?e.indexOf(r):-1,o=(s=e,a=Math.max(l,0),s.map((e,t)=>s[(a+t)%s.length]));1===n.length&&(o=o.filter(e=>e!==r));let i=o.find(e=>e.textValue.toLowerCase().startsWith(n.toLowerCase()));return i!==r?i:void 0}na.displayName="BubbleSelect";let no=rw("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ni=rw("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),nc=rw("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function nd({...e}){return(0,m.jsx)(aD,{"data-slot":"select",...e})}function nu({...e}){return(0,m.jsx)(aL,{"data-slot":"select-value",...e})}function nx({className:e,size:t="default",children:r,...s}){return(0,m.jsxs)(aA,{"data-slot":"select-trigger","data-size":t,className:eA("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s,children:[r,(0,m.jsx)(aO,{asChild:!0,children:(0,m.jsx)(ni,{className:"size-4 opacity-50"})})]})}function nm({className:e,children:t,position:r="popper",...s}){return(0,m.jsx)(aq,{children:(0,m.jsxs)(aF,{"data-slot":"select-content",className:eA("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...s,children:[(0,m.jsx)(nh,{}),(0,m.jsx)(aG,{className:eA("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,m.jsx)(nf,{})]})})}function np({className:e,children:t,...r}){return(0,m.jsxs)(a2,{"data-slot":"select-item",className:eA("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...r,children:[(0,m.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,m.jsx)(a4,{children:(0,m.jsx)(no,{className:"size-4"})})}),(0,m.jsx)(a3,{children:t})]})}function nh({className:e,...t}){return(0,m.jsx)(a9,{"data-slot":"select-scroll-up-button",className:eA("flex cursor-default items-center justify-center py-1",e),...t,children:(0,m.jsx)(nc,{className:"size-4"})})}function nf({className:e,...t}){return(0,m.jsx)(ne,{"data-slot":"select-scroll-down-button",className:eA("flex cursor-default items-center justify-center py-1",e),...t,children:(0,m.jsx)(ni,{className:"size-4"})})}let ng=rw("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),nv=rw("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),nb=rw("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]),ny=rw("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),nj=rw("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),nw=rw("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),nN=rw("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),nk=rw("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),nC=rw("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),nS=rw("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var[nE,nT]=eF("Tooltip",[ae]),nR=ae(),nM="TooltipProvider",nD="tooltip.open",[nP,nA]=nE(nM),nI=e=>{let{__scopeTooltip:t,delayDuration:r=700,skipDelayDuration:s=300,disableHoverableContent:a=!1,children:n}=e,[l,o]=h.useState(!0),i=h.useRef(!1),c=h.useRef(0);return h.useEffect(()=>{let e=c.current;return()=>window.clearTimeout(e)},[]),(0,m.jsx)(nP,{scope:t,isOpenDelayed:l,delayDuration:r,onOpen:h.useCallback(()=>{window.clearTimeout(c.current),o(!1)},[]),onClose:h.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o(!0),s)},[s]),isPointerInTransitRef:i,onPointerInTransitChange:h.useCallback(e=>{i.current=e},[]),disableHoverableContent:a,children:n})};nI.displayName=nM;var nL="Tooltip",[nO,nq]=nE(nL),nz=e=>{let{__scopeTooltip:t,children:r,open:s,defaultOpen:a=!1,onOpenChange:n,disableHoverableContent:l,delayDuration:o}=e,i=nA(nL,e.__scopeTooltip),c=nR(t),[d,u]=h.useState(null),x=eW(),p=h.useRef(0),f=l??i.disableHoverableContent,g=o??i.delayDuration,v=h.useRef(!1),[b=!1,y]=eB({prop:s,defaultProp:a,onChange:e=>{e?(i.onOpen(),document.dispatchEvent(new CustomEvent(nD))):i.onClose(),n?.(e)}}),j=h.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),w=h.useCallback(()=>{window.clearTimeout(p.current),p.current=0,v.current=!1,y(!0)},[y]),N=h.useCallback(()=>{window.clearTimeout(p.current),p.current=0,y(!1)},[y]),k=h.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,y(!0),p.current=0},g)},[g,y]);return h.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),(0,m.jsx)(as,{...c,children:(0,m.jsx)(nO,{scope:t,contentId:x,open:b,stateAttribute:j,trigger:d,onTriggerChange:u,onTriggerEnter:h.useCallback(()=>{i.isOpenDelayed?k():w()},[i.isOpenDelayed,k,w]),onTriggerLeave:h.useCallback(()=>{f?N():(window.clearTimeout(p.current),p.current=0)},[N,f]),onOpen:w,onClose:N,disableHoverableContent:f,children:r})})};nz.displayName=nL;var nF="TooltipTrigger",n_=h.forwardRef((e,t)=>{let{__scopeTooltip:r,...s}=e,a=nq(nF,r),n=nA(nF,r),l=nR(r),o=b(t,h.useRef(null),a.onTriggerChange),i=h.useRef(!1),c=h.useRef(!1),d=h.useCallback(()=>i.current=!1,[]);return h.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),(0,m.jsx)(an,{asChild:!0,...l,children:(0,m.jsx)(eK.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...s,ref:o,onPointerMove:ez(e.onPointerMove,e=>{"touch"!==e.pointerType&&(c.current||n.isPointerInTransitRef.current||(a.onTriggerEnter(),c.current=!0))}),onPointerLeave:ez(e.onPointerLeave,()=>{a.onTriggerLeave(),c.current=!1}),onPointerDown:ez(e.onPointerDown,()=>{i.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ez(e.onFocus,()=>{i.current||a.onOpen()}),onBlur:ez(e.onBlur,a.onClose),onClick:ez(e.onClick,a.onClose)})})});n_.displayName=nF;var nU="TooltipPortal",[nV,nW]=nE(nU,{forceMount:void 0}),n$=e=>{let{__scopeTooltip:t,forceMount:r,children:s,container:a}=e,n=nq(nU,t);return(0,m.jsx)(nV,{scope:t,forceMount:r,children:(0,m.jsx)(te,{present:r||n.open,children:(0,m.jsx)(e7,{asChild:!0,container:a,children:s})})})};n$.displayName=nU;var nB="TooltipContent",nH=h.forwardRef((e,t)=>{let r=nW(nB,e.__scopeTooltip),{forceMount:s=r.forceMount,side:a="top",...n}=e,l=nq(nB,e.__scopeTooltip);return(0,m.jsx)(te,{present:s||l.open,children:l.disableHoverableContent?(0,m.jsx)(nX,{side:a,...n,ref:t}):(0,m.jsx)(nK,{side:a,...n,ref:t})})}),nK=h.forwardRef((e,t)=>{let r=nq(nB,e.__scopeTooltip),s=nA(nB,e.__scopeTooltip),a=h.useRef(null),n=b(t,a),[l,o]=h.useState(null),{trigger:i,onClose:c}=r,d=a.current,{onPointerInTransitChange:u}=s,x=h.useCallback(()=>{o(null),u(!1)},[u]),p=h.useCallback((e,t)=>{let r,s=e.currentTarget,a={x:e.clientX,y:e.clientY},n=function(e,t){let r=Math.abs(t.top-e.y),s=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),n=Math.abs(t.left-e.x);switch(Math.min(r,s,a,n)){case n:return"left";case a:return"right";case r:return"top";case s:return"bottom";default:throw Error("unreachable")}}(a,s.getBoundingClientRect());o(((r=[...function(e,t,r=5){let s=[];switch(t){case"top":s.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":s.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":s.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":s.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r})}return s}(a,n),...function(e){let{top:t,right:r,bottom:s,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:s},{x:a,y:s}]}(t.getBoundingClientRect())].slice()).sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:1*!!(e.y>t.y)),function(e){if(e.length<=1)return e.slice();let t=[];for(let r=0;r<e.length;r++){let s=e[r];for(;t.length>=2;){let e=t[t.length-1],r=t[t.length-2];if((e.x-r.x)*(s.y-r.y)>=(e.y-r.y)*(s.x-r.x))t.pop();else break}t.push(s)}t.pop();let r=[];for(let t=e.length-1;t>=0;t--){let s=e[t];for(;r.length>=2;){let e=r[r.length-1],t=r[r.length-2];if((e.x-t.x)*(s.y-t.y)>=(e.y-t.y)*(s.x-t.x))r.pop();else break}r.push(s)}return(r.pop(),1===t.length&&1===r.length&&t[0].x===r[0].x&&t[0].y===r[0].y)?t:t.concat(r)}(r))),u(!0)},[u]);return h.useEffect(()=>()=>x(),[x]),h.useEffect(()=>{if(i&&d){let e=e=>p(e,d),t=e=>p(e,i);return i.addEventListener("pointerleave",e),d.addEventListener("pointerleave",t),()=>{i.removeEventListener("pointerleave",e),d.removeEventListener("pointerleave",t)}}},[i,d,p,x]),h.useEffect(()=>{if(l){let e=e=>{let t=e.target,r={x:e.clientX,y:e.clientY},s=i?.contains(t)||d?.contains(t),a=!function(e,t){let{x:r,y:s}=e,a=!1;for(let e=0,n=t.length-1;e<t.length;n=e++){let l=t[e].x,o=t[e].y,i=t[n].x,c=t[n].y;o>s!=c>s&&r<(i-l)*(s-o)/(c-o)+l&&(a=!a)}return a}(r,l);s?x():a&&(x(),c())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[i,d,l,c,x]),(0,m.jsx)(nX,{...e,ref:n})}),[nG,nJ]=nE(nL,{isInside:!1}),nX=h.forwardRef((e,t)=>{let{__scopeTooltip:r,children:s,"aria-label":a,onEscapeKeyDown:n,onPointerDownOutside:l,...o}=e,i=nq(nB,r),c=nR(r),{onClose:d}=i;return h.useEffect(()=>(document.addEventListener(nD,d),()=>document.removeEventListener(nD,d)),[d]),h.useEffect(()=>{if(i.trigger){let e=e=>{let t=e.target;t?.contains(i.trigger)&&d()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[i.trigger,d]),(0,m.jsx)(eY,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:n,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:d,children:(0,m.jsxs)(ac,{"data-state":i.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[(0,m.jsx)(w,{children:s}),(0,m.jsx)(nG,{scope:r,isInside:!0,children:(0,m.jsx)(ag,{id:i.contentId,role:"tooltip",children:a||s})})]})})});nH.displayName=nB;var nY="TooltipArrow",nZ=h.forwardRef((e,t)=>{let{__scopeTooltip:r,...s}=e,a=nR(r);return nJ(nY,r).isInside?null:(0,m.jsx)(ax,{...a,...s,ref:t})});function nQ({delayDuration:e=0,...t}){return(0,m.jsx)(nI,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function n0({...e}){return(0,m.jsx)(nQ,{children:(0,m.jsx)(nz,{"data-slot":"tooltip",...e})})}function n1({...e}){return(0,m.jsx)(n_,{"data-slot":"tooltip-trigger",...e})}function n2({className:e,sideOffset:t=0,children:r,...s}){return(0,m.jsx)(n$,{children:(0,m.jsxs)(nH,{"data-slot":"tooltip-content",sideOffset:t,className:eA("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...s,children:[r,(0,m.jsx)(nZ,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}function n5({selectedWorkflowId:e,onWorkflowChange:t,onOpenAddStep:r}){let{workflows:s,addWorkflow:a,isRunnerActive:n,runWorkflow:l,requestStopRunner:o,addRun:i,getWorkflow:c,updateWorkflow:d,isPicking:u,setIsPicking:x,setPickedSelector:g,setOnPickComplete:v}=(0,f.useAutomation)(),{setSelectedProjectId:b}=(0,p.useProject)(),[y,j]=(0,h.useState)(!1),w=s.find(t=>t.id===e),N=w?.settings?.wsConnected??!1,k=w?.status==="paused"?"paused":"active",C=async()=>{j(!0);try{await new Promise(e=>setTimeout(e,800)),console.log("[v0] Refreshed workflow data")}finally{j(!1)}};return(0,m.jsx)(nQ,{children:(0,m.jsxs)("div",{className:"bg-card border-b border-border p-2.5 space-y-2",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsxs)(n0,{children:[(0,m.jsx)(n1,{asChild:!0,children:(0,m.jsx)(eL,{variant:"outline",size:"icon",className:"h-8 w-8 border-border bg-transparent shrink-0",onClick:()=>{b(null)},children:(0,m.jsx)(rA,{className:"h-3.5 w-3.5"})})}),(0,m.jsx)(n2,{children:(0,m.jsx)("p",{children:"Back to Projects"})})]}),(0,m.jsxs)(nd,{value:e,onValueChange:e=>{if("__new__"===e){let e;a({id:e="wf-"+Date.now(),name:"New Workflow",description:"New automation workflow",status:"paused",steps:[],triggers:[],runs:[],settings:(0,r_.createDefaultSettings)(),variables:{},runCount:0,createdAt:Date.now(),updatedAt:Date.now()}),t(e)}else t(e)},children:[(0,m.jsx)(nx,{className:"flex-1 h-8 text-xs bg-secondary border-border",children:(0,m.jsx)(nu,{placeholder:"Select workflow"})}),(0,m.jsxs)(nm,{children:[s.map(e=>(0,m.jsx)(np,{value:e.id,className:"text-xs",children:e.name},e.id)),(0,m.jsx)(np,{value:"__new__",className:"text-xs bg-green-500/20 text-green-500 hover:bg-green-500/30 hover:text-green-400 focus:bg-green-500/30 focus:text-green-400 font-medium mt-1",children:(0,m.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,m.jsx)(rI,{className:"h-3.5 w-3.5"}),(0,m.jsx)("span",{children:"New Workflow"})]})})]})]}),(0,m.jsxs)("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-secondary rounded-md text-xs",children:[(0,m.jsx)(nj,{className:"h-3 w-3 text-muted-foreground"}),(0,m.jsx)("span",{className:"text-foreground font-mono text-[10px]",children:w?.name||"No workflow"}),(0,m.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]}),(0,m.jsxs)(n0,{children:[(0,m.jsx)(n1,{asChild:!0,children:(0,m.jsx)(eL,{variant:"outline",size:"icon",className:"h-8 w-8 border-border bg-transparent",onClick:C,disabled:y,children:(0,m.jsx)(ny,{className:`h-3.5 w-3.5 ${y?"animate-spin":""}`})})}),(0,m.jsx)(n2,{children:(0,m.jsx)("p",{children:"Refresh"})})]})]}),(0,m.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,m.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[(0,m.jsxs)(n0,{children:[(0,m.jsx)(n1,{asChild:!0,children:(0,m.jsxs)(eL,{variant:"active"===k?"default":"outline",size:"sm",className:`h-7 px-2.5 gap-1.5 text-xs ${"active"===k?"":"bg-transparent"}`,onClick:()=>{if(!w)return;let e="paused"===w.status?"idle":"paused";d(w.id,{status:e})},children:[(0,m.jsx)(nS,{className:"h-3 w-3"}),"active"===k?"ON":"OFF"]})}),(0,m.jsx)(n2,{children:(0,m.jsx)("p",{children:"Toggle triggers for this workflow"})})]}),(0,m.jsxs)(n0,{children:[(0,m.jsx)(n1,{asChild:!0,children:(0,m.jsxs)(eL,{size:"sm",className:"h-7 px-2.5 gap-1.5 text-xs bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>{(w?.settings?.allowedSites?.length||0)>0?l(e):alert("Configure Allowed Sites antes de rodar o workflow.")},disabled:n,children:[n?(0,m.jsx)(nk,{className:"h-3 w-3 animate-spin"}):(0,m.jsx)(ng,{className:"h-3 w-3"}),"Run"]})}),(0,m.jsx)(n2,{children:(0,m.jsx)("p",{children:"Execute workflow on current tab"})})]}),(0,m.jsxs)(n0,{children:[(0,m.jsx)(n1,{asChild:!0,children:(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"h-7 px-2.5 gap-1.5 text-xs border-border bg-transparent",onClick:()=>{o()},disabled:!n,children:[(0,m.jsx)(nv,{className:"h-3 w-3"}),"Stop"]})}),(0,m.jsx)(n2,{children:(0,m.jsx)("p",{children:"Cancel running execution"})})]}),(0,m.jsxs)(n0,{children:[(0,m.jsx)(n1,{asChild:!0,children:(0,m.jsxs)(eL,{variant:u?"default":"outline",size:"sm",className:`h-7 px-2.5 gap-1.5 text-xs border-border ${u?"":"bg-transparent"}`,onClick:()=>{if(u){x(!1),g(null),v(null);return}g(null),v(()=>e=>{r&&r(e)}),x(!0)},children:[u?(0,m.jsx)(nk,{className:"h-3 w-3 animate-spin"}):(0,m.jsx)(nb,{className:"h-3 w-3"}),u?"Picking...":"Pick"]})}),(0,m.jsx)(n2,{children:(0,m.jsx)("p",{children:u?"Click on element to select":"Select element on page"})})]})]}),(0,m.jsxs)("div",{className:"flex items-center gap-1.5 flex-wrap pl-0.5",children:[u&&(0,m.jsxs)("div",{className:"flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-500/15 text-blue-500 animate-pulse",children:[(0,m.jsx)(nb,{className:"h-2.5 w-2.5"}),(0,m.jsx)("span",{children:"Picking"})]}),(0,m.jsx)(n3,{label:"Runner",status:n?"active":"idle",activeLabel:"Running",idleLabel:"Idle"}),(0,m.jsx)(n3,{label:"Workflow",status:"active"===k?"active":"idle",activeLabel:"Active",idleLabel:"Paused",icon:(0,m.jsx)(nS,{className:"h-2.5 w-2.5"})}),(0,m.jsx)(n3,{label:"WS",status:N?"connected":"disconnected",activeLabel:"OK",idleLabel:"Off",icon:(0,m.jsx)(nC,{className:"h-2.5 w-2.5"})})]})]})]})})}function n3({label:e,status:t,activeLabel:r,idleLabel:s,icon:a}){let n="active"===t||"connected"===t;return(0,m.jsxs)("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium ${n?"bg-green-500/15 text-green-500":"bg-muted text-muted-foreground"}`,children:[a||(n?(0,m.jsx)(nw,{className:"h-2.5 w-2.5"}):(0,m.jsx)(nN,{className:"h-2.5 w-2.5"})),(0,m.jsx)("span",{children:n?r:s})]})}nZ.displayName=nY;var n8=h.forwardRef((e,t)=>(0,m.jsx)(eK.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));function n4({className:e,...t}){return(0,m.jsx)(n8,{"data-slot":"label",className:eA("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}n8.displayName="Label";var n6="Switch",[n9,n7]=eF(n6),[le,lt]=n9(n6),lr=h.forwardRef((e,t)=>{let{__scopeSwitch:r,name:s,checked:a,defaultChecked:n,required:l,disabled:o,value:i="on",onCheckedChange:c,form:d,...u}=e,[x,p]=h.useState(null),f=b(t,e=>p(e)),g=h.useRef(!1),v=!x||d||!!x.closest("form"),[y=!1,j]=eB({prop:a,defaultProp:n,onChange:c});return(0,m.jsxs)(le,{scope:r,checked:y,disabled:o,children:[(0,m.jsx)(eK.button,{type:"button",role:"switch","aria-checked":y,"aria-required":l,"data-state":ll(y),"data-disabled":o?"":void 0,disabled:o,value:i,...u,ref:f,onClick:ez(e.onClick,e=>{j(e=>!e),v&&(g.current=e.isPropagationStopped(),g.current||e.stopPropagation())})}),v&&(0,m.jsx)(ln,{control:x,bubbles:!g.current,name:s,value:i,checked:y,required:l,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});lr.displayName=n6;var ls="SwitchThumb",la=h.forwardRef((e,t)=>{let{__scopeSwitch:r,...s}=e,a=lt(ls,r);return(0,m.jsx)(eK.span,{"data-state":ll(a.checked),"data-disabled":a.disabled?"":void 0,...s,ref:t})});la.displayName=ls;var ln=e=>{let{control:t,checked:r,bubbles:s=!0,...a}=e,n=h.useRef(null),l=af(r),o=s6(t);return h.useEffect(()=>{let e=n.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(l!==r&&t){let a=new Event("click",{bubbles:s});t.call(e,r),e.dispatchEvent(a)}},[l,r,s]),(0,m.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:n,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function ll(e){return e?"checked":"unchecked"}function lo({className:e,...t}){return(0,m.jsx)(lr,{"data-slot":"switch",className:eA("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,m.jsx)(la,{"data-slot":"switch-thumb",className:"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"})})}let li=S("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function lc({className:e,variant:t,asChild:r=!1,...s}){let a=r?y:"span";return(0,m.jsx)(a,{"data-slot":"badge",className:eA(li({variant:t}),e),...s})}var ld="ScrollArea",[lu,lx]=eF(ld),[lm,lp]=lu(ld),lh=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,type:s="hover",dir:a,scrollHideDelay:n=600,...l}=e,[o,i]=h.useState(null),[c,d]=h.useState(null),[u,x]=h.useState(null),[p,f]=h.useState(null),[g,v]=h.useState(null),[y,j]=h.useState(0),[w,N]=h.useState(0),[k,C]=h.useState(!1),[S,E]=h.useState(!1),T=b(t,e=>i(e)),R=rH(a);return(0,m.jsx)(lm,{scope:r,type:s,dir:R,scrollHideDelay:n,scrollArea:o,viewport:c,onViewportChange:d,content:u,onContentChange:x,scrollbarX:p,onScrollbarXChange:f,scrollbarXEnabled:k,onScrollbarXEnabledChange:C,scrollbarY:g,onScrollbarYChange:v,scrollbarYEnabled:S,onScrollbarYEnabledChange:E,onCornerWidthChange:j,onCornerHeightChange:N,children:(0,m.jsx)(eK.div,{dir:R,...l,ref:T,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":w+"px",...e.style}})})});lh.displayName=ld;var lf="ScrollAreaViewport",lg=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,children:s,nonce:a,...n}=e,l=lp(lf,r),o=b(t,h.useRef(null),l.onViewportChange);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),(0,m.jsx)(eK.div,{"data-radix-scroll-area-viewport":"",...n,ref:o,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,m.jsx)("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});lg.displayName=lf;var lv="ScrollAreaScrollbar",lb=h.forwardRef((e,t)=>{let{forceMount:r,...s}=e,a=lp(lv,e.__scopeScrollArea),{onScrollbarXEnabledChange:n,onScrollbarYEnabledChange:l}=a,o="horizontal"===e.orientation;return h.useEffect(()=>(o?n(!0):l(!0),()=>{o?n(!1):l(!1)}),[o,n,l]),"hover"===a.type?(0,m.jsx)(ly,{...s,ref:t,forceMount:r}):"scroll"===a.type?(0,m.jsx)(lj,{...s,ref:t,forceMount:r}):"auto"===a.type?(0,m.jsx)(lw,{...s,ref:t,forceMount:r}):"always"===a.type?(0,m.jsx)(lN,{...s,ref:t}):null});lb.displayName=lv;var ly=h.forwardRef((e,t)=>{let{forceMount:r,...s}=e,a=lp(lv,e.__scopeScrollArea),[n,l]=h.useState(!1);return h.useEffect(()=>{let e=a.scrollArea,t=0;if(e){let r=()=>{window.clearTimeout(t),l(!0)},s=()=>{t=window.setTimeout(()=>l(!1),a.scrollHideDelay)};return e.addEventListener("pointerenter",r),e.addEventListener("pointerleave",s),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",r),e.removeEventListener("pointerleave",s)}}},[a.scrollArea,a.scrollHideDelay]),(0,m.jsx)(te,{present:r||n,children:(0,m.jsx)(lw,{"data-state":n?"visible":"hidden",...s,ref:t})})}),lj=h.forwardRef((e,t)=>{var r;let{forceMount:s,...a}=e,n=lp(lv,e.__scopeScrollArea),l="horizontal"===e.orientation,o=lU(()=>c("SCROLL_END"),100),[i,c]=(r={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},h.useReducer((e,t)=>r[e][t]??e,"hidden"));return h.useEffect(()=>{if("idle"===i){let e=window.setTimeout(()=>c("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(e)}},[i,n.scrollHideDelay,c]),h.useEffect(()=>{let e=n.viewport,t=l?"scrollLeft":"scrollTop";if(e){let r=e[t],s=()=>{let s=e[t];r!==s&&(c("SCROLL"),o()),r=s};return e.addEventListener("scroll",s),()=>e.removeEventListener("scroll",s)}},[n.viewport,l,c,o]),(0,m.jsx)(te,{present:s||"hidden"!==i,children:(0,m.jsx)(lN,{"data-state":"hidden"===i?"hidden":"visible",...a,ref:t,onPointerEnter:ez(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:ez(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),lw=h.forwardRef((e,t)=>{let r=lp(lv,e.__scopeScrollArea),{forceMount:s,...a}=e,[n,l]=h.useState(!1),o="horizontal"===e.orientation,i=lU(()=>{if(r.viewport){let e=r.viewport.offsetWidth<r.viewport.scrollWidth,t=r.viewport.offsetHeight<r.viewport.scrollHeight;l(o?e:t)}},10);return lV(r.viewport,i),lV(r.content,i),(0,m.jsx)(te,{present:s||n,children:(0,m.jsx)(lN,{"data-state":n?"visible":"hidden",...a,ref:t})})}),lN=h.forwardRef((e,t)=>{let{orientation:r="vertical",...s}=e,a=lp(lv,e.__scopeScrollArea),n=h.useRef(null),l=h.useRef(0),[o,i]=h.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=lO(o.viewport,o.content),d={...s,sizes:o,onSizesChange:i,hasThumb:!!(c>0&&c<1),onThumbChange:e=>n.current=e,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:e=>l.current=e};function u(e,t){return function(e,t,r,s="ltr"){let a=lq(r),n=t||a/2,l=r.scrollbar.paddingStart+n,o=r.scrollbar.size-r.scrollbar.paddingEnd-(a-n),i=r.content-r.viewport;return lF([l,o],"ltr"===s?[0,i]:[-1*i,0])(e)}(e,l.current,o,t)}return"horizontal"===r?(0,m.jsx)(lk,{...d,ref:t,onThumbPositionChange:()=>{if(a.viewport&&n.current){let e=lz(a.viewport.scrollLeft,o,a.dir);n.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{a.viewport&&(a.viewport.scrollLeft=e)},onDragScroll:e=>{a.viewport&&(a.viewport.scrollLeft=u(e,a.dir))}}):"vertical"===r?(0,m.jsx)(lC,{...d,ref:t,onThumbPositionChange:()=>{if(a.viewport&&n.current){let e=lz(a.viewport.scrollTop,o);n.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{a.viewport&&(a.viewport.scrollTop=e)},onDragScroll:e=>{a.viewport&&(a.viewport.scrollTop=u(e))}}):null}),lk=h.forwardRef((e,t)=>{let{sizes:r,onSizesChange:s,...a}=e,n=lp(lv,e.__scopeScrollArea),[l,o]=h.useState(),i=h.useRef(null),c=b(t,i,n.onScrollbarXChange);return h.useEffect(()=>{i.current&&o(getComputedStyle(i.current))},[i]),(0,m.jsx)(lT,{"data-orientation":"horizontal",...a,ref:c,sizes:r,style:{bottom:0,left:"rtl"===n.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===n.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":lq(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,r)=>{if(n.viewport){var s,a;let l=n.viewport.scrollLeft+t.deltaX;e.onWheelScroll(l),s=l,a=r,s>0&&s<a&&t.preventDefault()}},onResize:()=>{i.current&&n.viewport&&l&&s({content:n.viewport.scrollWidth,viewport:n.viewport.offsetWidth,scrollbar:{size:i.current.clientWidth,paddingStart:lL(l.paddingLeft),paddingEnd:lL(l.paddingRight)}})}})}),lC=h.forwardRef((e,t)=>{let{sizes:r,onSizesChange:s,...a}=e,n=lp(lv,e.__scopeScrollArea),[l,o]=h.useState(),i=h.useRef(null),c=b(t,i,n.onScrollbarYChange);return h.useEffect(()=>{i.current&&o(getComputedStyle(i.current))},[i]),(0,m.jsx)(lT,{"data-orientation":"vertical",...a,ref:c,sizes:r,style:{top:0,right:"ltr"===n.dir?0:void 0,left:"rtl"===n.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":lq(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,r)=>{if(n.viewport){var s,a;let l=n.viewport.scrollTop+t.deltaY;e.onWheelScroll(l),s=l,a=r,s>0&&s<a&&t.preventDefault()}},onResize:()=>{i.current&&n.viewport&&l&&s({content:n.viewport.scrollHeight,viewport:n.viewport.offsetHeight,scrollbar:{size:i.current.clientHeight,paddingStart:lL(l.paddingTop),paddingEnd:lL(l.paddingBottom)}})}})}),[lS,lE]=lu(lv),lT=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,sizes:s,hasThumb:a,onThumbChange:n,onThumbPointerUp:l,onThumbPointerDown:o,onThumbPositionChange:i,onDragScroll:c,onWheelScroll:d,onResize:u,...x}=e,p=lp(lv,r),[f,g]=h.useState(null),v=b(t,e=>g(e)),y=h.useRef(null),j=h.useRef(""),w=p.viewport,N=s.content-s.viewport,k=e$(d),C=e$(i),S=lU(u,10);function E(e){y.current&&c({x:e.clientX-y.current.left,y:e.clientY-y.current.top})}return h.useEffect(()=>{let e=e=>{let t=e.target;f?.contains(t)&&k(e,N)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[w,f,N,k]),h.useEffect(C,[s,C]),lV(f,S),lV(p.content,S),(0,m.jsx)(lS,{scope:r,scrollbar:f,hasThumb:a,onThumbChange:e$(n),onThumbPointerUp:e$(l),onThumbPositionChange:C,onThumbPointerDown:e$(o),children:(0,m.jsx)(eK.div,{...x,ref:v,style:{position:"absolute",...x.style},onPointerDown:ez(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),y.current=f.getBoundingClientRect(),j.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),E(e))}),onPointerMove:ez(e.onPointerMove,E),onPointerUp:ez(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=j.current,p.viewport&&(p.viewport.style.scrollBehavior=""),y.current=null})})})}),lR="ScrollAreaThumb",lM=h.forwardRef((e,t)=>{let{forceMount:r,...s}=e,a=lE(lR,e.__scopeScrollArea);return(0,m.jsx)(te,{present:r||a.hasThumb,children:(0,m.jsx)(lD,{ref:t,...s})})}),lD=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,style:s,...a}=e,n=lp(lR,r),l=lE(lR,r),{onThumbPositionChange:o}=l,i=b(t,e=>l.onThumbChange(e)),c=h.useRef(void 0),d=lU(()=>{c.current&&(c.current(),c.current=void 0)},100);return h.useEffect(()=>{let e=n.viewport;if(e){let t=()=>{d(),c.current||(c.current=l_(e,o),o())};return o(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[n.viewport,d,o]),(0,m.jsx)(eK.div,{"data-state":l.hasThumb?"visible":"hidden",...a,ref:i,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:ez(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),r=e.clientX-t.left,s=e.clientY-t.top;l.onThumbPointerDown({x:r,y:s})}),onPointerUp:ez(e.onPointerUp,l.onThumbPointerUp)})});lM.displayName=lR;var lP="ScrollAreaCorner",lA=h.forwardRef((e,t)=>{let r=lp(lP,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&s?(0,m.jsx)(lI,{...e,ref:t}):null});lA.displayName=lP;var lI=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,...s}=e,a=lp(lP,r),[n,l]=h.useState(0),[o,i]=h.useState(0),c=!!(n&&o);return lV(a.scrollbarX,()=>{let e=a.scrollbarX?.offsetHeight||0;a.onCornerHeightChange(e),i(e)}),lV(a.scrollbarY,()=>{let e=a.scrollbarY?.offsetWidth||0;a.onCornerWidthChange(e),l(e)}),c?(0,m.jsx)(eK.div,{...s,ref:t,style:{width:n,height:o,position:"absolute",right:"ltr"===a.dir?0:void 0,left:"rtl"===a.dir?0:void 0,bottom:0,...e.style}}):null});function lL(e){return e?parseInt(e,10):0}function lO(e,t){let r=e/t;return isNaN(r)?0:r}function lq(e){let t=lO(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-r)*t,18)}function lz(e,t,r="ltr"){let s=lq(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=t.scrollbar.size-a,l=t.content-t.viewport,o=rW(e,"ltr"===r?[0,l]:[-1*l,0]);return lF([0,l],[0,n-s])(o)}function lF(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}var l_=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return!function a(){let n={left:e.scrollLeft,top:e.scrollTop},l=r.left!==n.left,o=r.top!==n.top;(l||o)&&t(),r=n,s=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(s)};function lU(e,t){let r=e$(e),s=h.useRef(0);return h.useEffect(()=>()=>window.clearTimeout(s.current),[]),h.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function lV(e,t){let r=e$(t);e_(()=>{let t=0;if(e){let s=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(r)});return s.observe(e),()=>{window.cancelAnimationFrame(t),s.unobserve(e)}}},[e,r])}function lW({className:e,children:t,...r}){return(0,m.jsxs)(lh,{"data-slot":"scroll-area",className:eA("relative",e),...r,children:[(0,m.jsx)(lg,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,m.jsx)(l$,{}),(0,m.jsx)(lA,{})]})}function l$({className:e,orientation:t="vertical",...r}){return(0,m.jsx)(lb,{"data-slot":"scroll-area-scrollbar",orientation:t,className:eA("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",e),...r,children:(0,m.jsx)(lM,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var lB="rovingFocusGroup.onEntryFocus",lH={bubbles:!1,cancelable:!0},lK="RovingFocusGroup",[lG,lJ,lX]=r$(lK),[lY,lZ]=eF(lK,[lX]),[lQ,l0]=lY(lK),l1=h.forwardRef((e,t)=>(0,m.jsx)(lG.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,m.jsx)(lG.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,m.jsx)(l2,{...e,ref:t})})}));l1.displayName=lK;var l2=h.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:r,orientation:s,loop:a=!1,dir:n,currentTabStopId:l,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:i,onEntryFocus:c,preventScrollOnEntryFocus:d=!1,...u}=e,x=h.useRef(null),p=b(t,x),f=rH(n),[g=null,v]=eB({prop:l,defaultProp:o,onChange:i}),[y,j]=h.useState(!1),w=e$(c),N=lJ(r),k=h.useRef(!1),[C,S]=h.useState(0);return h.useEffect(()=>{let e=x.current;if(e)return e.addEventListener(lB,w),()=>e.removeEventListener(lB,w)},[w]),(0,m.jsx)(lQ,{scope:r,orientation:s,dir:f,loop:a,currentTabStopId:g,onItemFocus:h.useCallback(e=>v(e),[v]),onItemShiftTab:h.useCallback(()=>j(!0),[]),onFocusableItemAdd:h.useCallback(()=>S(e=>e+1),[]),onFocusableItemRemove:h.useCallback(()=>S(e=>e-1),[]),children:(0,m.jsx)(eK.div,{tabIndex:y||0===C?-1:0,"data-orientation":s,...u,ref:p,style:{outline:"none",...e.style},onMouseDown:ez(e.onMouseDown,()=>{k.current=!0}),onFocus:ez(e.onFocus,e=>{let t=!k.current;if(e.target===e.currentTarget&&t&&!y){let t=new CustomEvent(lB,lH);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=N().filter(e=>e.focusable);l4([e.find(e=>e.active),e.find(e=>e.id===g),...e].filter(Boolean).map(e=>e.ref.current),d)}}k.current=!1}),onBlur:ez(e.onBlur,()=>j(!1))})})}),l5="RovingFocusGroupItem",l3=h.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:r,focusable:s=!0,active:a=!1,tabStopId:n,...l}=e,o=eW(),i=n||o,c=l0(l5,r),d=c.currentTabStopId===i,u=lJ(r),{onFocusableItemAdd:x,onFocusableItemRemove:p}=c;return h.useEffect(()=>{if(s)return x(),()=>p()},[s,x,p]),(0,m.jsx)(lG.ItemSlot,{scope:r,id:i,focusable:s,active:a,children:(0,m.jsx)(eK.span,{tabIndex:d?0:-1,"data-orientation":c.orientation,...l,ref:t,onMouseDown:ez(e.onMouseDown,e=>{s?c.onItemFocus(i):e.preventDefault()}),onFocus:ez(e.onFocus,()=>c.onItemFocus(i)),onKeyDown:ez(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void c.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,r){var s;let a=(s=e.key,"rtl"!==r?s:"ArrowLeft"===s?"ArrowRight":"ArrowRight"===s?"ArrowLeft":s);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(a))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(a)))return l8[a]}(e,c.orientation,c.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let a=u().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)a.reverse();else if("prev"===t||"next"===t){var r,s;"prev"===t&&a.reverse();let n=a.indexOf(e.currentTarget);a=c.loop?(r=a,s=n+1,r.map((e,t)=>r[(s+t)%r.length])):a.slice(n+1)}setTimeout(()=>l4(a))}})})})});l3.displayName=l5;var l8={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function l4(e,t=!1){let r=document.activeElement;for(let s of e)if(s===r||(s.focus({preventScroll:t}),document.activeElement!==r))return}var l6=["Enter"," "],l9=["ArrowUp","PageDown","End"],l7=["ArrowDown","PageUp","Home",...l9],oe={ltr:[...l6,"ArrowRight"],rtl:[...l6,"ArrowLeft"]},ot={ltr:["ArrowLeft"],rtl:["ArrowRight"]},or="Menu",[os,oa,on]=r$(or),[ol,oo]=eF(or,[on,ae,lZ]),oi=ae(),oc=lZ(),[od,ou]=ol(or),[ox,om]=ol(or),op=e=>{let{__scopeMenu:t,open:r=!1,children:s,dir:a,onOpenChange:n,modal:l=!0}=e,o=oi(t),[i,c]=h.useState(null),d=h.useRef(!1),u=e$(n),x=rH(a);return h.useEffect(()=>{let e=()=>{d.current=!0,document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})},t=()=>d.current=!1;return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0})}},[]),(0,m.jsx)(as,{...o,children:(0,m.jsx)(od,{scope:t,open:r,onOpenChange:u,content:i,onContentChange:c,children:(0,m.jsx)(ox,{scope:t,onClose:h.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:d,dir:x,modal:l,children:s})})})};op.displayName=or;var oh=h.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e,a=oi(r);return(0,m.jsx)(an,{...a,...s,ref:t})});oh.displayName="MenuAnchor";var of="MenuPortal",[og,ov]=ol(of,{forceMount:void 0}),ob=e=>{let{__scopeMenu:t,forceMount:r,children:s,container:a}=e,n=ou(of,t);return(0,m.jsx)(og,{scope:t,forceMount:r,children:(0,m.jsx)(te,{present:r||n.open,children:(0,m.jsx)(e7,{asChild:!0,container:a,children:s})})})};ob.displayName=of;var oy="MenuContent",[oj,ow]=ol(oy),oN=h.forwardRef((e,t)=>{let r=ov(oy,e.__scopeMenu),{forceMount:s=r.forceMount,...a}=e,n=ou(oy,e.__scopeMenu),l=om(oy,e.__scopeMenu);return(0,m.jsx)(os.Provider,{scope:e.__scopeMenu,children:(0,m.jsx)(te,{present:s||n.open,children:(0,m.jsx)(os.Slot,{scope:e.__scopeMenu,children:l.modal?(0,m.jsx)(ok,{...a,ref:t}):(0,m.jsx)(oC,{...a,ref:t})})})})}),ok=h.forwardRef((e,t)=>{let r=ou(oy,e.__scopeMenu),s=h.useRef(null),a=b(t,s);return h.useEffect(()=>{let e=s.current;if(e)return tX(e)},[]),(0,m.jsx)(oS,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:ez(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),oC=h.forwardRef((e,t)=>{let r=ou(oy,e.__scopeMenu);return(0,m.jsx)(oS,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),oS=h.forwardRef((e,t)=>{let{__scopeMenu:r,loop:s=!1,trapFocus:a,onOpenAutoFocus:n,onCloseAutoFocus:l,disableOutsidePointerEvents:o,onEntryFocus:i,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:x,onDismiss:p,disableOutsideScroll:f,...g}=e,v=ou(oy,r),j=om(oy,r),w=oi(r),N=oc(r),k=oa(r),[C,S]=h.useState(null),E=h.useRef(null),T=b(t,E,v.onContentChange),R=h.useRef(0),M=h.useRef(""),D=h.useRef(0),P=h.useRef(null),A=h.useRef("right"),I=h.useRef(0),L=f?tW:h.Fragment,O=f?{as:y,allowPinchZoom:!0}:void 0;h.useEffect(()=>()=>window.clearTimeout(R.current),[]),ts();let q=h.useCallback(e=>{var t,r;return A.current===P.current?.side&&(t=e,!!(r=P.current?.area)&&function(e,t){let{x:r,y:s}=e,a=!1;for(let e=0,n=t.length-1;e<t.length;n=e++){let l=t[e].x,o=t[e].y,i=t[n].x,c=t[n].y;o>s!=c>s&&r<(i-l)*(s-o)/(c-o)+l&&(a=!a)}return a}({x:t.clientX,y:t.clientY},r))},[]);return(0,m.jsx)(oj,{scope:r,searchRef:M,onItemEnter:h.useCallback(e=>{q(e)&&e.preventDefault()},[q]),onItemLeave:h.useCallback(e=>{q(e)||(E.current?.focus(),S(null))},[q]),onTriggerLeave:h.useCallback(e=>{q(e)&&e.preventDefault()},[q]),pointerGraceTimerRef:D,onPointerGraceIntentChange:h.useCallback(e=>{P.current=e},[]),children:(0,m.jsx)(L,{...O,children:(0,m.jsx)(e5,{asChild:!0,trapped:a,onMountAutoFocus:ez(n,e=>{e.preventDefault(),E.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:(0,m.jsx)(eY,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:x,onDismiss:p,children:(0,m.jsx)(l1,{asChild:!0,...N,dir:j.dir,orientation:"vertical",loop:s,currentTabStopId:C,onCurrentTabStopIdChange:S,onEntryFocus:ez(i,e=>{j.isUsingKeyboardRef.current||e.preventDefault()}),preventScrollOnEntryFocus:!0,children:(0,m.jsx)(ac,{role:"menu","aria-orientation":"vertical","data-state":oZ(v.open),"data-radix-menu-content":"",dir:j.dir,...w,...g,ref:T,style:{outline:"none",...g.style},onKeyDown:ez(g.onKeyDown,e=>{let t=e.target.closest("[data-radix-menu-content]")===e.currentTarget,r=e.ctrlKey||e.altKey||e.metaKey,s=1===e.key.length;if(t){var a;let t,n,l,o,i,c;"Tab"===e.key&&e.preventDefault(),!r&&s&&(a=e.key,t=M.current+a,n=k().filter(e=>!e.disabled),l=document.activeElement,o=n.find(e=>e.ref.current===l)?.textValue,i=function(e,t,r){var s;let a=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,n=r?e.indexOf(r):-1,l=(s=Math.max(n,0),e.map((t,r)=>e[(s+r)%e.length]));1===a.length&&(l=l.filter(e=>e!==r));let o=l.find(e=>e.toLowerCase().startsWith(a.toLowerCase()));return o!==r?o:void 0}(n.map(e=>e.textValue),t,o),c=n.find(e=>e.textValue===i)?.ref.current,function e(t){M.current=t,window.clearTimeout(R.current),""!==t&&(R.current=window.setTimeout(()=>e(""),1e3))}(t),c&&setTimeout(()=>c.focus()))}let n=E.current;if(e.target!==n||!l7.includes(e.key))return;e.preventDefault();let l=k().filter(e=>!e.disabled).map(e=>e.ref.current);l9.includes(e.key)&&l.reverse(),function(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}(l)}),onBlur:ez(e.onBlur,e=>{e.currentTarget.contains(e.target)||(window.clearTimeout(R.current),M.current="")}),onPointerMove:ez(e.onPointerMove,o1(e=>{let t=e.target,r=I.current!==e.clientX;e.currentTarget.contains(t)&&r&&(A.current=e.clientX>I.current?"right":"left",I.current=e.clientX)}))})})})})})})});oN.displayName=oy;var oE=h.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e;return(0,m.jsx)(eK.div,{role:"group",...s,ref:t})});oE.displayName="MenuGroup";var oT=h.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e;return(0,m.jsx)(eK.div,{...s,ref:t})});oT.displayName="MenuLabel";var oR="MenuItem",oM="menu.itemSelect",oD=h.forwardRef((e,t)=>{let{disabled:r=!1,onSelect:s,...a}=e,n=h.useRef(null),l=om(oR,e.__scopeMenu),o=ow(oR,e.__scopeMenu),i=b(t,n),c=h.useRef(!1);return(0,m.jsx)(oP,{...a,ref:i,disabled:r,onClick:ez(e.onClick,()=>{let e=n.current;if(!r&&e){let t=new CustomEvent(oM,{bubbles:!0,cancelable:!0});e.addEventListener(oM,e=>s?.(e),{once:!0}),eG(e,t),t.defaultPrevented?c.current=!1:l.onClose()}}),onPointerDown:t=>{e.onPointerDown?.(t),c.current=!0},onPointerUp:ez(e.onPointerUp,e=>{c.current||e.currentTarget?.click()}),onKeyDown:ez(e.onKeyDown,e=>{let t=""!==o.searchRef.current;r||t&&" "===e.key||l6.includes(e.key)&&(e.currentTarget.click(),e.preventDefault())})})});oD.displayName=oR;var oP=h.forwardRef((e,t)=>{let{__scopeMenu:r,disabled:s=!1,textValue:a,...n}=e,l=ow(oR,r),o=oc(r),i=h.useRef(null),c=b(t,i),[d,u]=h.useState(!1),[x,p]=h.useState("");return h.useEffect(()=>{let e=i.current;e&&p((e.textContent??"").trim())},[n.children]),(0,m.jsx)(os.ItemSlot,{scope:r,disabled:s,textValue:a??x,children:(0,m.jsx)(l3,{asChild:!0,...o,focusable:!s,children:(0,m.jsx)(eK.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...n,ref:c,onPointerMove:ez(e.onPointerMove,o1(e=>{s?l.onItemLeave(e):(l.onItemEnter(e),e.defaultPrevented||e.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ez(e.onPointerLeave,o1(e=>l.onItemLeave(e))),onFocus:ez(e.onFocus,()=>u(!0)),onBlur:ez(e.onBlur,()=>u(!1))})})})}),oA=h.forwardRef((e,t)=>{let{checked:r=!1,onCheckedChange:s,...a}=e;return(0,m.jsx)(oU,{scope:e.__scopeMenu,checked:r,children:(0,m.jsx)(oD,{role:"menuitemcheckbox","aria-checked":oQ(r)?"mixed":r,...a,ref:t,"data-state":o0(r),onSelect:ez(a.onSelect,()=>s?.(!!oQ(r)||!r),{checkForDefaultPrevented:!1})})})});oA.displayName="MenuCheckboxItem";var oI="MenuRadioGroup",[oL,oO]=ol(oI,{value:void 0,onValueChange:()=>{}}),oq=h.forwardRef((e,t)=>{let{value:r,onValueChange:s,...a}=e,n=e$(s);return(0,m.jsx)(oL,{scope:e.__scopeMenu,value:r,onValueChange:n,children:(0,m.jsx)(oE,{...a,ref:t})})});oq.displayName=oI;var oz="MenuRadioItem",oF=h.forwardRef((e,t)=>{let{value:r,...s}=e,a=oO(oz,e.__scopeMenu),n=r===a.value;return(0,m.jsx)(oU,{scope:e.__scopeMenu,checked:n,children:(0,m.jsx)(oD,{role:"menuitemradio","aria-checked":n,...s,ref:t,"data-state":o0(n),onSelect:ez(s.onSelect,()=>a.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});oF.displayName=oz;var o_="MenuItemIndicator",[oU,oV]=ol(o_,{checked:!1}),oW=h.forwardRef((e,t)=>{let{__scopeMenu:r,forceMount:s,...a}=e,n=oV(o_,r);return(0,m.jsx)(te,{present:s||oQ(n.checked)||!0===n.checked,children:(0,m.jsx)(eK.span,{...a,ref:t,"data-state":o0(n.checked)})})});oW.displayName=o_;var o$=h.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e;return(0,m.jsx)(eK.div,{role:"separator","aria-orientation":"horizontal",...s,ref:t})});o$.displayName="MenuSeparator";var oB=h.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e,a=oi(r);return(0,m.jsx)(ax,{...a,...s,ref:t})});oB.displayName="MenuArrow";var[oH,oK]=ol("MenuSub"),oG="MenuSubTrigger",oJ=h.forwardRef((e,t)=>{let r=ou(oG,e.__scopeMenu),s=om(oG,e.__scopeMenu),a=oK(oG,e.__scopeMenu),n=ow(oG,e.__scopeMenu),l=h.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:i}=n,c={__scopeMenu:e.__scopeMenu},d=h.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return h.useEffect(()=>d,[d]),h.useEffect(()=>{let e=o.current;return()=>{window.clearTimeout(e),i(null)}},[o,i]),(0,m.jsx)(oh,{asChild:!0,...c,children:(0,m.jsx)(oP,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":oZ(r.open),...e,ref:v(t,a.onTriggerChange),onClick:t=>{e.onClick?.(t),e.disabled||t.defaultPrevented||(t.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:ez(e.onPointerMove,o1(t=>{n.onItemEnter(t),!t.defaultPrevented&&(e.disabled||r.open||l.current||(n.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{r.onOpenChange(!0),d()},100)))})),onPointerLeave:ez(e.onPointerLeave,o1(e=>{d();let t=r.content?.getBoundingClientRect();if(t){let s=r.content?.dataset.side,a="right"===s,l=t[a?"left":"right"],i=t[a?"right":"left"];n.onPointerGraceIntentChange({area:[{x:e.clientX+(a?-5:5),y:e.clientY},{x:l,y:t.top},{x:i,y:t.top},{x:i,y:t.bottom},{x:l,y:t.bottom}],side:s}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>n.onPointerGraceIntentChange(null),300)}else{if(n.onTriggerLeave(e),e.defaultPrevented)return;n.onPointerGraceIntentChange(null)}})),onKeyDown:ez(e.onKeyDown,t=>{let a=""!==n.searchRef.current;e.disabled||a&&" "===t.key||oe[s.dir].includes(t.key)&&(r.onOpenChange(!0),r.content?.focus(),t.preventDefault())})})})});oJ.displayName=oG;var oX="MenuSubContent",oY=h.forwardRef((e,t)=>{let r=ov(oy,e.__scopeMenu),{forceMount:s=r.forceMount,...a}=e,n=ou(oy,e.__scopeMenu),l=om(oy,e.__scopeMenu),o=oK(oX,e.__scopeMenu),i=h.useRef(null),c=b(t,i);return(0,m.jsx)(os.Provider,{scope:e.__scopeMenu,children:(0,m.jsx)(te,{present:s||n.open,children:(0,m.jsx)(os.Slot,{scope:e.__scopeMenu,children:(0,m.jsx)(oS,{id:o.contentId,"aria-labelledby":o.triggerId,...a,ref:c,align:"start",side:"rtl"===l.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:e=>{l.isUsingKeyboardRef.current&&i.current?.focus(),e.preventDefault()},onCloseAutoFocus:e=>e.preventDefault(),onFocusOutside:ez(e.onFocusOutside,e=>{e.target!==o.trigger&&n.onOpenChange(!1)}),onEscapeKeyDown:ez(e.onEscapeKeyDown,e=>{l.onClose(),e.preventDefault()}),onKeyDown:ez(e.onKeyDown,e=>{let t=e.currentTarget.contains(e.target),r=ot[l.dir].includes(e.key);t&&r&&(n.onOpenChange(!1),o.trigger?.focus(),e.preventDefault())})})})})})});function oZ(e){return e?"open":"closed"}function oQ(e){return"indeterminate"===e}function o0(e){return oQ(e)?"indeterminate":e?"checked":"unchecked"}function o1(e){return t=>"mouse"===t.pointerType?e(t):void 0}oY.displayName=oX;var o2="DropdownMenu",[o5,o3]=eF(o2,[oo]),o8=oo(),[o4,o6]=o5(o2),o9=e=>{let{__scopeDropdownMenu:t,children:r,dir:s,open:a,defaultOpen:n,onOpenChange:l,modal:o=!0}=e,i=o8(t),c=h.useRef(null),[d=!1,u]=eB({prop:a,defaultProp:n,onChange:l});return(0,m.jsx)(o4,{scope:t,triggerId:eW(),triggerRef:c,contentId:eW(),open:d,onOpenChange:u,onOpenToggle:h.useCallback(()=>u(e=>!e),[u]),modal:o,children:(0,m.jsx)(op,{...i,open:d,onOpenChange:u,dir:s,modal:o,children:r})})};o9.displayName=o2;var o7="DropdownMenuTrigger",ie=h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,disabled:s=!1,...a}=e,n=o6(o7,r),l=o8(r);return(0,m.jsx)(oh,{asChild:!0,...l,children:(0,m.jsx)(eK.button,{type:"button",id:n.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":n.open?n.contentId:void 0,"data-state":n.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...a,ref:v(t,n.triggerRef),onPointerDown:ez(e.onPointerDown,e=>{!s&&0===e.button&&!1===e.ctrlKey&&(n.onOpenToggle(),n.open||e.preventDefault())}),onKeyDown:ez(e.onKeyDown,e=>{!s&&(["Enter"," "].includes(e.key)&&n.onOpenToggle(),"ArrowDown"===e.key&&n.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(e.key)&&e.preventDefault())})})})});ie.displayName=o7;var it=e=>{let{__scopeDropdownMenu:t,...r}=e,s=o8(t);return(0,m.jsx)(ob,{...s,...r})};it.displayName="DropdownMenuPortal";var ir="DropdownMenuContent",is=h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o6(ir,r),n=o8(r),l=h.useRef(!1);return(0,m.jsx)(oN,{id:a.contentId,"aria-labelledby":a.triggerId,...n,...s,ref:t,onCloseAutoFocus:ez(e.onCloseAutoFocus,e=>{l.current||a.triggerRef.current?.focus(),l.current=!1,e.preventDefault()}),onInteractOutside:ez(e.onInteractOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey,s=2===t.button||r;(!a.modal||s)&&(l.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});is.displayName=ir,h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oE,{...a,...s,ref:t})}).displayName="DropdownMenuGroup",h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oT,{...a,...s,ref:t})}).displayName="DropdownMenuLabel";var ia=h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oD,{...a,...s,ref:t})});ia.displayName="DropdownMenuItem",h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oA,{...a,...s,ref:t})}).displayName="DropdownMenuCheckboxItem",h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oq,{...a,...s,ref:t})}).displayName="DropdownMenuRadioGroup",h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oF,{...a,...s,ref:t})}).displayName="DropdownMenuRadioItem",h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oW,{...a,...s,ref:t})}).displayName="DropdownMenuItemIndicator";var il=h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(o$,{...a,...s,ref:t})});function io({...e}){return(0,m.jsx)(o9,{"data-slot":"dropdown-menu",...e})}function ii({...e}){return(0,m.jsx)(ie,{"data-slot":"dropdown-menu-trigger",...e})}function ic({className:e,sideOffset:t=4,...r}){return(0,m.jsx)(it,{children:(0,m.jsx)(is,{"data-slot":"dropdown-menu-content",sideOffset:t,className:eA("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...r})})}function id({className:e,inset:t,variant:r="default",...s}){return(0,m.jsx)(ia,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":r,className:eA("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s})}function iu({className:e,...t}){return(0,m.jsx)(il,{"data-slot":"dropdown-menu-separator",className:eA("bg-border -mx-1 my-1 h-px",e),...t})}il.displayName="DropdownMenuSeparator",h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oB,{...a,...s,ref:t})}).displayName="DropdownMenuArrow",h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oJ,{...a,...s,ref:t})}).displayName="DropdownMenuSubTrigger",h.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,a=o8(r);return(0,m.jsx)(oY,{...a,...s,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})}).displayName="DropdownMenuSubContent",rw("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);let ix=rw("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),im=rw("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),ip=rw("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ih=rw("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ig=rw("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),iv=rw("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),ib=rw("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function iy(){return window.parent&&window.parent!==window}function ij({onEditWorkflow:e}){let{workflows:t,selectedWorkflowId:r,setSelectedWorkflowId:s,updateWorkflow:a,addWorkflow:n,deleteWorkflow:l}=(0,f.useAutomation)(),[o,i]=(0,h.useState)(""),[c,d]=(0,h.useState)(!1),[u,x]=(0,h.useState)(!1),[p,g]=(0,h.useState)(null),[v,b]=(0,h.useState)(null),[y,j]=(0,h.useState)(!1),[w,N]=(0,h.useState)(""),[k,C]=(0,h.useState)(""),S=(0,h.useRef)(null),E=t.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())),T=async e=>{let r=t.find(t=>t.id===e);if(!r)return;let s=JSON.stringify((0,r_.serializeWorkflow)(r),null,2),a=`${r.name.toLowerCase().replace(/\s+/g,"-")}-workflow.json`;if(iy())try{await function(e){if(!iy())return Promise.reject(Error("Not in sandbox"));let t=crypto.randomUUID();return window.parent.postMessage({__fromSandbox:!0,requestId:t,payload:e},"*"),new Promise((e,r)=>{let s=setTimeout(()=>{window.removeEventListener("message",a),r(Error("Sandbox RPC timeout"))},3e3),a=n=>{let l=n.data;l?.__fromExtension&&l.requestId===t&&(clearTimeout(s),window.removeEventListener("message",a),l.error?r(Error(l.error)):e(l.response))};window.addEventListener("message",a)})}({type:"download.workflow",fileName:a,content:s}),d(!1);return}catch(e){console.warn("[export] sandbox download failed, falling back",e)}let n=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(n),o=document.createElement("a");o.href=l,o.download=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(l),d(!1)},R=()=>{if(!w.trim())return;let e={id:`wf-${Date.now()}`,name:w.trim(),description:k.trim()||"New automation workflow",status:"paused",steps:[],triggers:[],runs:[],settings:(0,r_.createDefaultSettings)(),variables:{},runCount:0,createdAt:Date.now(),updatedAt:Date.now()};n(e),s(e.id),j(!1),N(""),C("")};return(0,m.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,m.jsxs)("div",{className:"p-3 space-y-2 border-b border-border shrink-0",children:[(0,m.jsxs)("div",{className:"relative",children:[(0,m.jsx)(ix,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),(0,m.jsx)(eO,{placeholder:"Search workflows...",value:o,onChange:e=>i(e.target.value),className:"h-8 pl-8 text-xs bg-secondary border-border"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,m.jsxs)(eL,{size:"sm",className:"h-7 text-xs gap-1.5 bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>j(!0),children:[(0,m.jsx)(rI,{className:"h-3 w-3"}),"New"]}),(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1.5 border-border bg-transparent",onClick:()=>x(!0),children:[(0,m.jsx)(rq,{className:"h-3 w-3"}),"Import"]}),(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1.5 border-border bg-transparent",onClick:()=>d(!0),children:[(0,m.jsx)(rz,{className:"h-3 w-3"}),"Export"]})]})]}),(0,m.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,m.jsx)(lW,{className:"h-full",children:(0,m.jsx)("div",{className:"p-2 space-y-2",children:E.map(o=>{let i="paused"!==o.status&&"error"!==o.status;return(0,m.jsx)("div",{className:`p-2.5 rounded-lg border transition-colors cursor-pointer ${r===o.id?"border-primary/50 bg-primary/5":"border-border bg-card hover:border-border/80"}`,onClick:()=>s(o.id),children:(0,m.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("h3",{className:"text-sm font-medium truncate",children:o.name}),(0,m.jsx)(lo,{checked:i,onCheckedChange:e=>{a(o.id,{status:e?"idle":"paused"})},className:"scale-75",onClick:e=>e.stopPropagation()})]}),(0,m.jsxs)("div",{className:"flex items-center gap-1.5 mt-1",children:[(0,m.jsx)(nj,{className:"h-3 w-3 text-muted-foreground"}),(0,m.jsx)("span",{className:"text-[10px] text-muted-foreground font-mono",children:o.description})]}),(0,m.jsxs)("div",{className:"flex items-center gap-1 mt-1.5 flex-wrap",children:[(0,m.jsxs)(lc,{variant:"secondary",className:"text-[9px] px-1.5 py-0 h-4",children:[o.steps.length," steps"]}),(0,m.jsxs)(lc,{variant:"secondary",className:"text-[9px] px-1.5 py-0 h-4",children:[o.triggers.length," triggers"]}),(0,m.jsx)(lc,{variant:"error"===o.status?"destructive":"outline",className:"text-[9px] px-1.5 py-0 h-4",children:o.status})]})]}),(0,m.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,m.jsxs)(io,{children:[(0,m.jsx)(ii,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6",children:(0,m.jsx)(ig,{className:"h-3.5 w-3.5"})})}),(0,m.jsxs)(ic,{align:"end",className:"w-36",children:[(0,m.jsxs)(id,{className:"text-xs gap-2",children:[(0,m.jsx)(ng,{className:"h-3 w-3"})," Run"]}),(0,m.jsxs)(id,{className:"text-xs gap-2",onClick:e,children:[(0,m.jsx)(im,{className:"h-3 w-3"})," Edit"]}),(0,m.jsxs)(id,{className:"text-xs gap-2",onClick:e=>{e.stopPropagation(),(e=>{let r=t.find(t=>t.id===e);if(!r)return;let a={...r,id:`wf-${Date.now()}`,name:`${r.name} (Copy)`,createdAt:Date.now(),updatedAt:Date.now(),runs:[],runCount:0,lastRun:void 0,status:"paused"};n(a),s(a.id)})(o.id)},children:[(0,m.jsx)(ip,{className:"h-3 w-3"})," Duplicate"]}),(0,m.jsxs)(id,{className:"text-xs gap-2",onClick:e=>{e.stopPropagation(),T(o.id)},children:[(0,m.jsx)(rz,{className:"h-3 w-3"})," Export"]}),(0,m.jsx)(iu,{}),(0,m.jsxs)(id,{className:"text-xs gap-2 text-destructive",onClick:e=>{var r;e.stopPropagation(),r=o.id,t.length<=1||l(r)},disabled:t.length<=1,children:[(0,m.jsx)(ih,{className:"h-3 w-3"})," Delete"]})]})]}),o.lastRun&&(0,m.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-muted-foreground",children:["error"!==o.status?(0,m.jsx)(nw,{className:"h-3 w-3 text-green-500"}):(0,m.jsx)(nN,{className:"h-3 w-3 text-destructive"}),(0,m.jsx)(iv,{className:"h-2.5 w-2.5"}),(0,m.jsx)("span",{children:o.lastRun})]})]})]})},o.id)})})})}),(0,m.jsx)(rk,{open:c,onOpenChange:d,children:(0,m.jsxs)(rT,{className:"sm:max-w-md bg-background border-border",children:[(0,m.jsxs)(rR,{children:[(0,m.jsxs)(rD,{className:"text-foreground flex items-center gap-2",children:[(0,m.jsx)(rz,{className:"h-5 w-5"}),"Export Workflow"]}),(0,m.jsx)(rP,{children:"Select which workflow you want to export as JSON"})]}),(0,m.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:t.map(e=>(0,m.jsx)("button",{onClick:()=>T(e.id),className:"w-full p-3 rounded-lg border border-border bg-secondary/50 hover:bg-secondary transition-colors text-left",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{className:"text-sm font-medium text-foreground",children:e.name}),(0,m.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:e.description})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsxs)(lc,{variant:"secondary",className:"text-[10px]",children:[e.steps.length," steps"]}),(0,m.jsx)(rF,{className:"h-4 w-4 text-muted-foreground"})]})]})},e.id))})]})}),(0,m.jsx)(rk,{open:u,onOpenChange:e=>{x(e),!e&&(b(null),g(null),S.current&&(S.current.value=""))},children:(0,m.jsxs)(rT,{className:"sm:max-w-md bg-background border-border",children:[(0,m.jsxs)(rR,{children:[(0,m.jsxs)(rD,{className:"text-foreground flex items-center gap-2",children:[(0,m.jsx)(rq,{className:"h-5 w-5"}),"Import Workflow"]}),(0,m.jsx)(rP,{children:"Upload a workflow JSON file to import"})]}),(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center",children:[(0,m.jsx)("input",{ref:S,type:"file",accept:".json",onChange:e=>{let t=e.target.files?.[0];if(!t)return;g(null),b(null);let r=new FileReader;r.onload=e=>{try{let t=e.target?.result,r=JSON.parse(t);if(!(0,r_.validateWorkflowImport)(r))return void g("Invalid workflow file format. Please check the file structure.");let s=(0,r_.deserializeWorkflow)(r);b(s)}catch{g("Failed to parse JSON file. Please ensure it's a valid JSON.")}},r.readAsText(t)},className:"hidden",id:"workflow-file"}),(0,m.jsxs)("label",{htmlFor:"workflow-file",className:"cursor-pointer flex flex-col items-center gap-2",children:[(0,m.jsx)(rF,{className:"h-10 w-10 text-muted-foreground"}),(0,m.jsx)("span",{className:"text-sm text-muted-foreground",children:"Click to select a .json file"})]})]}),p&&(0,m.jsxs)("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-destructive/10 border border-destructive/20",children:[(0,m.jsx)(ib,{className:"h-4 w-4 text-destructive mt-0.5"}),(0,m.jsx)("p",{className:"text-xs text-destructive",children:p})]}),v&&(0,m.jsxs)("div",{className:"p-3 rounded-lg border border-border bg-secondary/50",children:[(0,m.jsx)("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Preview"}),(0,m.jsxs)("div",{className:"space-y-1.5 text-xs",children:[(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Name:"}),(0,m.jsx)("span",{className:"text-foreground font-medium",children:v.name})]}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Description:"}),(0,m.jsx)("span",{className:"text-foreground",children:v.description})]}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Steps:"}),(0,m.jsx)(lc,{variant:"secondary",children:v.steps.length})]}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Triggers:"}),(0,m.jsx)(lc,{variant:"secondary",children:v.triggers.length})]}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Allowed Sites:"}),(0,m.jsx)(lc,{variant:"secondary",children:v.settings?.allowedSites?.length||0})]}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Variables:"}),(0,m.jsx)(lc,{variant:"secondary",children:Object.keys(v.variables||{}).length})]}),v.settings?.wsEndpoint&&(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"WebSocket:"}),(0,m.jsx)("span",{className:"text-foreground font-mono text-[10px] truncate max-w-[180px]",children:v.settings.wsEndpoint})]})]})]}),(0,m.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,m.jsx)(eL,{variant:"outline",size:"sm",onClick:()=>x(!1),children:"Cancel"}),(0,m.jsx)(eL,{size:"sm",disabled:!v,onClick:()=>{v&&(n(v),s(v.id),x(!1),b(null),g(null),S.current&&(S.current.value=""))},children:"Import Workflow"})]})]})]})}),(0,m.jsx)(rk,{open:y,onOpenChange:j,children:(0,m.jsxs)(rT,{className:"sm:max-w-md bg-background border-border",children:[(0,m.jsxs)(rR,{children:[(0,m.jsxs)(rD,{className:"text-foreground flex items-center gap-2",children:[(0,m.jsx)(rI,{className:"h-5 w-5"}),"Create New Workflow"]}),(0,m.jsx)(rP,{children:"Create a new automation workflow"})]}),(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Workflow Name"}),(0,m.jsx)(eO,{className:"h-8 text-xs",placeholder:"My Workflow",value:w,onChange:e=>N(e.target.value),onKeyDown:e=>"Enter"===e.key&&R()})]}),(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Description (optional)"}),(0,m.jsx)(eO,{className:"h-8 text-xs",placeholder:"What does this workflow do?",value:k,onChange:e=>C(e.target.value)})]}),(0,m.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,m.jsx)(eL,{variant:"outline",size:"sm",onClick:()=>j(!1),children:"Cancel"}),(0,m.jsx)(eL,{size:"sm",onClick:R,disabled:!w.trim(),children:"Create Workflow"})]})]})]})})]})}var iw="Checkbox",[iN,ik]=eF(iw),[iC,iS]=iN(iw),iE=h.forwardRef((e,t)=>{let{__scopeCheckbox:r,name:s,checked:a,defaultChecked:n,required:l,disabled:o,value:i="on",onCheckedChange:c,form:d,...u}=e,[x,p]=h.useState(null),f=b(t,e=>p(e)),g=h.useRef(!1),v=!x||d||!!x.closest("form"),[y=!1,j]=eB({prop:a,defaultProp:n,onChange:c}),w=h.useRef(y);return h.useEffect(()=>{let e=x?.form;if(e){let t=()=>j(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[x,j]),(0,m.jsxs)(iC,{scope:r,state:y,disabled:o,children:[(0,m.jsx)(eK.button,{type:"button",role:"checkbox","aria-checked":iD(y)?"mixed":y,"aria-required":l,"data-state":iP(y),"data-disabled":o?"":void 0,disabled:o,value:i,...u,ref:f,onKeyDown:ez(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:ez(e.onClick,e=>{j(e=>!!iD(e)||!e),v&&(g.current=e.isPropagationStopped(),g.current||e.stopPropagation())})}),v&&(0,m.jsx)(iM,{control:x,bubbles:!g.current,name:s,value:i,checked:y,required:l,disabled:o,form:d,style:{transform:"translateX(-100%)"},defaultChecked:!iD(n)&&n})]})});iE.displayName=iw;var iT="CheckboxIndicator",iR=h.forwardRef((e,t)=>{let{__scopeCheckbox:r,forceMount:s,...a}=e,n=iS(iT,r);return(0,m.jsx)(te,{present:s||iD(n.state)||!0===n.state,children:(0,m.jsx)(eK.span,{"data-state":iP(n.state),"data-disabled":n.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});iR.displayName=iT;var iM=e=>{let{control:t,checked:r,bubbles:s=!0,defaultChecked:a,...n}=e,l=h.useRef(null),o=af(r),i=s6(t);h.useEffect(()=>{let e=l.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(o!==r&&t){let a=new Event("click",{bubbles:s});e.indeterminate=iD(r),t.call(e,!iD(r)&&r),e.dispatchEvent(a)}},[o,r,s]);let c=h.useRef(!iD(r)&&r);return(0,m.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??c.current,...n,tabIndex:-1,ref:l,style:{...e.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function iD(e){return"indeterminate"===e}function iP(e){return iD(e)?"indeterminate":e?"checked":"unchecked"}function iA({className:e,...t}){return(0,m.jsx)(iE,{"data-slot":"checkbox",className:eA("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,m.jsx)(iR,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,m.jsx)(no,{className:"size-3.5"})})})}let iI=rw("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]),iL=rw("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),iO=rw("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var iq="Collapsible",[iz,iF]=eF(iq),[i_,iU]=iz(iq),iV=h.forwardRef((e,t)=>{let{__scopeCollapsible:r,open:s,defaultOpen:a,disabled:n,onOpenChange:l,...o}=e,[i=!1,c]=eB({prop:s,defaultProp:a,onChange:l});return(0,m.jsx)(i_,{scope:r,disabled:n,contentId:eW(),open:i,onOpenToggle:h.useCallback(()=>c(e=>!e),[c]),children:(0,m.jsx)(eK.div,{"data-state":iG(i),"data-disabled":n?"":void 0,...o,ref:t})})});iV.displayName=iq;var iW="CollapsibleTrigger",i$=h.forwardRef((e,t)=>{let{__scopeCollapsible:r,...s}=e,a=iU(iW,r);return(0,m.jsx)(eK.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":iG(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...s,ref:t,onClick:ez(e.onClick,a.onOpenToggle)})});i$.displayName=iW;var iB="CollapsibleContent",iH=h.forwardRef((e,t)=>{let{forceMount:r,...s}=e,a=iU(iB,e.__scopeCollapsible);return(0,m.jsx)(te,{present:r||a.open,children:({present:e})=>(0,m.jsx)(iK,{...s,ref:t,present:e})})});iH.displayName=iB;var iK=h.forwardRef((e,t)=>{let{__scopeCollapsible:r,present:s,children:a,...n}=e,l=iU(iB,r),[o,i]=h.useState(s),c=h.useRef(null),d=b(t,c),u=h.useRef(0),x=u.current,p=h.useRef(0),f=p.current,g=l.open||o,v=h.useRef(g),y=h.useRef(void 0);return h.useEffect(()=>{let e=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(e)},[]),e_(()=>{let e=c.current;if(e){y.current=y.current||{transitionDuration:e.style.transitionDuration,animationName:e.style.animationName},e.style.transitionDuration="0s",e.style.animationName="none";let t=e.getBoundingClientRect();u.current=t.height,p.current=t.width,v.current||(e.style.transitionDuration=y.current.transitionDuration,e.style.animationName=y.current.animationName),i(s)}},[l.open,s]),(0,m.jsx)(eK.div,{"data-state":iG(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!g,...n,ref:d,style:{"--radix-collapsible-content-height":x?`${x}px`:void 0,"--radix-collapsible-content-width":f?`${f}px`:void 0,...e.style},children:g&&a})});function iG(e){return e?"open":"closed"}var iJ="Accordion",iX=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[iY,iZ,iQ]=r$(iJ),[i0,i1]=eF(iJ,[iQ,iF]),i2=iF(),i5=h.default.forwardRef((e,t)=>{let{type:r,...s}=e;return(0,m.jsx)(iY.Provider,{scope:e.__scopeAccordion,children:"multiple"===r?(0,m.jsx)(i7,{...s,ref:t}):(0,m.jsx)(i9,{...s,ref:t})})});i5.displayName=iJ;var[i3,i8]=i0(iJ),[i4,i6]=i0(iJ,{collapsible:!1}),i9=h.default.forwardRef((e,t)=>{let{value:r,defaultValue:s,onValueChange:a=()=>{},collapsible:n=!1,...l}=e,[o,i]=eB({prop:r,defaultProp:s,onChange:a});return(0,m.jsx)(i3,{scope:e.__scopeAccordion,value:o?[o]:[],onItemOpen:i,onItemClose:h.default.useCallback(()=>n&&i(""),[n,i]),children:(0,m.jsx)(i4,{scope:e.__scopeAccordion,collapsible:n,children:(0,m.jsx)(cr,{...l,ref:t})})})}),i7=h.default.forwardRef((e,t)=>{let{value:r,defaultValue:s,onValueChange:a=()=>{},...n}=e,[l=[],o]=eB({prop:r,defaultProp:s,onChange:a}),i=h.default.useCallback(e=>o((t=[])=>[...t,e]),[o]),c=h.default.useCallback(e=>o((t=[])=>t.filter(t=>t!==e)),[o]);return(0,m.jsx)(i3,{scope:e.__scopeAccordion,value:l,onItemOpen:i,onItemClose:c,children:(0,m.jsx)(i4,{scope:e.__scopeAccordion,collapsible:!0,children:(0,m.jsx)(cr,{...n,ref:t})})})}),[ce,ct]=i0(iJ),cr=h.default.forwardRef((e,t)=>{let{__scopeAccordion:r,disabled:s,dir:a,orientation:n="vertical",...l}=e,o=b(h.default.useRef(null),t),i=iZ(r),c="ltr"===rH(a),d=ez(e.onKeyDown,e=>{if(!iX.includes(e.key))return;let t=e.target,r=i().filter(e=>!e.ref.current?.disabled),s=r.findIndex(e=>e.ref.current===t),a=r.length;if(-1===s)return;e.preventDefault();let l=s,o=a-1,d=()=>{(l=s+1)>o&&(l=0)},u=()=>{(l=s-1)<0&&(l=o)};switch(e.key){case"Home":l=0;break;case"End":l=o;break;case"ArrowRight":"horizontal"===n&&(c?d():u());break;case"ArrowDown":"vertical"===n&&d();break;case"ArrowLeft":"horizontal"===n&&(c?u():d());break;case"ArrowUp":"vertical"===n&&u()}let x=l%a;r[x].ref.current?.focus()});return(0,m.jsx)(ce,{scope:r,disabled:s,direction:a,orientation:n,children:(0,m.jsx)(iY.Slot,{scope:r,children:(0,m.jsx)(eK.div,{...l,"data-orientation":n,ref:o,onKeyDown:s?void 0:d})})})}),cs="AccordionItem",[ca,cn]=i0(cs),cl=h.default.forwardRef((e,t)=>{let{__scopeAccordion:r,value:s,...a}=e,n=ct(cs,r),l=i8(cs,r),o=i2(r),i=eW(),c=s&&l.value.includes(s)||!1,d=n.disabled||e.disabled;return(0,m.jsx)(ca,{scope:r,open:c,disabled:d,triggerId:i,children:(0,m.jsx)(iV,{"data-orientation":n.orientation,"data-state":cm(c),...o,...a,ref:t,disabled:d,open:c,onOpenChange:e=>{e?l.onItemOpen(s):l.onItemClose(s)}})})});cl.displayName=cs;var co="AccordionHeader",ci=h.default.forwardRef((e,t)=>{let{__scopeAccordion:r,...s}=e,a=ct(iJ,r),n=cn(co,r);return(0,m.jsx)(eK.h3,{"data-orientation":a.orientation,"data-state":cm(n.open),"data-disabled":n.disabled?"":void 0,...s,ref:t})});ci.displayName=co;var cc="AccordionTrigger",cd=h.default.forwardRef((e,t)=>{let{__scopeAccordion:r,...s}=e,a=ct(iJ,r),n=cn(cc,r),l=i6(cc,r),o=i2(r);return(0,m.jsx)(iY.ItemSlot,{scope:r,children:(0,m.jsx)(i$,{"aria-disabled":n.open&&!l.collapsible||void 0,"data-orientation":a.orientation,id:n.triggerId,...o,...s,ref:t})})});cd.displayName=cc;var cu="AccordionContent",cx=h.default.forwardRef((e,t)=>{let{__scopeAccordion:r,...s}=e,a=ct(iJ,r),n=cn(cu,r),l=i2(r);return(0,m.jsx)(iH,{role:"region","aria-labelledby":n.triggerId,"data-orientation":a.orientation,...l,...s,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});function cm(e){return e?"open":"closed"}function cp({...e}){return(0,m.jsx)(i5,{"data-slot":"accordion",...e})}function ch({className:e,...t}){return(0,m.jsx)(cl,{"data-slot":"accordion-item",className:eA("border-b last:border-b-0",e),...t})}function cf({className:e,children:t,...r}){return(0,m.jsx)(ci,{className:"flex",children:(0,m.jsxs)(cd,{"data-slot":"accordion-trigger",className:eA("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",e),...r,children:[t,(0,m.jsx)(ni,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function cg({className:e,children:t,...r}){return(0,m.jsx)(cx,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...r,children:(0,m.jsx)("div",{className:eA("pt-0 pb-4",e),children:t})})}cx.displayName=cu;let cv=[{type:"webhookWs",label:"WebSocket",icon:iI},{type:"browserEvent",label:"Browser Event",icon:nj},{type:"domCondition",label:"DOM Condition",icon:iL},{type:"schedule",label:"Schedule",icon:iv}];function cb({label:e,help:t,required:r,children:s}){return(0,m.jsxs)("div",{className:"space-y-1.5",children:[(0,m.jsxs)("div",{className:"flex items-center gap-1",children:[(0,m.jsxs)(n4,{className:"text-xs",children:[e,r&&(0,m.jsx)("span",{className:"text-destructive ml-0.5",children:"*"})]}),t&&(0,m.jsxs)("span",{className:"text-[9px] text-muted-foreground truncate max-w-[180px]",title:t,children:["- ",t]})]}),s]})}function cy(){let{selectedWorkflowId:e,getWorkflow:t,addTrigger:r,updateTrigger:s,deleteTrigger:a,updateSettings:n,restartWebsocket:l,isPicking:o,setIsPicking:i,setPickedSelector:c,setOnPickComplete:d}=(0,f.useAutomation)(),u=t(e),x=!!u&&"paused"!==u.status,[p,g]=(0,h.useState)(!1),[v,b]=(0,h.useState)("create"),[y,j]=(0,h.useState)(null),[w,N]=(0,h.useState)(!1),[k,C]=(0,h.useState)(null),[S,E]=(0,h.useState)(!1),[T,R]=(0,h.useState)("webhookWs"),[M,D]=(0,h.useState)(""),[P,A]=(0,h.useState)((0,r_.getDefaultConfig)("webhookWs")),[I,L]=(0,h.useState)({}),O=(0,h.useCallback)(()=>{b("create"),j(null),R("webhookWs"),D(""),A((0,r_.getDefaultConfig)("webhookWs")),L({})},[]),q=(0,h.useCallback)(()=>{x||(O(),g(!0))},[O,x]),z=(0,h.useCallback)(e=>{x||(b("edit"),j(e.id),R(e.type),D(e.name),A({...e.config}),L({}),g(!0))},[x]),F=u?.triggers||[],_=u?.settings?.triggerPolicy||r_.defaultTriggerRunPolicy,U=u?.settings?.wsConnected??!1,V=t=>{n(e,{triggerPolicy:{..._,...t}})},W=(e,t)=>{A(r=>({...r,[e]:t})),I[e]&&L(t=>{let r={...t};return delete r[e],r})},$=(0,h.useCallback)(()=>{i(!1),c(null),d(null),E(!1)},[i,d,c,E]),B=(0,h.useCallback)(e=>{A(t=>({...t,selector:e})),L(e=>{if(!e.selector)return e;let t={...e};return delete t.selector,t}),E(!1)},[A,E,L]),H=(0,h.useCallback)(()=>{if(!x){if(o)return void $();c(null),d(()=>e=>{B(e)}),E(!0),i(!0)}},[B,$,o,i,d,c,E,x]);return(0,h.useEffect)(()=>{!p&&S&&$()},[$,S,p]),(0,h.useEffect)(()=>{S&&"domCondition"!==T&&$()},[$,T,S]),(0,h.useEffect)(()=>{o||E(!1)},[o,E]),M.trim()&&Object.keys(I).length,(0,m.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,m.jsxs)("div",{className:"p-3 border-b border-border flex items-center justify-between shrink-0",children:[(0,m.jsx)("div",{className:"flex items-center gap-3",children:(0,m.jsxs)("div",{className:"flex items-center gap-1.5 text-xs",children:[(0,m.jsx)(nC,{className:`h-3.5 w-3.5 ${U?"text-green-500":"text-destructive"}`}),(0,m.jsx)("span",{className:"text-muted-foreground",children:"WebSocket:"}),(0,m.jsx)("span",{className:U?"text-green-500 font-medium":"text-destructive font-medium",children:U?"Connected":"Disconnected"})]})}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-7 text-xs gap-1.5",children:[(0,m.jsx)(ny,{className:"h-3 w-3"}),"Reconnect"]})]}),(0,m.jsx)("div",{className:"p-3 border-b border-border",children:(0,m.jsxs)(rk,{open:p,onOpenChange:e=>{e||O(),g(e)},children:[(0,m.jsx)(rC,{asChild:!0,children:(0,m.jsxs)(eL,{size:"sm",className:"w-full h-8 text-xs gap-1.5 bg-primary hover:bg-primary/90 text-primary-foreground",onClick:q,disabled:x,children:[(0,m.jsx)(rI,{className:"h-3.5 w-3.5"}),"Add Trigger"]})}),(0,m.jsxs)(rT,{className:"max-w-md max-h-[85vh] overflow-hidden flex flex-col",children:[(0,m.jsxs)(rR,{children:[(0,m.jsx)(rD,{children:"edit"===v?"Edit Trigger":"Add Trigger"}),(0,m.jsx)(rP,{className:"text-xs text-muted-foreground",children:(e=>{switch(e){case"webhookWs":return"Configure how this workflow listens to WebSocket events.";case"browserEvent":return"React to browser lifecycle events on matched tabs.";case"domCondition":return"Wait for DOM conditions to be met before firing.";case"schedule":return"Run this workflow on a time-based schedule.";default:return"Configure when this workflow should start."}})(T)})]}),(0,m.jsx)(lW,{className:"flex-1 min-h-0 pr-4 overflow-y-auto",children:(0,m.jsxs)("div",{className:"space-y-3 py-2",children:[(0,m.jsx)(cb,{label:"Trigger Type",required:!0,children:(0,m.jsxs)(nd,{value:T,onValueChange:e=>{R(e),A((0,r_.getDefaultConfig)(e)),L({})},children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsx)(nm,{children:cv.map(e=>(0,m.jsx)(np,{value:e.type,className:"text-xs",children:(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(e.icon,{className:"h-3.5 w-3.5"}),e.label]})},e.type))})]})}),(0,m.jsxs)(cb,{label:"Name",required:!0,help:"Unique identifier (letters, numbers, _, -)",children:[(0,m.jsx)(eO,{className:`h-8 text-xs font-mono ${I.name?"border-destructive":""}`,placeholder:"my_trigger",value:M,onChange:e=>{D(e.target.value),I.name&&L(e=>{let t={...e};return delete t.name,t})}}),I.name&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.name})]}),(()=>{switch(T){case"webhookWs":return(0,m.jsxs)("div",{className:"space-y-3 pt-2 border-t border-border",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,m.jsx)(nC,{className:`h-3.5 w-3.5 ${U?"text-green-500":"text-destructive"}`}),"WebSocket: ",U?"Connected":"Disconnected",(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-6 text-[10px] ml-auto",onClick:()=>l(e),children:[(0,m.jsx)(ny,{className:"h-3 w-3 mr-1"}),"Reconnect"]})]}),(0,m.jsxs)(cb,{label:"Event name",required:!0,help:"Event name that triggers the workflow",children:[(0,m.jsx)(eO,{className:`h-8 text-xs font-mono ${I.eventName?"border-destructive":""}`,placeholder:"run_booking",value:P.eventName||"",onChange:e=>W("eventName",e.target.value)}),I.eventName&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.eventName})]}),(0,m.jsx)(cb,{label:"Channel",help:"Optional channel for event routing",children:(0,m.jsx)(eO,{className:"h-8 text-xs font-mono",placeholder:"default",value:P.channel||"",onChange:e=>W("channel",e.target.value)})}),(0,m.jsx)(cb,{label:"Auth token",help:"Simple token for event validation",children:(0,m.jsx)(eO,{className:"h-8 text-xs font-mono",type:"password",placeholder:"optional",value:P.authToken||"",onChange:e=>W("authToken",e.target.value)})}),(0,m.jsx)(cb,{label:"Dedupe window (ms)",help:"Prevents duplicate triggers (0 = disabled)",children:(0,m.jsx)(eO,{className:"h-8 text-xs",type:"number",placeholder:"0",value:P.dedupeWindowMs||0,onChange:e=>W("dedupeWindowMs",Number(e.target.value))})})]});case"browserEvent":return(0,m.jsxs)("div",{className:"space-y-3 pt-2 border-t border-border",children:[(0,m.jsx)(cb,{label:"Browser event",required:!0,children:(0,m.jsxs)(nd,{value:P.event||"navigation:completed",onValueChange:e=>W("event",e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"navigation:completed",className:"text-xs",children:"Navigation Completed"}),(0,m.jsx)(np,{value:"tabs:updated",className:"text-xs",children:"Tab Updated"}),(0,m.jsx)(np,{value:"tabs:activated",className:"text-xs",children:"Tab Activated"})]})]})}),(0,m.jsx)(cb,{label:"URL match type",required:!0,children:(0,m.jsxs)(nd,{value:P.urlMatchType||"hostEquals",onValueChange:e=>W("urlMatchType",e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"hostEquals",className:"text-xs",children:"Host Equals"}),(0,m.jsx)(np,{value:"contains",className:"text-xs",children:"URL Contains"}),(0,m.jsx)(np,{value:"regex",className:"text-xs",children:"Regex"})]})]})}),(0,m.jsxs)(cb,{label:"URL value",required:!0,help:"The URL pattern to match",children:[(0,m.jsx)(eO,{className:`h-8 text-xs font-mono ${I.urlValue?"border-destructive":""}`,placeholder:"hostEquals"===P.urlMatchType?"portal.site.com":"contains"===P.urlMatchType?"/dashboard":"/.*dashboard.*/",value:P.urlValue||"",onChange:e=>W("urlValue",e.target.value)}),I.urlValue&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.urlValue})]}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(iA,{id:"runOnce",checked:P.runOncePerSession??!0,onCheckedChange:e=>W("runOncePerSession",e)}),(0,m.jsx)("label",{htmlFor:"runOnce",className:"text-[10px] text-muted-foreground cursor-pointer",children:"Run once per session"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(iA,{id:"tabActive",checked:P.onlyIfTabActive??!1,onCheckedChange:e=>W("onlyIfTabActive",e)}),(0,m.jsx)("label",{htmlFor:"tabActive",className:"text-[10px] text-muted-foreground cursor-pointer",children:"Only if tab is active"})]})]}),(0,m.jsx)(cb,{label:"Debounce (ms)",help:"Prevents rapid multiple triggers",children:(0,m.jsx)(eO,{className:"h-8 text-xs",type:"number",value:P.debounceMs||300,onChange:e=>W("debounceMs",Number(e.target.value))})})]});case"domCondition":return(0,m.jsxs)("div",{className:"space-y-3 pt-2 border-t border-border",children:[(0,m.jsx)(cb,{label:"Condition",required:!0,children:(0,m.jsxs)(nd,{value:P.condition||"selectorAppears",onValueChange:e=>W("condition",e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"selectorAppears",className:"text-xs",children:"Selector Appears"}),(0,m.jsx)(np,{value:"selectorDisappears",className:"text-xs",children:"Selector Disappears"}),(0,m.jsx)(np,{value:"textContains",className:"text-xs",children:"Text Contains"}),(0,m.jsx)(np,{value:"attributeEquals",className:"text-xs",children:"Attribute Equals"}),(0,m.jsx)(np,{value:"elementEnabled",className:"text-xs",children:"Element Enabled"})]})]})}),(0,m.jsxs)(cb,{label:"CSS Selector",required:!0,children:[(0,m.jsxs)("div",{className:"flex gap-1.5",children:[(0,m.jsx)(eO,{className:`h-8 text-xs font-mono flex-1 ${I.selector?"border-destructive":""}`,placeholder:"#continueBtn",value:P.selector||"",onChange:e=>W("selector",e.target.value)}),(0,m.jsx)(eL,{variant:"outline",size:"sm",className:"h-8 px-2 bg-transparent",onClick:H,disabled:x&&!o,children:o&&S?(0,m.jsx)(ny,{className:"h-3.5 w-3.5 animate-spin"}):(0,m.jsx)(nb,{className:"h-3.5 w-3.5"})})]}),I.selector&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.selector})]}),"textContains"===P.condition&&(0,m.jsxs)(cb,{label:"Text",required:!0,children:[(0,m.jsx)(eO,{className:`h-8 text-xs ${I.text?"border-destructive":""}`,placeholder:"Continue",value:P.text||"",onChange:e=>W("text",e.target.value)}),I.text&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.text})]}),"attributeEquals"===P.condition&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(cb,{label:"Attribute name",required:!0,children:[(0,m.jsx)(eO,{className:`h-8 text-xs font-mono ${I.attributeName?"border-destructive":""}`,placeholder:"aria-disabled",value:P.attributeName||"",onChange:e=>W("attributeName",e.target.value)}),I.attributeName&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.attributeName})]}),(0,m.jsxs)(cb,{label:"Attribute value",required:!0,children:[(0,m.jsx)(eO,{className:`h-8 text-xs font-mono ${I.attributeValue?"border-destructive":""}`,placeholder:"false",value:P.attributeValue||"",onChange:e=>W("attributeValue",e.target.value)}),I.attributeValue&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.attributeValue})]})]}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,m.jsx)(cb,{label:"Timeout (ms)",children:(0,m.jsx)(eO,{className:"h-8 text-xs",type:"number",value:P.timeoutMs||1e4,onChange:e=>W("timeoutMs",Number(e.target.value))})}),(0,m.jsx)(cb,{label:"Cooldown (ms)",children:(0,m.jsx)(eO,{className:"h-8 text-xs",type:"number",value:P.cooldownMs||1e3,onChange:e=>W("cooldownMs",Number(e.target.value))})})]}),(0,m.jsx)(cb,{label:"Fire mode",children:(0,m.jsxs)(nd,{value:P.fireMode||"once",onValueChange:e=>W("fireMode",e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"once",className:"text-xs",children:"Once"}),(0,m.jsx)(np,{value:"everyTime",className:"text-xs",children:"Every Time"})]})]})}),(0,m.jsx)(cb,{label:"Scope",children:(0,m.jsxs)(nd,{value:P.targetTabScope||"currentTab",onValueChange:e=>W("targetTabScope",e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"currentTab",className:"text-xs",children:"Current Tab"}),(0,m.jsx)(np,{value:"anyTabMatchingScope",className:"text-xs",children:"Any Tab Matching Scope"})]})]})}),"anyTabMatchingScope"===P.targetTabScope&&(0,m.jsx)(cb,{label:"Scope URL regex",help:"Which tabs to observe",children:(0,m.jsx)(eO,{className:"h-8 text-xs font-mono",placeholder:".*example\\.com.*",value:P.scopeUrlRegex||"",onChange:e=>W("scopeUrlRegex",e.target.value)})})]});case"schedule":return(0,m.jsxs)("div",{className:"space-y-3 pt-2 border-t border-border",children:[(0,m.jsx)(cb,{label:"Schedule mode",required:!0,children:(0,m.jsxs)(nd,{value:P.mode||"everyMinutes",onValueChange:e=>{A(t=>({...t,mode:e,..."everyMinutes"===e?{everyMinutes:t.everyMinutes||1}:{},..."everyMs"===e?{everyMs:t.everyMs||1e3}:{}})),L(e=>{let t={...e};return delete t.everyMinutes,delete t.everyMs,delete t.dailyTime,delete t.cronExpression,t})},children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"everyMinutes",className:"text-xs",children:"Every X Minutes"}),(0,m.jsx)(np,{value:"everyMs",className:"text-xs",children:"Every X ms"}),(0,m.jsx)(np,{value:"dailyAt",className:"text-xs",children:"Daily At"}),(0,m.jsx)(np,{value:"cronLike",className:"text-xs",children:"Cron-like"})]})]})}),"everyMinutes"===P.mode&&(0,m.jsxs)(cb,{label:"Every (minutes)",required:!0,help:"Minimum 1 minute",children:[(0,m.jsx)(eO,{className:`h-8 text-xs ${I.everyMinutes?"border-destructive":""}`,type:"number",min:1,value:P.everyMinutes||30,onChange:e=>W("everyMinutes",Number(e.target.value))}),I.everyMinutes&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.everyMinutes})]}),"everyMs"===P.mode&&(0,m.jsxs)(cb,{label:"Every (ms)",required:!0,help:"Minimum 10 ms",children:[(0,m.jsx)(eO,{className:`h-8 text-xs ${I.everyMs?"border-destructive":""}`,type:"number",min:10,value:P.everyMs??1e3,onChange:e=>W("everyMs",Number(e.target.value))}),I.everyMs&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.everyMs})]}),"dailyAt"===P.mode&&(0,m.jsxs)(cb,{label:"Time (HH:MM)",required:!0,children:[(0,m.jsx)(eO,{className:`h-8 text-xs font-mono ${I.dailyTime?"border-destructive":""}`,placeholder:"09:00",value:P.dailyTime||"",onChange:e=>W("dailyTime",e.target.value)}),I.dailyTime&&(0,m.jsx)("p",{className:"text-[10px] text-destructive",children:I.dailyTime})]}),"cronLike"===P.mode&&(0,m.jsx)(cb,{label:"Cron expression",help:"e.g., */15 * * * *",children:(0,m.jsx)(eO,{className:"h-8 text-xs font-mono",placeholder:"*/15 * * * *",value:P.cronExpression||"",onChange:e=>W("cronExpression",e.target.value)})}),(0,m.jsx)(cb,{label:"Timezone",children:(0,m.jsxs)(nd,{value:P.timezone||"local",onValueChange:e=>W("timezone",e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"local",className:"text-xs",children:"Local"}),(0,m.jsx)(np,{value:"UTC",className:"text-xs",children:"UTC"})]})]})}),(0,m.jsx)(cb,{label:"Jitter (ms)",help:"Randomize timing to avoid patterns",children:(0,m.jsx)(eO,{className:"h-8 text-xs",type:"number",value:P.jitterMs||0,onChange:e=>W("jitterMs",Number(e.target.value))})}),(0,m.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded",children:[(0,m.jsx)(iA,{id:"runIfClosed",checked:P.runIfBrowserClosed??!1,onCheckedChange:e=>W("runIfBrowserClosed",e),disabled:!0}),(0,m.jsx)("label",{htmlFor:"runIfClosed",className:"text-[10px] text-muted-foreground",children:"Run if browser closed (not guaranteed)"}),(0,m.jsx)(iO,{className:"h-3 w-3 text-amber-500 ml-auto"})]})]});default:return null}})()]})}),(0,m.jsx)("div",{className:"pt-3 border-t border-border",children:(0,m.jsx)(eL,{className:"w-full h-8 text-xs",onClick:()=>{if(x||!(()=>{let e={};switch(M.trim()?!/^[a-z0-9_-]+$/i.test(M)&&(e.name="Use only letters, numbers, _ or -"):e.name="Name is required",T){case"webhookWs":P.eventName?.trim()||(e.eventName="Event name is required");break;case"browserEvent":if(P.urlValue?.trim()||(e.urlValue="URL value is required"),"regex"===P.urlMatchType)try{new RegExp(P.urlValue)}catch{e.urlValue="Invalid regex pattern"}break;case"domCondition":P.selector?.trim()||(e.selector="Selector is required"),"textContains"!==P.condition||P.text?.trim()||(e.text="Text is required"),"attributeEquals"===P.condition&&(P.attributeName?.trim()||(e.attributeName="Attribute name is required"),P.attributeValue?.trim()||(e.attributeValue="Attribute value is required"));break;case"schedule":"everyMinutes"===P.mode&&(P.everyMinutes<1||isNaN(P.everyMinutes))&&(e.everyMinutes="Must be at least 1 minute"),"everyMs"===P.mode&&(P.everyMs<10||isNaN(P.everyMs))&&(e.everyMs="Must be at least 10 ms"),"dailyAt"!==P.mode||/^\d{2}:\d{2}$/.test(P.dailyTime)||(e.dailyTime="Format must be HH:MM")}return L(e),0===Object.keys(e).length})())return;let t=(u?.settings?.allowedSites?.length||0)>0;"edit"===v&&y?s(e,y,{name:M,type:T,config:P}):(r(e,{id:`tr-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:M,type:T,enabled:!0,config:P,createdAt:Date.now()}),t||alert("Configure pelo menos um Allowed Site antes de ativar um trigger.")),O(),g(!1)},disabled:!M.trim()||x,children:"edit"===v?"Save Changes":"Create Trigger"})})]})]})}),x&&(0,m.jsx)("div",{className:"mx-3 mb-2 p-2 rounded border border-amber-500/30 bg-amber-500/10 text-amber-900 text-[11px]",children:"Trigger is ON. Set it to OFF in the header to edit, create, or delete triggers."}),(0,m.jsx)("div",{className:"p-3 border-b border-border bg-muted/30",children:(0,m.jsx)(cp,{type:"single",collapsible:!0,children:(0,m.jsxs)(ch,{value:"policy",className:"border border-border rounded-md px-2",children:[(0,m.jsx)(cf,{className:"text-xs font-medium py-2 hover:no-underline",children:(0,m.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(nS,{className:"h-3.5 w-3.5 text-primary"}),(0,m.jsx)("span",{children:"Trigger handling"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2 text-[10px] text-muted-foreground",children:[(0,m.jsx)("span",{children:"single"===_.mode?"One event at a time":"restart"===_.mode?"Restart on new trigger":`Parallel x${_.parallelLimit}`}),(0,m.jsx)(lc,{variant:"secondary",className:"text-[9px] px-1.5 py-0 h-4",children:"Workflow-level"})]})]})}),(0,m.jsxs)(cg,{className:"pb-3 pt-1",children:[(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground mb-2",children:"Choose what happens when a new trigger fires while a run is in progress."}),(0,m.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[(0,m.jsx)(cb,{label:"When a trigger fires",children:(0,m.jsxs)(nd,{value:_.mode,onValueChange:e=>V({mode:e}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"single",className:"text-xs",children:"One event at a time (ignore while running)"}),(0,m.jsx)(np,{value:"restart",className:"text-xs",children:"Cancel current run and restart"}),(0,m.jsx)(np,{value:"parallel",className:"text-xs",children:"Run in parallel (limit)"})]})]})}),(0,m.jsx)(cb,{label:"Parallel limit",help:"How many runs can overlap",children:(0,m.jsx)(eO,{className:"h-8 text-xs",type:"number",min:1,value:_.parallelLimit,onChange:e=>V({parallelLimit:Math.max(1,Number(e.target.value)||r_.defaultTriggerRunPolicy.parallelLimit)}),disabled:"parallel"!==_.mode})})]})]})]})})}),(0,m.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,m.jsx)(lW,{className:"h-full",children:(0,m.jsx)("div",{className:"p-2 space-y-2",children:0===F.length?(0,m.jsx)("div",{className:"p-4 text-center text-xs text-muted-foreground",children:'No triggers yet. Click "Add Trigger" to create one.'}):F.map(t=>{var r,n;let l,o,i=(r=t.type,(l=cv.find(e=>e.type===r))?l.icon:iI);return(0,m.jsx)("div",{className:"p-2.5 rounded-lg border border-border bg-card",children:(0,m.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,m.jsxs)("div",{className:"flex items-start gap-2",children:[(0,m.jsx)("div",{className:"mt-0.5 p-1.5 rounded bg-secondary",children:(0,m.jsx)(i,{className:"h-3.5 w-3.5 text-muted-foreground"})}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("h4",{className:"text-xs font-medium",children:t.name}),(0,m.jsx)(lc,{variant:"outline",className:"text-[9px] px-1.5 py-0 h-4",children:(n=t.type,(o=cv.find(e=>e.type===n))?o.label:n)})]}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground mt-0.5 font-mono",children:(e=>{switch(e.type){case"webhookWs":return`event: ${e.config.eventName}`;case"browserEvent":let t=e.config;return`${t.event} @ ${t.urlValue}`;case"domCondition":let r=e.config;return`${r.condition}: ${r.selector}`;case"schedule":let s=e.config;if("everyMinutes"===s.mode)return`every ${s.everyMinutes}m`;if("everyMs"===s.mode)return`every ${s.everyMs}ms`;if("dailyAt"===s.mode)return`daily @ ${s.dailyTime}`;return s.mode;default:return""}})(t)}),t.lastEvent&&(0,m.jsxs)("p",{className:"text-[10px] text-muted-foreground mt-1 flex items-center gap-1",children:[(0,m.jsx)(nw,{className:"h-2.5 w-2.5 text-green-500"}),"Last event: ",t.lastEvent]})]})]}),(0,m.jsxs)("div",{className:"flex items-center gap-1",children:[(0,m.jsx)(lo,{checked:t.enabled,onCheckedChange:r=>((t,r)=>{if(x)return;let a=(u?.settings?.allowedSites?.length||0)>0;r&&!a?alert("Configure Allowed Sites antes de ativar um trigger."):s(e,t,{enabled:r})})(t.id,r),className:"scale-75 border border-muted-foreground/25 data-[state=unchecked]:bg-muted/80",disabled:x}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>z(t),disabled:x,children:(0,m.jsx)(im,{className:"h-3 w-3"})}),(0,m.jsxs)(rk,{open:w&&k===t.id,onOpenChange:e=>{N(e),e&&C(t.id)},children:[(0,m.jsx)(rC,{asChild:!0,children:(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6",children:(0,m.jsx)(ng,{className:"h-3 w-3"})})}),(0,m.jsxs)(rT,{className:"max-w-sm",children:[(0,m.jsx)(rR,{children:(0,m.jsx)(rD,{className:"text-sm",children:"Simulate Trigger"})}),(0,m.jsxs)("div",{className:"space-y-3 py-2",children:[(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Payload (JSON)"}),(0,m.jsx)(eq,{className:"h-32 text-xs font-mono",defaultValue:`{
  "userId": "123",
  "action": "test"
}`})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"flex-1 h-8 text-xs gap-1.5 bg-transparent",children:[(0,m.jsx)(ip,{className:"h-3 w-3"}),"Copy Example"]}),(0,m.jsxs)(eL,{size:"sm",className:"flex-1 h-8 text-xs gap-1.5 bg-primary text-primary-foreground",children:[(0,m.jsx)(ng,{className:"h-3 w-3"}),"Fire Trigger"]})]})]})]})]}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>{var r;return r=t.id,void(!x&&a(e,r))},disabled:x,children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]})]})},t.id)})})})})]})}var cj="Tabs",[cw,cN]=eF(cj,[lZ]),ck=lZ(),[cC,cS]=cw(cj),cE=h.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,onValueChange:a,defaultValue:n,orientation:l="horizontal",dir:o,activationMode:i="automatic",...c}=e,d=rH(o),[u,x]=eB({prop:s,onChange:a,defaultProp:n});return(0,m.jsx)(cC,{scope:r,baseId:eW(),value:u,onValueChange:x,orientation:l,dir:d,activationMode:i,children:(0,m.jsx)(eK.div,{dir:d,"data-orientation":l,...c,ref:t})})});cE.displayName=cj;var cT="TabsList",cR=h.forwardRef((e,t)=>{let{__scopeTabs:r,loop:s=!0,...a}=e,n=cS(cT,r),l=ck(r);return(0,m.jsx)(l1,{asChild:!0,...l,orientation:n.orientation,dir:n.dir,loop:s,children:(0,m.jsx)(eK.div,{role:"tablist","aria-orientation":n.orientation,...a,ref:t})})});cR.displayName=cT;var cM="TabsTrigger",cD=h.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,disabled:a=!1,...n}=e,l=cS(cM,r),o=ck(r),i=cI(l.baseId,s),c=cL(l.baseId,s),d=s===l.value;return(0,m.jsx)(l3,{asChild:!0,...o,focusable:!a,active:d,children:(0,m.jsx)(eK.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":c,"data-state":d?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:i,...n,ref:t,onMouseDown:ez(e.onMouseDown,e=>{a||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(s)}),onKeyDown:ez(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(s)}),onFocus:ez(e.onFocus,()=>{let e="manual"!==l.activationMode;d||a||!e||l.onValueChange(s)})})})});cD.displayName=cM;var cP="TabsContent",cA=h.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,forceMount:a,children:n,...l}=e,o=cS(cP,r),i=cI(o.baseId,s),c=cL(o.baseId,s),d=s===o.value,u=h.useRef(d);return h.useEffect(()=>{let e=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,m.jsx)(te,{present:a||d,children:({present:r})=>(0,m.jsx)(eK.div,{"data-state":d?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":i,hidden:!r,id:c,tabIndex:0,...l,ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0},children:r&&n})})});function cI(e,t){return`${e}-trigger-${t}`}function cL(e,t){return`${e}-content-${t}`}function cO({className:e,...t}){return(0,m.jsx)(cE,{"data-slot":"tabs",className:eA("flex flex-col gap-2",e),...t})}function cq({className:e,...t}){return(0,m.jsx)(cR,{"data-slot":"tabs-list",className:eA("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function cz({className:e,...t}){return(0,m.jsx)(cD,{"data-slot":"tabs-trigger",className:eA("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function cF({className:e,...t}){return(0,m.jsx)(cA,{"data-slot":"tabs-content",className:eA("flex-1 outline-none",e),...t})}function c_({...e}){return(0,m.jsx)(iV,{"data-slot":"collapsible",...e})}function cU({...e}){return(0,m.jsx)(i$,{"data-slot":"collapsible-trigger",...e})}function cV({...e}){return(0,m.jsx)(iH,{"data-slot":"collapsible-content",...e})}cA.displayName=cP;var cW=e.i(96185);let c$=rw("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),cB=rw("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]),cH=rw("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]),cK=rw("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),cG=rw("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),cJ=rw("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]),cX=rw("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),cY=rw("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),cZ=rw("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]),cQ=rw("FileCode",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]]),c0=rw("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),c1=rw("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]),c2=rw("Braces",[["path",{d:"M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1",key:"ezmyqa"}],["path",{d:"M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1",key:"e1hn23"}]]),c5=rw("Variable",[["path",{d:"M8 21s-4-3-4-9 4-9 4-9",key:"uto9ud"}],["path",{d:"M16 3s4 3 4 9-4 9-4 9",key:"4w2vsq"}],["line",{x1:"15",x2:"9",y1:"9",y2:"15",key:"f7djnv"}],["line",{x1:"9",x2:"15",y1:"9",y2:"15",key:"1shsy8"}]]),c3=rw("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),c8=rw("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);function c4(e){let t=crypto.randomUUID();return window.parent.postMessage({__fromSandbox:!0,requestId:t,payload:e},"*"),new Promise((e,r)=>{let s=a=>{let n=a.data;n?.__fromExtension&&n.requestId===t&&(window.removeEventListener("message",s),n.error?r(Error(n.error)):e(n.response))};window.addEventListener("message",s)})}function c6({open:e,onClose:t,title:r,children:s,footer:a}){return e?(0,m.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,m.jsx)("div",{className:"absolute inset-0 bg-black/50"}),(0,m.jsxs)("div",{className:"relative bg-background border border-border rounded-lg shadow-xl w-[520px] max-w-[calc(100vw-32px)] h-[85vh] max-h-[780px] flex flex-col overflow-hidden",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-border shrink-0",children:[(0,m.jsx)("h3",{className:"text-sm font-medium",children:r}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:t,children:(0,m.jsx)(rN,{className:"h-4 w-4"})})]}),(0,m.jsx)("div",{className:"flex-1 overflow-y-auto p-4 overscroll-contain",children:s}),a&&(0,m.jsx)("div",{className:"shrink-0 border-t border-border p-3 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/80",children:a})]})]}):null}function c9({config:e,onChange:t,label:r}){return(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)(n4,{className:"text-xs flex items-center gap-1.5",children:[(0,m.jsx)(cY,{className:"h-3 w-3"}),r]}),(0,m.jsx)(lo,{checked:e.enabled,onCheckedChange:r=>t({...e,enabled:r}),className:"scale-75"})]}),e.enabled&&(0,m.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Server URL"}),(0,m.jsx)(eO,{placeholder:"https://api.example.com/upload",value:e.url,onChange:r=>t({...e,url:r.target.value}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Method"}),(0,m.jsxs)(nd,{value:e.method,onValueChange:r=>t({...e,method:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"POST",children:"POST"}),(0,m.jsx)(np,{value:"PUT",children:"PUT"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Data Field"}),(0,m.jsx)(eO,{placeholder:"data",value:e.dataField,onChange:r=>t({...e,dataField:r.target.value}),className:"h-8 text-xs font-mono"})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Headers"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-[10px]",onClick:()=>t({...e,headers:[...e.headers,{key:"",value:""}]}),children:[(0,m.jsx)(rI,{className:"h-3 w-3 mr-0.5"}),"Add"]})]}),e.headers.map((r,s)=>(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"Key",value:r.key,onChange:r=>{let a=[...e.headers];a[s]={...a[s],key:r.target.value},t({...e,headers:a})},className:"h-7 text-xs flex-1"}),(0,m.jsx)(eO,{placeholder:"Value",value:r.value,onChange:r=>{let a=[...e.headers];a[s]={...a[s],value:r.target.value},t({...e,headers:a})},className:"h-7 text-xs flex-1"}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>t({...e,headers:e.headers.filter((e,t)=>t!==s)}),children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},s))]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Body Template (optional)"}),(0,m.jsx)(eq,{placeholder:'{"{{dataField}}": "{{data}}", "timestamp": {{timestamp}}}',value:e.bodyTemplate||"",onChange:r=>t({...e,bodyTemplate:r.target.value}),className:"h-16 text-xs font-mono"}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Use ","{{data}}"," for content, ","{{timestamp}}"," for unix time"]})]})]})]})}function c7({valueSource:e,onChange:t,label:r}){return(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,m.jsx)(c5,{className:"h-4 w-4 text-primary"}),(0,m.jsx)("span",{className:"text-xs font-medium",children:r})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Value Source"}),(0,m.jsxs)(nd,{value:e.type,onValueChange:r=>t({...e,type:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"fixed",children:"Fixed Value"}),(0,m.jsx)(np,{value:"request",children:"From Request"})]})]})]}),"fixed"===e.type?(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Value"}),(0,m.jsx)(eO,{placeholder:"Enter value or {{vars.name}}",value:e.fixedValue||"",onChange:r=>t({...e,fixedValue:r.target.value}),className:"h-8 text-xs font-mono"})]}):(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Request URL"}),(0,m.jsx)(eO,{placeholder:"https://api.example.com/data",value:e.requestConfig?.url||"",onChange:r=>t({...e,requestConfig:{...e.requestConfig,url:r.target.value}}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Method"}),(0,m.jsxs)(nd,{value:e.requestConfig?.method||"GET",onValueChange:r=>t({...e,requestConfig:{...e.requestConfig,method:r}}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"GET",children:"GET"}),(0,m.jsx)(np,{value:"POST",children:"POST"}),(0,m.jsx)(np,{value:"PUT",children:"PUT"}),(0,m.jsx)(np,{value:"DELETE",children:"DELETE"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"JSON Path"}),(0,m.jsx)(eO,{placeholder:"data.value",value:e.requestConfig?.responseJsonPath||"",onChange:r=>t({...e,requestConfig:{...e.requestConfig,responseJsonPath:r.target.value}}),className:"h-8 text-xs font-mono"})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Content-Type"}),(0,m.jsxs)(nd,{value:e.requestConfig?.contentType||"application/json",onValueChange:r=>t({...e,requestConfig:{...e.requestConfig,contentType:r}}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"application/json",children:"application/json"}),(0,m.jsx)(np,{value:"text/plain",children:"text/plain"}),(0,m.jsx)(np,{value:"application/x-www-form-urlencoded",children:"application/x-www-form-urlencoded"}),(0,m.jsx)(np,{value:"none",children:"(none)"})]})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Headers"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-[10px]",onClick:()=>t({...e,requestConfig:{...e.requestConfig,headers:[...e.requestConfig?.headers||[],{key:"",value:""}]}}),children:[(0,m.jsx)(rI,{className:"h-3 w-3 mr-0.5"}),"Add"]})]}),(e.requestConfig?.headers||[]).map((r,s)=>(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"Key",value:r.key,onChange:r=>{let a=[...e.requestConfig?.headers||[]];a[s]={...a[s],key:r.target.value},t({...e,requestConfig:{...e.requestConfig,headers:a}})},className:"h-7 text-xs flex-1"}),(0,m.jsx)(eO,{placeholder:"Value",value:r.value,onChange:r=>{let a=[...e.requestConfig?.headers||[]];a[s]={...a[s],value:r.target.value},t({...e,requestConfig:{...e.requestConfig,headers:a}})},className:"h-7 text-xs flex-1"}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>t({...e,requestConfig:{...e.requestConfig,headers:(e.requestConfig?.headers||[]).filter((e,t)=>t!==s)}}),children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},s))]}),(0,m.jsxs)("div",{className:"space-y-2 border-t border-border pt-2 mt-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Retry on Condition"}),(0,m.jsx)(lo,{checked:e.requestConfig?.retry?.enabled||!1,onCheckedChange:r=>t({...e,requestConfig:{...e.requestConfig,retry:{...e.requestConfig.retry,enabled:r}}}),className:"scale-75"})]}),e.requestConfig?.retry?.enabled&&(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Condition Type"}),(0,m.jsxs)(nd,{value:e.requestConfig.retry.conditionType||"jsonField",onValueChange:r=>t({...e,requestConfig:{...e.requestConfig,retry:{...e.requestConfig.retry,conditionType:r}}}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"jsonField",children:"JSON Field"}),(0,m.jsx)(np,{value:"statusCode",children:"Status Code"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Max Retries"}),(0,m.jsx)(eO,{type:"number",value:e.requestConfig.retry.maxRetries||3,onChange:r=>t({...e,requestConfig:{...e.requestConfig,retry:{...e.requestConfig.retry,maxRetries:Number.parseInt(r.target.value)||3}}}),className:"h-8 text-xs"})]})]}),"jsonField"===e.requestConfig.retry.conditionType?(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"JSON Field"}),(0,m.jsx)(eO,{placeholder:"status",value:e.requestConfig.retry.jsonField||"",onChange:r=>t({...e,requestConfig:{...e.requestConfig,retry:{...e.requestConfig.retry,jsonField:r.target.value}}}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"w-24 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Operator"}),(0,m.jsxs)(nd,{value:e.requestConfig.retry.jsonFieldOperator||"notEquals",onValueChange:r=>t({...e,requestConfig:{...e.requestConfig,retry:{...e.requestConfig.retry,jsonFieldOperator:r}}}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"equals",children:"="}),(0,m.jsx)(np,{value:"notEquals",children:"!="}),(0,m.jsx)(np,{value:"contains",children:"contains"}),(0,m.jsx)(np,{value:"notContains",children:"!contains"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Value"}),(0,m.jsx)(eO,{placeholder:"error",value:e.requestConfig.retry.jsonFieldValue||"",onChange:r=>t({...e,requestConfig:{...e.requestConfig,retry:{...e.requestConfig.retry,jsonFieldValue:r.target.value}}}),className:"h-8 text-xs"})]})]}):(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Expected Status Code"}),(0,m.jsx)(eO,{type:"number",placeholder:"200",value:e.requestConfig.retry.expectedStatusCode||"",onChange:r=>t({...e,requestConfig:{...e.requestConfig,retry:{...e.requestConfig.retry,expectedStatusCode:Number.parseInt(r.target.value)||200}}}),className:"h-8 text-xs"})]})]})]})]})]})}let de=()=>({url:"",method:"GET",headers:[],contentType:"application/json",body:"",responseJsonPath:"",retry:{enabled:!1,maxRetries:3,conditionType:"jsonField"}}),dt=(e="")=>({type:"fixed",fixedValue:e,requestConfig:de()}),dr=(e,t="")=>{if(!e)return dt(t);let r=de(),s={...r,...e.requestConfig||{},retry:{...r.retry,...e.requestConfig?.retry||{}}};return"fixed"===e.type?{type:"fixed",fixedValue:e.fixedValue??t,requestConfig:s}:{type:"request",requestConfig:s}};function ds({config:e,onChange:t,onPickSelector:r,isPicking:s}){let a="urlMatches"!==e.waitFor&&"time"!==e.waitFor,n=["textContains"].includes(e.waitFor),l=["attributeEquals"].includes(e.waitFor),o="time"!==e.waitFor;return(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Wait For"}),(0,m.jsxs)(nd,{value:e.waitFor,onValueChange:r=>t({...e,waitFor:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"time",children:"Time (delay)"}),(0,m.jsx)(np,{value:"selectorAppears",children:"Selector Appears"}),(0,m.jsx)(np,{value:"selectorVisible",children:"Selector Visible"}),(0,m.jsx)(np,{value:"selectorHidden",children:"Selector Hidden"}),(0,m.jsx)(np,{value:"selectorDisappears",children:"Selector Disappears"}),(0,m.jsx)(np,{value:"textContains",children:"Text Contains"}),(0,m.jsx)(np,{value:"attributeEquals",children:"Attribute Equals"}),(0,m.jsx)(np,{value:"elementEnabled",children:"Element Enabled"}),(0,m.jsx)(np,{value:"urlMatches",children:"URL Matches"})]})]})]}),"time"===e.waitFor&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Time (ms)"}),(0,m.jsx)(eO,{type:"number",placeholder:"1000",value:e.timeMs||1e3,onChange:r=>t({...e,timeMs:Number.parseInt(r.target.value)||1e3}),className:"h-8 text-xs"}),(0,m.jsx)("p",{className:"text-[9px] text-muted-foreground",children:"Wait for a fixed amount of time before proceeding"})]}),a&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"CSS Selector"}),(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"#element or .class",value:e.selector||"",onChange:r=>t({...e,selector:r.target.value}),className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"outline",size:"icon",className:"h-8 w-8 bg-transparent",onClick:r,disabled:s,children:s?(0,m.jsx)(ny,{className:"h-3.5 w-3.5 animate-spin"}):(0,m.jsx)(nb,{className:"h-3.5 w-3.5"})})]})]}),n&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Text to Match"}),(0,m.jsx)(eO,{placeholder:"Expected text...",value:e.text||"",onChange:r=>t({...e,text:r.target.value}),className:"h-8 text-xs"})]}),l&&(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Attribute Name"}),(0,m.jsx)(eO,{placeholder:"data-loaded",value:e.attributeName||"",onChange:r=>t({...e,attributeName:r.target.value}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Attribute Value"}),(0,m.jsx)(eO,{placeholder:"true",value:e.attributeValue||"",onChange:r=>t({...e,attributeValue:r.target.value}),className:"h-8 text-xs"})]})]}),"urlMatches"===e.waitFor&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"URL Regex"}),(0,m.jsx)(eO,{placeholder:"/dashboard.*",value:e.urlRegex||"",onChange:r=>t({...e,urlRegex:r.target.value}),className:"h-8 text-xs font-mono"})]}),o&&(0,m.jsxs)("div",{className:"space-y-2 border-t border-border pt-2 mt-2",children:[(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Strategy"}),(0,m.jsxs)(nd,{value:e.strategy,onValueChange:r=>t({...e,strategy:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"observer",children:"MutationObserver"}),(0,m.jsx)(np,{value:"polling",children:"Polling"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Interval (ms)"}),(0,m.jsx)(eO,{type:"number",value:e.intervalMs,onChange:r=>t({...e,intervalMs:Number.parseInt(r.target.value)||250}),className:"h-8 text-xs"})]})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Stable for (ms)"}),(0,m.jsx)(eO,{type:"number",value:e.requireStableMs,onChange:r=>t({...e,requireStableMs:Number.parseInt(r.target.value)||0}),className:"h-8 text-xs"})]}),(0,m.jsx)("div",{className:"flex-1 flex items-end",children:(0,m.jsxs)("div",{className:"flex items-center gap-2 h-8",children:[(0,m.jsx)(lo,{checked:e.invert,onCheckedChange:r=>t({...e,invert:r}),className:"scale-75"}),(0,m.jsx)(n4,{className:"text-xs",children:"Invert condition"})]})})]})]}),(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"w-full h-7 text-xs gap-1.5 mt-2 bg-transparent",children:[(0,m.jsx)(ng,{className:"h-3 w-3"}),"Test Wait"]})]})}function da({config:e,onChange:t,onPickSelector:r,isPicking:s}){return(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"CSS Selector"}),(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"#element or .class",value:e.selector,onChange:r=>t({...e,selector:r.target.value}),className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"outline",size:"icon",className:"h-8 w-8 bg-transparent",onClick:r,disabled:s,children:s?(0,m.jsx)(ny,{className:"h-3.5 w-3.5 animate-spin"}):(0,m.jsx)(nb,{className:"h-3.5 w-3.5"})})]})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Extract What"}),(0,m.jsxs)(nd,{value:e.extractWhat,onValueChange:r=>t({...e,extractWhat:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"text",children:"innerText"}),(0,m.jsx)(np,{value:"textContent",children:"textContent"}),(0,m.jsx)(np,{value:"html",children:"innerHTML"}),(0,m.jsx)(np,{value:"value",children:"value"}),(0,m.jsx)(np,{value:"attribute",children:"attribute"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Multiple"}),(0,m.jsxs)(nd,{value:e.multiple,onValueChange:r=>t({...e,multiple:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"first",children:"First Match"}),(0,m.jsx)(np,{value:"all",children:"All Matches"})]})]})]})]}),"attribute"===e.extractWhat&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Attribute Name"}),(0,m.jsx)(eO,{placeholder:"href, data-id, src...",value:e.attributeName||"",onChange:r=>t({...e,attributeName:r.target.value}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Output Type"}),(0,m.jsxs)(nd,{value:e.outputType,onValueChange:r=>t({...e,outputType:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"auto",children:"Auto"}),(0,m.jsx)(np,{value:"string",children:"String"}),(0,m.jsx)(np,{value:"number",children:"Number"}),(0,m.jsx)(np,{value:"boolean",children:"Boolean"}),(0,m.jsx)(np,{value:"json",children:"JSON"})]})]})]}),"all"===e.multiple&&(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Join With"}),(0,m.jsx)(eO,{placeholder:"\\n",value:e.joinWith,onChange:r=>t({...e,joinWith:r.target.value}),className:"h-8 text-xs font-mono"})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Regex Filter (optional)"}),(0,m.jsx)(eO,{placeholder:"\\\\d+",value:e.regex||"",onChange:r=>t({...e,regex:r.target.value}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Default Value"}),(0,m.jsx)(eO,{placeholder:"fallback",value:e.defaultValue,onChange:r=>t({...e,defaultValue:r.target.value}),className:"h-8 text-xs"})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Save As (required)"}),(0,m.jsx)(eO,{placeholder:"vars.myValue",value:e.saveAs,onChange:r=>t({...e,saveAs:r.target.value}),className:"h-8 text-xs font-mono"})]})]}),(0,m.jsxs)("div",{className:"flex items-center gap-4",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(lo,{checked:e.trim,onCheckedChange:r=>t({...e,trim:r}),className:"scale-75"}),(0,m.jsx)(n4,{className:"text-xs",children:"Trim whitespace"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(lo,{checked:e.failIfEmpty,onCheckedChange:r=>t({...e,failIfEmpty:r}),className:"scale-75"}),(0,m.jsx)(n4,{className:"text-xs",children:"Fail if empty"})]})]}),(0,m.jsx)(c9,{config:e.serverUpload||{enabled:!1,url:"",method:"POST",headers:[],dataField:"data"},onChange:r=>t({...e,serverUpload:r}),label:"Upload to Server"}),(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"w-full h-7 text-xs gap-1.5 mt-2 bg-transparent",children:[(0,m.jsx)(ng,{className:"h-3 w-3"}),"Test Extract"]})]})}function dn({config:e,onChange:t,onPickSelector:r,isPicking:s,onCaptureNow:a,isCapturing:n}){return(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Capture Mode"}),(0,m.jsxs)(nd,{value:e.captureMode,onValueChange:r=>t({...e,captureMode:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"viewport",children:"Viewport"}),(0,m.jsx)(np,{value:"fullPage",children:"Full Page"}),(0,m.jsx)(np,{value:"element",children:"Element"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Format"}),(0,m.jsxs)(nd,{value:e.format,onValueChange:r=>t({...e,format:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"png",children:"PNG"}),(0,m.jsx)(np,{value:"jpeg",children:"JPEG"})]})]})]})]}),"element"===e.captureMode&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Element Selector"}),(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"#element or .class",value:e.selector||"",onChange:r=>t({...e,selector:r.target.value}),className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"outline",size:"icon",className:"h-8 w-8 bg-transparent",onClick:r,disabled:s,children:s?(0,m.jsx)(ny,{className:"h-3.5 w-3.5 animate-spin"}):(0,m.jsx)(nb,{className:"h-3.5 w-3.5"})})]})]}),"jpeg"===e.format&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)(n4,{className:"text-xs",children:["Quality (",e.quality,"%)"]}),(0,m.jsx)("input",{type:"range",min:"10",max:"100",value:e.quality,onChange:r=>t({...e,quality:Number.parseInt(r.target.value)}),className:"w-full h-2"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"File Name Template"}),(0,m.jsx)(eO,{placeholder:"{{workflow}}_{{step}}_{{timestamp}}",value:e.fileNameTemplate,onChange:r=>t({...e,fileNameTemplate:r.target.value}),className:"h-8 text-xs font-mono"}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Placeholders: ","{{workflow}}",", ","{{step}}",", ","{{timestamp}}",", ","{{date}}"]})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Save To"}),(0,m.jsxs)(nd,{value:e.saveTo,onValueChange:r=>t({...e,saveTo:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"downloads",children:"Downloads"}),(0,m.jsx)(np,{value:"varsBase64",children:"Variable (Base64)"}),(0,m.jsx)(np,{value:"runnerArtifacts",children:"Runner Artifacts"})]})]})]}),"varsBase64"===e.saveTo&&(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Variable Name"}),(0,m.jsx)(eO,{placeholder:"vars.screenshot",value:e.saveAs||"",onChange:r=>t({...e,saveAs:r.target.value}),className:"h-8 text-xs font-mono"})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Max Width (0 = no limit)"}),(0,m.jsx)(eO,{type:"number",value:e.maxWidth,onChange:r=>t({...e,maxWidth:Number.parseInt(r.target.value)||0}),className:"h-8 text-xs"})]}),(0,m.jsx)(c9,{config:e.serverUpload||{enabled:!1,url:"",method:"POST",headers:[],dataField:"screenshot"},onChange:r=>t({...e,serverUpload:r}),label:"Upload to Server"}),(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"w-full h-7 text-xs gap-1.5 mt-2 bg-transparent",onClick:a,disabled:n,children:[n?(0,m.jsx)(ny,{className:"h-3 w-3 animate-spin"}):(0,m.jsx)(cX,{className:"h-3 w-3"}),n?"Capturing...":"Capture Now"]})]})}function dl({config:e,onChange:t,onPickSelector:r,isPicking:s}){return(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Scroll Type"}),(0,m.jsxs)(nd,{value:e.scrollType,onValueChange:r=>t({...e,scrollType:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"toSelector",children:"To Selector (CSS)"}),(0,m.jsx)(np,{value:"intoView",children:"Into View (scrollIntoView)"}),(0,m.jsx)(np,{value:"toPosition",children:"To Position (scrollTo)"}),(0,m.jsx)(np,{value:"byAmount",children:"By Amount (scrollBy)"})]})]})]}),("toSelector"===e.scrollType||"intoView"===e.scrollType)&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"CSS Selector"}),(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"#element or .class",value:e.selector||"",onChange:r=>t({...e,selector:r.target.value}),className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"outline",size:"icon",className:"h-8 w-8 bg-transparent",onClick:r,disabled:s,children:s?(0,m.jsx)(ny,{className:"h-3.5 w-3.5 animate-spin"}):(0,m.jsx)(nb,{className:"h-3.5 w-3.5"})})]})]}),("toPosition"===e.scrollType||"byAmount"===e.scrollType)&&(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"X"}),(0,m.jsx)(eO,{type:"number",value:e.x||0,onChange:r=>t({...e,x:Number.parseInt(r.target.value)||0}),className:"h-8 text-xs"})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Y"}),(0,m.jsx)(eO,{type:"number",value:e.y||0,onChange:r=>t({...e,y:Number.parseInt(r.target.value)||0}),className:"h-8 text-xs"})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Behavior"}),(0,m.jsxs)(nd,{value:e.behavior,onValueChange:r=>t({...e,behavior:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"smooth",children:"Smooth"}),(0,m.jsx)(np,{value:"instant",children:"Instant"}),(0,m.jsx)(np,{value:"auto",children:"Auto"})]})]})]}),"intoView"===e.scrollType&&(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Block"}),(0,m.jsxs)(nd,{value:e.block||"center",onValueChange:r=>t({...e,block:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"start",children:"Start"}),(0,m.jsx)(np,{value:"center",children:"Center"}),(0,m.jsx)(np,{value:"end",children:"End"}),(0,m.jsx)(np,{value:"nearest",children:"Nearest"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Inline"}),(0,m.jsxs)(nd,{value:e.inline||"nearest",onValueChange:r=>t({...e,inline:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"start",children:"Start"}),(0,m.jsx)(np,{value:"center",children:"Center"}),(0,m.jsx)(np,{value:"end",children:"End"}),(0,m.jsx)(np,{value:"nearest",children:"Nearest"})]})]})]})]})]})}function di({config:e,onChange:t,variables:r}){let[s,a]=(0,h.useState)(null),[n,l]=(0,h.useState)(!1),o={vars:r||{},timestamp:Math.floor(Date.now()/1e3),timestampMs:Date.now()},i=async e=>{if("specificTab"===e.target){let t=Number((0,cW.applyRequestTemplate)(e.specificTabId||"",o).trim());if(!Number.isFinite(t))throw Error("Invalid tab id for specific tab");return t}if("anyTabMatchingScope"===e.target){let t=(e.scopeUrlRegex||"").trim();if(!t)throw Error("Scope regex is required for tab matching");let r=await c4({type:"tabs.query",scopeUrlRegex:t}),s=(r?.tabs||[]).find(e=>e?.url&&new RegExp(t).test(e.url));if(!s?.id)throw Error("No tab matches the provided scope regex");return s.id}},c=async()=>{l(!0),a(null);try{let t={...r_.defaultEvaluateConfig,...e,code:(0,cW.applyRequestTemplate)(e.code||"",o),args:"expression"===e.mode?[]:(e.args||[]).map(e=>({...e,value:(0,cW.applyRequestTemplate)(e.value??"",o)}))},s="expression"===t.mode?[]:(t.args||[]).map((e,t)=>({...e,resolvedValue:(()=>{switch(e.type){case"number":return Number(e.value??"");case"boolean":{let t=String(e.value??"").trim().toLowerCase();if(["true","1","yes","on"].includes(t))return!0;if(["false","0","no","off",""].includes(t))return!1;return!!e.value}case"json":try{return JSON.parse(e.value||"null")}catch{return e.value}default:return e.value??""}})()})),n=await i(t),l=await c4({type:"tabs.sendMessage",tabId:n,message:{type:"automation:run:step",step:{type:"evaluate",config:{...t,args:s},evaluateConfig:{...t,args:s},vars:r||{}}}}),c=l?.res??l,d=c?.ok,u=c?.result,x=c?.error;if(!d)throw Error(x||"Evaluation failed");a(JSON.stringify({ok:!0,result:u},null,2))}catch(e){a(JSON.stringify({ok:!1,error:e?.message||String(e)},null,2))}finally{l(!1)}};return(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)(cO,{defaultValue:"code",className:"w-full",children:[(0,m.jsxs)(cq,{className:"h-7 w-full",children:[(0,m.jsx)(cz,{value:"code",className:"text-xs flex-1",children:"Code"}),"function"===e.mode&&(0,m.jsx)(cz,{value:"output",className:"text-xs flex-1",children:"Output"})]}),(0,m.jsxs)(cF,{value:"code",className:"space-y-2 mt-2",children:[(0,m.jsx)("div",{className:"flex gap-2",children:(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Mode"}),(0,m.jsxs)(nd,{value:e.mode,onValueChange:r=>t({...e,mode:r,args:"expression"===r?[]:e.args,code:"function"===r?e.code?.trim()?e.code:"async function main() {\n  // return value to save\n}\n":e.code}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"expression",children:"Expression"}),(0,m.jsx)(np,{value:"function",children:"Function"})]})]})]})}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Code"}),(0,m.jsx)(eq,{value:e.code,onChange:r=>t({...e,code:r.target.value}),className:"h-24 text-xs font-mono",placeholder:"expression"===e.mode?"document.title\n// you can also use {{vars.token}}":"async function main(arg1) {\n  return { ok: true, value: {{vars.result}} }\n}"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Arguments"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-[10px]",disabled:"expression"===e.mode,onClick:()=>t({...e,args:[...e.args,{name:"",type:"string",value:""}]}),children:[(0,m.jsx)(rI,{className:"h-3 w-3 mr-0.5"}),"Add"]})]}),e.args.map((r,s)=>(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"name",value:r.name,onChange:r=>{let a=[...e.args];a[s]={...a[s],name:r.target.value},t({...e,args:a})},className:"h-7 text-xs w-20",disabled:"expression"===e.mode}),(0,m.jsxs)(nd,{value:r.type,onValueChange:r=>{let a=[...e.args];a[s]={...a[s],type:r},t({...e,args:a})},disabled:"expression"===e.mode,children:[(0,m.jsx)(nx,{className:"h-7 text-xs w-20",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"string",children:"string"}),(0,m.jsx)(np,{value:"number",children:"number"}),(0,m.jsx)(np,{value:"boolean",children:"boolean"}),(0,m.jsx)(np,{value:"json",children:"json"})]})]}),(0,m.jsx)(eO,{placeholder:"value",value:r.value,onChange:r=>{let a=[...e.args];a[s]={...a[s],value:r.target.value},t({...e,args:a})},className:"h-7 text-xs flex-1",title:"Supports {{vars.*}} placeholders",placeholder:"value or {{vars.result}}",disabled:"expression"===e.mode}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>t({...e,args:e.args.filter((e,t)=>t!==s)}),disabled:"expression"===e.mode,children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},s)),"expression"===e.mode&&(0,m.jsxs)("p",{className:"text-[10px] text-muted-foreground",children:["Arguments are disabled in expression mode. Use variables directly in the expression (e.g. ","{{vars.result}}",")"]})]})]}),(0,m.jsxs)(cF,{value:"context",className:"space-y-2 mt-2",children:[(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Run In"}),(0,m.jsxs)(nd,{value:e.runIn,onValueChange:r=>t({...e,runIn:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"page",children:"Page Context"}),(0,m.jsx)(np,{value:"background",children:"Background"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Target"}),(0,m.jsxs)(nd,{value:e.target,onValueChange:r=>t({...e,target:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"currentTab",children:"Current Tab"}),(0,m.jsx)(np,{value:"specificTab",children:"Specific Tab"}),(0,m.jsx)(np,{value:"anyTabMatchingScope",children:"Any Matching Scope"})]})]})]})]}),"specificTab"===e.target&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Tab ID"}),(0,m.jsx)(eO,{className:"h-8 text-xs font-mono",placeholder:"e.g. 123 or {{vars.tabId}}",value:e.specificTabId||"",onChange:r=>t({...e,specificTabId:r.target.value})}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"Uses this tabId instead of the current tab."})]}),"anyTabMatchingScope"===e.target&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Scope URL Regex"}),(0,m.jsx)(eO,{className:"h-8 text-xs font-mono",placeholder:".*example\\\\.com.*",value:e.scopeUrlRegex||"",onChange:r=>t({...e,scopeUrlRegex:r.target.value})}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"First tab whose URL matches will be used."})]})]}),"function"===e.mode&&(0,m.jsxs)(cF,{value:"output",className:"space-y-2 mt-2",children:[(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Expect Type"}),(0,m.jsxs)(nd,{value:e.expect,onValueChange:r=>t({...e,expect:r}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"any",children:"Any"}),(0,m.jsx)(np,{value:"string",children:"String"}),(0,m.jsx)(np,{value:"number",children:"Number"}),(0,m.jsx)(np,{value:"boolean",children:"Boolean"}),(0,m.jsx)(np,{value:"object",children:"Object"}),(0,m.jsx)(np,{value:"array",children:"Array"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Save As"}),(0,m.jsx)(eO,{placeholder:"vars.result",value:e.saveAs,onChange:r=>t({...e,saveAs:r.target.value}),className:"h-8 text-xs font-mono"})]})]}),(0,m.jsxs)("div",{className:"flex items-center gap-4",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(lo,{checked:e.saveOnlyIfOk,onCheckedChange:r=>t({...e,saveOnlyIfOk:r}),className:"scale-75"}),(0,m.jsx)(n4,{className:"text-xs",children:"Save only if OK"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(lo,{checked:e.failOnFalsy,onCheckedChange:r=>t({...e,failOnFalsy:r}),className:"scale-75"}),(0,m.jsx)(n4,{className:"text-xs",children:"Fail on falsy"})]})]})]})]}),(0,m.jsxs)("div",{className:"border-t border-border pt-2",children:[(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"w-full h-7 text-xs gap-1.5 bg-transparent",onClick:c,disabled:n,children:[(0,m.jsx)(ng,{className:`h-3 w-3 ${n?"animate-spin":""}`}),n?"Testing...":"Test / Preview"]}),s&&(0,m.jsx)("div",{className:"mt-2 p-2 rounded bg-secondary/50 border border-border",children:(0,m.jsx)("pre",{className:"text-[10px] font-mono text-muted-foreground overflow-x-auto",children:s})})]})]})}function dc({step:e,index:t,workflowId:r,indentLevel:s=0,blockId:a,branch:n,onEdit:l,dragHandlers:o,isLocked:i}){let{updateStep:c,deleteStep:d,updateStepInBlock:u,deleteStepFromBlock:x}=(0,f.useAutomation)(),p=(e,t=10)=>e.length<=t?e:e.slice(0,t-3)+"...",h=(e=>{switch(e){case"click":default:return cB;case"type":return cH;case"wait":return iv;case"extract":return cK;case"select":return ni;case"evaluate":return cG;case"scroll":return cJ;case"screenshot":return cX;case"goTo":return c3;case"sendCookies":return cZ;case"sendPageSource":return cQ;case"request":return cY}})(e.type),g=e.selector?p(e.selector,20):null,v=e.goToUrl?p(e.goToUrl,26):null;return(0,m.jsxs)("div",{draggable:!!o&&!i,onDragStart:()=>!i&&o?.onDragStart(t),onDragOver:e=>!i&&o?.onDragOver(e,t),onDrop:()=>!i&&o?.onDrop(t),onDragEnd:()=>!i&&o?.onDragEnd(),style:{marginLeft:16*s},className:`flex items-center gap-2 p-2 rounded-md border transition-all ${o?.isDragging?"opacity-50 border-primary bg-primary/10":o?.isDragOver?"border-dashed border-primary bg-primary/5":"border-border bg-card hover:bg-secondary/50"} ${!e.enabled?"opacity-50":""} ${o?"cursor-move":""}`,children:[o&&(0,m.jsx)(c0,{className:"h-3.5 w-3.5 text-muted-foreground flex-shrink-0 cursor-grab active:cursor-grabbing"}),(0,m.jsx)("div",{className:"p-1.5 rounded bg-primary/15 text-primary",children:(0,m.jsx)(h,{className:"h-3.5 w-3.5"})}),(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsx)("div",{className:"flex items-center gap-1.5",children:(0,m.jsx)("span",{className:"text-xs font-medium truncate",children:e.name})}),g&&(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground font-mono truncate",title:e.selector,children:g}),!g&&v&&(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground font-mono truncate",title:e.goToUrl,children:v})]}),(0,m.jsxs)("div",{className:"flex items-center gap-1",children:[(0,m.jsx)(lo,{checked:e.enabled,onCheckedChange:t=>{i||(a&&n?u(r,a,n,e.id,{enabled:t}):c(r,e.id,{enabled:t}))},className:"scale-75",disabled:i}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>l(e,a&&n?{blockId:a,branch:n}:void 0),disabled:i,children:(0,m.jsx)(c$,{className:"h-3 w-3"})}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive",onClick:()=>{i||(a&&n?x(r,a,n,e.id):d(r,e.id))},disabled:i,children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]})]})}function dd({block:e,index:t,workflowId:r,onEdit:s,onAddStepToBlock:a,dragHandlers:n,isLocked:l}){let{updateStep:o,deleteStep:i}=(0,f.useAutomation)(),[c,d]=(0,h.useState)(!0),u=n?.isDragging??!1,x=n?.isDragOver??!1;return(0,m.jsx)("div",{draggable:!l&&!!n,onDragStart:()=>!l&&n?.onDragStart(t),onDragOver:e=>!l&&n?.onDragOver(e,t),onDrop:()=>!l&&n?.onDrop(t),onDragEnd:()=>!l&&n?.onDragEnd(),className:`rounded-lg border transition-all ${u?"opacity-50 border-primary bg-primary/10":x?"border-dashed border-primary bg-primary/5":"border-amber-500/30 bg-amber-500/5"} ${!e.enabled?"opacity-50":""}`,children:(0,m.jsxs)(c_,{open:c,onOpenChange:d,children:[(0,m.jsx)(cU,{asChild:!0,children:(0,m.jsxs)("div",{className:"flex items-center gap-2 p-2 cursor-pointer hover:bg-amber-500/10 rounded-t-lg",children:[(0,m.jsx)(c0,{className:"h-3.5 w-3.5 text-muted-foreground flex-shrink-0 cursor-grab active:cursor-grabbing"}),(0,m.jsx)("div",{className:"p-1.5 rounded bg-amber-500/15 text-amber-500",children:(0,m.jsx)(c1,{className:"h-3.5 w-3.5"})}),(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,m.jsx)("span",{className:"text-xs font-medium truncate",children:e.name}),(0,m.jsx)(lc,{variant:"outline",className:"text-[9px] px-1 py-0 bg-amber-500/10 text-amber-500 border-amber-500/30",children:"IF/ELSE"})]}),(0,m.jsxs)("p",{className:"text-[10px] text-muted-foreground font-mono truncate",children:[e.condition.type,": ",e.condition.selector||e.condition.variable||e.condition.value]})]}),(0,m.jsxs)("div",{className:"flex items-center gap-1",children:[(0,m.jsx)(rO,{className:`h-4 w-4 text-muted-foreground transition-transform ${c?"rotate-90":""}`}),(0,m.jsx)(lo,{checked:e.enabled,onCheckedChange:t=>!l&&o(r,e.id,{enabled:t}),className:"scale-75",disabled:l,onClick:e=>e.stopPropagation()}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive",onClick:t=>{t.stopPropagation(),i(r,e.id)},disabled:l,children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]})]})}),(0,m.jsx)(cV,{children:(0,m.jsxs)("div",{className:"px-2 pb-2 space-y-2",children:[(0,m.jsxs)("div",{className:"ml-4 border-l-2 border-green-500/30 pl-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,m.jsx)("span",{className:"text-[10px] font-medium text-green-500 uppercase",children:"IF (true)"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-[10px] text-green-500 hover:text-green-400",onClick:()=>a(e.id,"if"),disabled:l,children:[(0,m.jsx)(c8,{className:"h-3 w-3 mr-0.5"}),"Add Step"]})]}),(0,m.jsx)("div",{className:"space-y-1",children:0===e.ifSteps.length?(0,m.jsx)("div",{className:"p-2 text-[10px] text-muted-foreground text-center border border-dashed border-border rounded",children:"No steps in IF branch"}):e.ifSteps.map((t,a)=>(0,m.jsx)(dc,{step:t,index:a,workflowId:r,blockId:e.id,branch:"if",onEdit:(t,r)=>s(t,{blockId:e.id,branch:"if"}),isLocked:l},t.id))})]}),(0,m.jsxs)("div",{className:"ml-4 border-l-2 border-red-500/30 pl-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,m.jsx)("span",{className:"text-[10px] font-medium text-red-500 uppercase",children:"ELSE (false)"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-[10px] text-red-500 hover:text-red-400",onClick:()=>a(e.id,"else"),disabled:l,children:[(0,m.jsx)(c8,{className:"h-3 w-3 mr-0.5"}),"Add Step"]})]}),(0,m.jsx)("div",{className:"space-y-1",children:0===e.elseSteps.length?(0,m.jsx)("div",{className:"p-2 text-[10px] text-muted-foreground text-center border border-dashed border-border rounded",children:"No steps in ELSE branch"}):e.elseSteps.map((t,a)=>(0,m.jsx)(dc,{step:t,index:a,workflowId:r,blockId:e.id,branch:"else",onEdit:(t,r)=>s(t,{blockId:e.id,branch:"else"}),isLocked:l},t.id))})]})]})})]})})}function du({workflowId:e,initialSelector:t,onSelectorConsumed:r}){let s,a,{getWorkflow:n,addStep:l,updateStep:o,updateStepInBlock:i,deleteStep:c,reorderSteps:d,addStepToBlock:u,setVariable:x,deleteVariable:p,isPicking:g,setIsPicking:v,setPickedSelector:b,setOnPickComplete:y}=(0,f.useAutomation)(),j=n(e),w=j?.steps||[],N=j?.variables||{},k=!!j&&"paused"!==j.status,[C,S]=(0,h.useState)(!1),[E,T]=(0,h.useState)(!1),[R,M]=(0,h.useState)(!1),[D,P]=(0,h.useState)(null),[A,I]=(0,h.useState)(null),[L,O]=(0,h.useState)(null),[q,z]=(0,h.useState)("click"),[F,_]=(0,h.useState)(""),[U,V]=(0,h.useState)(""),[W,$]=(0,h.useState)(""),[B,H]=(0,h.useState)("single"),[K,G]=(0,h.useState)(5e3),[J,X]=(0,h.useState)(1),[Y,Z]=(0,h.useState)("stop"),[Q,ee]=(0,h.useState)(""),[et,er]=(0,h.useState)(""),[es,ea]=(0,h.useState)(()=>dt()),[en,el]=(0,h.useState)(""),[eo,ei]=(0,h.useState)("GET"),[ec,ed]=(0,h.useState)([]),[eu,ex]=(0,h.useState)("application/json"),[em,ep]=(0,h.useState)(!0),[eh,ef]=(0,h.useState)(""),[eg,ev]=(0,h.useState)([""]),[eb,ey]=(0,h.useState)(""),[ej,ew]=(0,h.useState)(""),[eN,ek]=(0,h.useState)(""),[eC,eS]=(0,h.useState)({scrollType:"toSelector",behavior:"smooth"}),[eE,eT]=(0,h.useState)({...r_.defaultEvaluateConfig}),[eR,eM]=(0,h.useState)({...r_.defaultWaitConfig}),[eD,eP]=(0,h.useState)({...r_.defaultExtractConfig}),[eA,eI]=(0,h.useState)({...r_.defaultScreenshotConfig}),[ez,eF]=(0,h.useState)(!1),[e_,eU]=(0,h.useState)("selectorExists"),[eV,eW]=(0,h.useState)(""),[e$,eB]=(0,h.useState)(""),[eH,eK]=(0,h.useState)(""),[eG,eJ]=(0,h.useState)(""),[eX,eY]=(0,h.useState)(""),[eZ,eQ]=(0,h.useState)(""),[e0,e1]=(0,h.useState)(""),[e2,e5]=(0,h.useState)(""),[e3,e8]=(0,h.useState)(""),[e4,e6]=(0,h.useState)(!1),[e9,e7]=(0,h.useState)(""),[te,tt]=(0,h.useState)(""),[tr,ts]=(0,h.useState)(null),[ta,tn]=(0,h.useState)(null);(0,h.useEffect)(()=>{t&&!k&&(V(t),S(!0),r&&r())},[t,r,k]),(0,h.useEffect)(()=>{k&&(S(!1),T(!1),M(!1),O(null),P(null),I(null),ts(null),tn(null))},[k]),(0,h.useEffect)(()=>{("sendCookies"===q||"sendPageSource"===q)&&("GET"===eo||"DELETE"===eo)&&ei("POST")},[eo,q]);let tl=()=>{z("click"),_(""),V(""),$(""),H("single"),G(5e3),X(1),Z("stop"),ee(""),er(""),ea(dt()),el(""),ei("GET"),ed([]),ex("application/json"),ep(!0),ef(""),ev([""]),ey(""),ew(""),ek(""),eS({scrollType:"toSelector",behavior:"smooth"}),eT({...r_.defaultEvaluateConfig}),eM({...r_.defaultWaitConfig}),eP({...r_.defaultExtractConfig}),eI({...r_.defaultScreenshotConfig}),O(null)},to=(e,t)=>{if(k)return;let r=e;if("type"===e.type||"select"===e.type){let t=dr(e.valueSource,e.value??"");r={...e,valueSource:t,value:"fixed"===t.type?t.fixedValue??"":void 0}}P(r),I(t??null),M(!0)},ti=(0,h.useCallback)(()=>{v(!1),b(null),y(null)},[v,y,b]),tc=(0,h.useCallback)(e=>{if(k)return;let t=e??(e=>V(e));g?ti():(b(null),y(()=>e=>{t(e)}),v(!0))},[ti,g,v,V,y,b,k]),td=(e,t)=>{k||(O({blockId:e,branch:t}),S(!0))},tu=e=>{k||ts(e)},tx=(e,t)=>{k||(e.preventDefault(),tn(t))},tm=t=>{k||(null!==tr&&tr!==t&&d(e,tr,t),ts(null),tn(null))},tp=()=>{k||(ts(null),tn(null))},th=(0,h.useCallback)((t,r)=>{let s=n(e),a=Date.now(),l={workflow:s?.name,workflowName:s?.name,workflowId:s?.id,step:"screenshot",stepName:"Screenshot",date:new Date(a).toISOString().slice(0,10),timestamp:Math.floor(a/1e3),timestampMs:a},o=(0,cW.applyRequestTemplate)(t||"",l).trim(),i=`screenshot_${l.timestamp}`,c=(o||i).replace(/[\\/:*?"<>|]+/g,"_").replace(/\s+/g,"_").replace(/\.+$/,""),d="jpeg"===r?"jpg":"png";return c.toLowerCase().endsWith(`.${d}`)?c:`${c}.${d}`},[n,e]),tf=(0,h.useCallback)(async(e,t)=>{eF(!0);try{let r={...r_.defaultScreenshotConfig,...e,selector:e.selector||t||e.selector},s=th(r.fileNameTemplate,r.format),a={type:"screenshot",config:r,screenshotConfig:r,selector:r.selector},n=await c4({type:"tabs.sendMessage",message:{type:"automation:run:step",step:a}}),l=n?.res??n;if(!l?.ok||!l.dataUrl)throw Error(l?.error||"Capture failed");await c4({type:"download.dataUrl",dataUrl:l.dataUrl,fileName:s})}catch(e){console.error("Screenshot capture failed",e)}finally{eF(!1)}},[th]),tg=["selectorExists","selectorNotExists","elementVisible","elementHidden","elementEnabled","elementDisabled","textContains","textEquals","textNotContains","attributeEquals","attributeContains"].includes(e_),tv=["textContains","textEquals","textNotContains","urlMatches","urlEquals","variableEquals","variableNotEquals","variableGreater","variableLess","attributeEquals","attributeContains"].includes(e_),tb=["variableEquals","variableNotEquals","variableGreater","variableLess","variableEmpty","variableNotEmpty"].includes(e_),ty=["attributeEquals","attributeContains"].includes(e_);return["regexMatches"].includes(e_),(0,m.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,m.jsxs)("div",{className:"p-3 border-b border-border flex items-center justify-between bg-card/30 shrink-0",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsxs)("span",{className:"text-xs font-medium",children:[w.length," Steps"]}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:()=>e6(!e4),children:[(0,m.jsx)(c5,{className:"h-3 w-3"}),Object.keys(N).length," Vars"]})]}),(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1 px-2 bg-transparent",onClick:()=>S(!0),disabled:k,children:[(0,m.jsx)(rI,{className:"h-3 w-3"}),"Add Step"]}),(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1 px-2 bg-amber-500/10 border-amber-500/30 text-amber-500 hover:bg-amber-500/20",onClick:()=>T(!0),disabled:k,children:[(0,m.jsx)(c1,{className:"h-3 w-3"}),"Add IF/ELSE"]})]})]}),k&&(0,m.jsx)("div",{className:"mx-3 mb-2 p-2 rounded border border-amber-500/30 bg-amber-500/10 text-amber-900 text-[11px]",children:"Trigger is ON. Set it to OFF in the header to edit, create, or reorder steps."}),e4&&(0,m.jsxs)("div",{className:"p-2 border-b border-border bg-secondary/30 shrink-0",children:[(0,m.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,m.jsxs)("span",{className:"text-xs font-medium flex items-center gap-1.5",children:[(0,m.jsx)(c2,{className:"h-3.5 w-3.5"}),"Variables"]})}),(0,m.jsx)("div",{className:"space-y-1.5 max-h-32 overflow-y-auto",children:Object.entries(N).map(([t,r])=>(0,m.jsxs)("div",{className:"flex items-center gap-1.5 p-1.5 rounded bg-card border border-border",children:[(0,m.jsx)("code",{className:"text-[10px] font-mono text-primary flex-1 truncate",children:`{{vars.${t}}}`}),(0,m.jsx)("span",{className:"text-[10px] text-muted-foreground truncate max-w-20",children:r}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-5 w-5 text-destructive",onClick:()=>p(e,t),children:(0,m.jsx)(ih,{className:"h-2.5 w-2.5"})})]},t))}),(0,m.jsxs)("div",{className:"flex gap-1 mt-2",children:[(0,m.jsx)(eO,{placeholder:"key",value:e9,onChange:e=>e7(e.target.value),className:"h-7 text-xs flex-1"}),(0,m.jsx)(eO,{placeholder:"value",value:te,onChange:e=>tt(e.target.value),className:"h-7 text-xs flex-1"}),(0,m.jsx)(eL,{size:"sm",className:"h-7 px-2",onClick:()=>{e9.trim()&&te.trim()&&(x(e,e9.trim(),te.trim()),e7(""),tt(""))},children:(0,m.jsx)(rI,{className:"h-3 w-3"})})]})]}),(0,m.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,m.jsx)(lW,{className:"h-full",children:(0,m.jsx)("div",{className:"p-3 space-y-2",children:0===w.length?(0,m.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,m.jsx)(nS,{className:"h-8 w-8 text-muted-foreground mb-2"}),(0,m.jsx)("p",{className:"text-xs text-muted-foreground",children:"No steps yet. Add your first step!"})]}):w.map((t,r)=>{let s="if-else"===t.type,a=tr===r,n=ta===r;return s?(0,m.jsx)(dd,{block:t,index:r,workflowId:e,onEdit:to,onAddStepToBlock:td,dragHandlers:k?void 0:{onDragStart:tu,onDragOver:tx,onDrop:tm,onDragEnd:tp,isDragging:a,isDragOver:n},isLocked:k},t.id):(0,m.jsx)(dc,{step:t,index:r,workflowId:e,onEdit:to,dragHandlers:k?void 0:{onDragStart:tu,onDragOver:tx,onDrop:tm,onDragEnd:tp,isDragging:a,isDragOver:n},isLocked:k},t.id)})})})}),(0,m.jsx)(c6,{open:C,onClose:()=>{S(!1),tl()},title:L?`Add Step to ${L.branch.toUpperCase()} Branch`:"Add Step",footer:(0,m.jsx)(eL,{className:"w-full h-8 text-xs",onClick:()=>{if(k)return;let t="step-"+Date.now(),r="goTo"===q?"Go To":q.charAt(0).toUpperCase()+q.slice(1)+" Step",s={id:t,type:q,name:F||r,enabled:!0,selector:U||void 0,clickMode:"click"===q?B:void 0,timeout:K,retries:J,onFailure:Y,gotoStep:"goto"===Y&&Q||void 0,fallbackCode:"fallback"===Y&&et||void 0};if("goTo"===q&&(s.goToUrl=W.trim()),("type"===q||"select"===q)&&(s.valueSource=es,"fixed"===es.type&&(s.value=es.fixedValue)),eN.trim()&&(s.saveTo=eN.trim()),"request"===q&&(s.serverUrl=en,s.requestMethod=eo,s.headers=ec,s.requestContentType="none"===eu?void 0:eu,s.requestBody=eb,s.responseJsonPath=ej),"sendCookies"===q)if(s.serverUrl=en,s.requestMethod=eo,s.headers=ec,s.cookieAll=em,em)s.cookieDomain=void 0,s.cookieNames=void 0;else{let e=eh.trim(),t=eg.map(e=>e.trim()).filter(Boolean);e&&(s.cookieDomain=e),t.length&&(s.cookieNames=t)}"sendPageSource"===q&&(s.serverUrl=en,s.requestMethod="PUT"===eo?"PUT":"POST",s.headers=ec),"scroll"===q&&(s.scrollConfig=eC),"evaluate"===q&&(s.evaluateConfig=eE),"wait"===q&&(s.waitConfig=eR),"extract"===q&&(s.extractConfig=eD),"screenshot"===q&&(s.screenshotConfig=eA),L?u(e,L.blockId,L.branch,s):l(e,s),S(!1),tl()},disabled:k,children:"Create Step"}),children:(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Step Type"}),(0,m.jsx)("div",{className:"grid grid-cols-5 gap-1.5",children:[{type:"click",icon:cB,label:"Click"},{type:"type",icon:cH,label:"Type"},{type:"wait",icon:iv,label:"Wait"},{type:"extract",icon:cK,label:"Extract"},{type:"select",icon:ni,label:"Select"},{type:"evaluate",icon:cG,label:"Evaluate"},{type:"scroll",icon:cJ,label:"Scroll"},{type:"screenshot",icon:cX,label:"Screenshot"},{type:"goTo",icon:c3,label:"Go To"},{type:"request",icon:cY,label:"Request"},{type:"sendCookies",icon:cZ,label:"Cookies"},{type:"sendPageSource",icon:cQ,label:"Page Source"}].map(({type:e,icon:t,label:r})=>(0,m.jsxs)(eL,{variant:q===e?"default":"outline",size:"sm",className:"h-10 flex-col gap-0.5 text-[9px] px-1",onClick:()=>z(e),children:[(0,m.jsx)(t,{className:"h-3.5 w-3.5"}),r]},e))})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Step Name"}),(0,m.jsx)(eO,{placeholder:"Enter step name...",value:F,onChange:e=>_(e.target.value),className:"h-8 text-xs"})]}),["click","type","select"].includes(q)&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"CSS Selector"}),(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"#element or .class",value:U,onChange:e=>V(e.target.value),className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"outline",size:"icon",className:"h-8 w-8 bg-transparent",onClick:()=>tc(),disabled:g,children:g?(0,m.jsx)(ny,{className:"h-3.5 w-3.5 animate-spin"}):(0,m.jsx)(nb,{className:"h-3.5 w-3.5"})})]})]}),"goTo"===q&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Target URL"}),(0,m.jsx)(eO,{placeholder:"https://example.com/page",value:W,onChange:e=>$(e.target.value),className:"h-8 text-xs font-mono"}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Templates are supported (","{{vars.*}}",", ","{{timestamp}}",", ","{{url}}",")."]})]}),"click"===q&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Click Mode"}),(0,m.jsxs)(nd,{value:B,onValueChange:e=>H(e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"single",children:"Single click"}),(0,m.jsx)(np,{value:"double",children:"Double click"})]})]})]}),"wait"===q&&(0,m.jsx)(ds,{config:eR,onChange:eM,onPickSelector:()=>tc(e=>eM(t=>({...t,selector:e}))),isPicking:g}),"extract"===q&&(0,m.jsx)(da,{config:eD,onChange:eP,onPickSelector:()=>tc(e=>eP(t=>({...t,selector:e}))),isPicking:g}),"screenshot"===q&&(0,m.jsx)(dn,{config:eA,onChange:eI,onPickSelector:()=>tc(e=>eI(t=>({...t,selector:e}))),isPicking:g,onCaptureNow:()=>tf(eA),isCapturing:ez}),"scroll"===q&&(0,m.jsx)(dl,{config:eC,onChange:eS,onPickSelector:()=>tc(e=>eS(t=>({...t,selector:e}))),isPicking:g}),"evaluate"===q&&(0,m.jsx)(di,{config:eE,onChange:eT,variables:N}),("type"===q||"select"===q)&&(0,m.jsx)(c7,{valueSource:es,onChange:ea,label:"type"===q?"Text to Type":"Option Value"}),"request"===q&&(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,m.jsx)(cY,{className:"h-4 w-4 text-primary"}),(0,m.jsx)("span",{className:"text-xs font-medium",children:"Request Configuration"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Request URL"}),(0,m.jsx)(eO,{placeholder:"https://api.example.com/endpoint",value:en,onChange:e=>el(e.target.value),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Method"}),(0,m.jsxs)(nd,{value:eo,onValueChange:e=>ei(e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"GET",children:"GET"}),(0,m.jsx)(np,{value:"POST",children:"POST"}),(0,m.jsx)(np,{value:"PUT",children:"PUT"}),(0,m.jsx)(np,{value:"DELETE",children:"DELETE"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Content-Type"}),(0,m.jsxs)(nd,{value:eu,onValueChange:e=>ex(e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"application/json",children:"application/json"}),(0,m.jsx)(np,{value:"text/plain",children:"text/plain"}),(0,m.jsx)(np,{value:"application/x-www-form-urlencoded",children:"application/x-www-form-urlencoded"}),(0,m.jsx)(np,{value:"none",children:"(none)"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Response JSON Path"}),(0,m.jsx)(eO,{placeholder:"data.result",value:ej,onChange:e=>ew(e.target.value),className:"h-8 text-xs font-mono"})]})]}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Templates work in URL, headers, body and response path (use ","{{vars.token}}",", ","{{timestamp}}",", ","{{url}}",")."]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Request Body"}),(0,m.jsx)(eq,{placeholder:`{
  "token": "{{vars.authToken}}",
  "user": "{{vars.userId}}",
  "page": "{{url}}",
  "ts": "{{timestamp}}"
}`,value:eb,onChange:e=>ey(e.target.value),className:"h-24 text-xs font-mono"}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Supports ","{{vars.*}}"," plus ","{{timestamp}}"," and ","{{url}}"," for dynamic payloads."]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Save response to variable (optional)"}),(0,m.jsx)(eO,{placeholder:"result or vars.result",value:eN,onChange:e=>ek(e.target.value),className:"h-8 text-xs font-mono"}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Response JSON path is applied first; value is stored and available as ","{{vars.yourKey}}","."]})]})]}),"sendCookies"===q&&(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,m.jsx)(cZ,{className:"h-4 w-4 text-primary"}),(0,m.jsx)("span",{className:"text-xs font-medium",children:"Send Cookies Configuration"})]}),(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Send all cookies"}),(0,m.jsx)(lo,{checked:em,onCheckedChange:e=>{ep(e),e&&(ef(""),ev([""]))},className:"scale-75"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Server URL"}),(0,m.jsx)(eO,{placeholder:"https://api.example.com/cookies",value:en,onChange:e=>el(e.target.value),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Method"}),(0,m.jsxs)(nd,{value:eo,onValueChange:e=>ei(e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"POST",children:"POST"}),(0,m.jsx)(np,{value:"PUT",children:"PUT"})]})]})]}),!em&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Cookie Domain"}),(0,m.jsx)(eO,{placeholder:".google.com",value:eh,onChange:e=>ef(e.target.value),className:"h-8 text-xs font-mono"}),(0,m.jsx)("p",{className:"text-[9px] text-muted-foreground",children:"Same domain used when reading cookies"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Cookie Names"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-6 px-2 text-[10px]",onClick:()=>ev([...eg,""]),children:[(0,m.jsx)(rI,{className:"h-3 w-3 mr-1"}),"Add"]})]}),eg.map((e,t)=>(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:".AspNet.ApplicationCookie",value:e,onChange:e=>{let r=[...eg];r[t]=e.target.value,ev(r)},className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>{let e=eg.filter((e,r)=>r!==t);ev(e.length?e:[""])},children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},t))]})]})]}),"sendPageSource"===q&&(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,m.jsx)(cQ,{className:"h-4 w-4 text-primary"}),(0,m.jsx)("span",{className:"text-xs font-medium",children:"Send Page Source"})]}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"Captures the full HTML (with DOCTYPE) of the active tab and posts it to your server."}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Server URL"}),(0,m.jsx)(eO,{placeholder:"https://api.example.com/page-source",value:en,onChange:e=>el(e.target.value),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Method"}),(0,m.jsxs)(nd,{value:"PUT"===eo?"PUT":"POST",onValueChange:e=>ei(e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"POST",children:"POST"}),(0,m.jsx)(np,{value:"PUT",children:"PUT"})]})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Headers"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-6 px-2 text-[10px]",onClick:()=>ed([...ec||[],{key:"",value:""}]),children:[(0,m.jsx)(rI,{className:"h-3 w-3 mr-1"}),"Add"]})]}),(ec||[]).map((e,t)=>(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"Authorization",value:e.key,onChange:e=>{let r=[...ec];r[t]={...r[t],key:e.target.value},ed(r)},className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eO,{placeholder:"Bearer token...",value:e.value,onChange:e=>{let r=[...ec];r[t]={...r[t],value:e.target.value},ed(r)},className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>ed(ec.filter((e,r)=>r!==t)),children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},t)),(!ec||0===ec.length)&&(0,m.jsx)("p",{className:"text-[9px] text-muted-foreground",children:"Optional: include auth headers for the upload."})]}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Payload sent as JSON: ","{ html, tabUrl, length, timestamp }","."]})]}),(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsx)(n4,{className:"text-xs",children:"On Failure"}),(0,m.jsxs)(nd,{value:Y,onValueChange:e=>Z(e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"stop",children:"Stop Workflow"}),(0,m.jsx)(np,{value:"skip",children:"Skip Step"}),(0,m.jsx)(np,{value:"goto",children:"Go to Step"}),(0,m.jsx)(np,{value:"fallback",children:"Use Fallback"})]})]}),"goto"===Y&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Jump to Step"}),(0,m.jsxs)(nd,{value:Q,onValueChange:e=>ee(e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{placeholder:"Select step"})}),(0,m.jsx)(nm,{children:w.map(e=>(0,m.jsx)(np,{value:e.id,children:e.name||e.id},e.id))})]})]}),"fallback"===Y&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Fallback Code (runs in page)"}),(0,m.jsx)(eq,{placeholder:"// JavaScript to recover when this step fails",value:et,onChange:e=>er(e.target.value),className:"h-24 text-xs font-mono"})]})]})]})}),(0,m.jsx)(c6,{open:E,onClose:()=>T(!1),title:"Add IF/ELSE Block",footer:(0,m.jsx)(eL,{className:"w-full h-8 text-xs",onClick:()=>{k||(l(e,{id:"block-"+Date.now(),type:"if-else",name:e3||"IF/ELSE Block",enabled:!0,condition:{type:e_,selector:eV,text:e$,attributeName:eH,attributeValue:eG,variableName:eX,variableValue:eZ,urlPattern:e0,regexPattern:e2},ifSteps:[],elseSteps:[]}),T(!1),eU("selectorExists"),eW(""),eB(""),eK(""),eJ(""),eY(""),eQ(""),e1(""),e5(""),e8(""))},disabled:k,children:"Create IF/ELSE Block"}),children:(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Block Name"}),(0,m.jsx)(eO,{placeholder:"Conditional Block",value:e3,onChange:e=>e8(e.target.value),className:"h-8 text-xs"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Condition Type"}),(0,m.jsxs)(nd,{value:e_,onValueChange:e=>eU(e),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsx)(nm,{children:[{label:"Selector",options:[{value:"selectorExists",label:"Exists"},{value:"selectorNotExists",label:"Not Exists"},{value:"elementVisible",label:"Visible"},{value:"elementHidden",label:"Hidden"},{value:"elementEnabled",label:"Enabled"},{value:"elementDisabled",label:"Disabled"}]},{label:"Text",options:[{value:"textContains",label:"Contains"},{value:"textEquals",label:"Equals"},{value:"textNotContains",label:"Not Contains"}]},{label:"URL",options:[{value:"urlMatches",label:"Matches"},{value:"urlEquals",label:"Equals"}]},{label:"Variable",options:[{value:"variableEquals",label:"Equals"},{value:"variableNotEquals",label:"Not Equals"},{value:"variableGreater",label:"Greater Than"},{value:"variableLess",label:"Less Than"},{value:"variableEmpty",label:"Is Empty"},{value:"variableNotEmpty",label:"Not Empty"}]},{label:"Attribute",options:[{value:"attributeEquals",label:"Equals"},{value:"attributeContains",label:"Contains"}]},{label:"Regex",options:[{value:"regexMatches",label:"Matches Pattern"}]}].map(e=>(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:"px-2 py-1 text-[10px] text-muted-foreground font-medium",children:e.label}),e.options.map(e=>(0,m.jsx)(np,{value:e.value,children:e.label},e.value))]},e.label))})]})]}),tg&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"CSS Selector"}),(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"#element or .class",value:eV,onChange:e=>eW(e.target.value),className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"outline",size:"icon",className:"h-8 w-8 bg-transparent",disabled:g,children:(0,m.jsx)(nb,{className:"h-3.5 w-3.5"})})]})]}),tb&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Variable Name"}),(0,m.jsx)(eO,{placeholder:"vars.myVariable",value:eX,onChange:e=>eY(e.target.value),className:"h-8 text-xs font-mono"})]}),ty&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Attribute Name"}),(0,m.jsx)(eO,{placeholder:"data-loaded",value:eH,onChange:e=>eK(e.target.value),className:"h-8 text-xs font-mono"})]}),tv&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Value to Compare"}),(0,m.jsx)(eO,{placeholder:"Expected value...",value:"variableEquals"===e_||"variableNotEquals"===e_||"variableGreater"===e_||"variableLess"===e_?eZ:"urlMatches"===e_?e0:"regexMatches"===e_?e2:e$,onChange:e=>{"variableEquals"===e_||"variableNotEquals"===e_||"variableGreater"===e_||"variableLess"===e_?eQ(e.target.value):"urlMatches"===e_?e1(e.target.value):"regexMatches"===e_?e5(e.target.value):"textContains"===e_||"textEquals"===e_||"textNotContains"===e_?eB(e.target.value):("attributeEquals"===e_||"attributeContains"===e_)&&eJ(e.target.value)},className:"h-8 text-xs"})]})]})}),(0,m.jsx)(c6,{open:R,onClose:()=>{M(!1),P(null),I(null)},title:"Edit Step",footer:D?(0,m.jsx)(eL,{className:"w-full h-8 text-xs",onClick:()=>{!k&&D&&(A?i(e,A.blockId,A.branch,D.id,D):o(e,D.id,D),M(!1),P(null),I(null))},disabled:k,children:"Save Changes"}):null,children:D&&(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Step Name"}),(0,m.jsx)(eO,{value:D.name,onChange:e=>P({...D,name:e.target.value}),className:"h-8 text-xs"})]}),void 0!==D.selector&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"CSS Selector"}),(0,m.jsx)(eO,{value:D.selector||"",onChange:e=>P({...D,selector:e.target.value}),className:"h-8 text-xs font-mono"})]}),"goTo"===D.type&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Target URL"}),(0,m.jsx)(eO,{value:D.goToUrl||"",onChange:e=>P({...D,goToUrl:e.target.value}),className:"h-8 text-xs font-mono"})]}),"click"===D.type&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Click Mode"}),(0,m.jsxs)(nd,{value:D.clickMode||"single",onValueChange:e=>P({...D,clickMode:e}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"single",children:"Single click"}),(0,m.jsx)(np,{value:"double",children:"Double click"})]})]})]}),("type"===D.type||"select"===D.type)&&(0,m.jsx)(c7,{valueSource:dr(D.valueSource,D.value??""),onChange:e=>P(t=>t?{...t,valueSource:e,value:"fixed"===e.type?e.fixedValue??"":void 0}:t),label:"type"===D.type?"Text to Type":"Option Value"}),void 0!==D.value&&"type"!==D.type&&"select"!==D.type&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Value"}),(0,m.jsx)(eO,{value:D.value||"",onChange:e=>P({...D,value:e.target.value}),className:"h-8 text-xs"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Timeout (ms)"}),(0,m.jsx)(eO,{type:"number",value:D.timeout,onChange:e=>P({...D,timeout:Number.parseInt(e.target.value)||5e3}),className:"h-8 text-xs"})]}),(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Retries"}),(0,m.jsx)(eO,{type:"number",value:D.retries,onChange:e=>P({...D,retries:Number.parseInt(e.target.value)||0}),className:"h-8 text-xs"})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"On Failure"}),(0,m.jsxs)(nd,{value:D.onFailure,onValueChange:e=>P({...D,onFailure:e}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"stop",children:"Stop Workflow"}),(0,m.jsx)(np,{value:"skip",children:"Skip Step"}),(0,m.jsx)(np,{value:"goto",children:"Go to Step"}),(0,m.jsx)(np,{value:"fallback",children:"Use Fallback"})]})]})]}),"goto"===D.onFailure&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Jump to Step"}),(0,m.jsxs)(nd,{value:D.gotoStep||"",onValueChange:e=>P({...D,gotoStep:e}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{placeholder:"Select step"})}),(0,m.jsx)(nm,{children:w.map(e=>(0,m.jsx)(np,{value:e.id,children:e.name||e.id},e.id))})]})]}),"fallback"===D.onFailure&&(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Fallback Code (runs in page)"}),(0,m.jsx)(eq,{placeholder:"// JavaScript to recover when this step fails",value:D.fallbackCode||"",onChange:e=>P({...D,fallbackCode:e.target.value}),className:"h-24 text-xs font-mono"})]}),"evaluate"===D.type&&(0,m.jsx)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:(0,m.jsx)(di,{config:{...r_.defaultEvaluateConfig,...D.evaluateConfig||{}},onChange:e=>P({...D,evaluateConfig:e}),variables:N})}),"scroll"===D.type&&(0,m.jsx)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:(0,m.jsx)(dl,{config:{scrollType:"toSelector",behavior:"smooth",...D.scrollConfig,selector:D.scrollConfig?.selector||D.selector||""},onChange:e=>P({...D,selector:e.selector||D.selector,scrollConfig:e}),onPickSelector:()=>tc(e=>P(t=>t?{...t,selector:e,scrollConfig:{...t.scrollConfig||{},selector:e}}:t)),isPicking:g})}),"extract"===D.type&&(0,m.jsx)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:(0,m.jsx)(da,{config:{...r_.defaultExtractConfig,...D.extractConfig,selector:D.extractConfig?.selector||D.selector||""},onChange:e=>{P({...D,selector:e.selector,extractConfig:e})},onPickSelector:()=>tc(e=>P(t=>t?{...t,selector:e,extractConfig:{...t.extractConfig||{},selector:e}}:t)),isPicking:g})}),"screenshot"===D.type&&(0,m.jsx)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:(0,m.jsx)(dn,{config:{...r_.defaultScreenshotConfig,...D.screenshotConfig,selector:D.screenshotConfig?.selector||D.selector||""},onChange:e=>{P({...D,selector:e.selector||D.selector,screenshotConfig:e})},onPickSelector:()=>tc(e=>P(t=>t?{...t,selector:e,screenshotConfig:{...t.screenshotConfig||{},selector:e}}:t)),isPicking:g,onCaptureNow:()=>tf({...r_.defaultScreenshotConfig,...D.screenshotConfig,selector:D.screenshotConfig?.selector||D.selector||""},D.selector||D.screenshotConfig?.selector),isCapturing:ez})}),"request"===D.type&&(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Request URL"}),(0,m.jsx)(eO,{value:D.serverUrl||"",onChange:e=>P({...D,serverUrl:e.target.value}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"w-28 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Method"}),(0,m.jsxs)(nd,{value:D.requestMethod||"GET",onValueChange:e=>P({...D,requestMethod:e}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"GET",children:"GET"}),(0,m.jsx)(np,{value:"POST",children:"POST"}),(0,m.jsx)(np,{value:"PUT",children:"PUT"}),(0,m.jsx)(np,{value:"DELETE",children:"DELETE"})]})]})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Response JSON Path"}),(0,m.jsx)(eO,{placeholder:"data.value",value:D.responseJsonPath||"",onChange:e=>P({...D,responseJsonPath:e.target.value}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Content-Type"}),(0,m.jsxs)(nd,{value:D.requestContentType||"application/json",onValueChange:e=>P({...D,requestContentType:e}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"application/json",children:"application/json"}),(0,m.jsx)(np,{value:"text/plain",children:"text/plain"}),(0,m.jsx)(np,{value:"application/x-www-form-urlencoded",children:"application/x-www-form-urlencoded"}),(0,m.jsx)(np,{value:"none",children:"(none)"})]})]})]}),(0,m.jsx)("div",{className:"flex-1"})]}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Templates work in URL, headers, body and response path (use ","{{vars.token}}",", ","{{timestamp}}",", ","{{url}}",")."]}),(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Headers"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-6 px-2 text-[10px]",onClick:()=>P({...D,headers:[...D.headers||[],{key:"",value:""}]}),children:[(0,m.jsx)(rI,{className:"h-3 w-3 mr-1"}),"Add"]})]}),(D.headers||[]).map((e,t)=>(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"Key",value:e.key,onChange:e=>{let r=[...D.headers||[]];r[t]={...r[t],key:e.target.value},P({...D,headers:r})},className:"h-8 text-xs flex-1"}),(0,m.jsx)(eO,{placeholder:"Value",value:e.value,onChange:e=>{let r=[...D.headers||[]];r[t]={...r[t],value:e.target.value},P({...D,headers:r})},className:"h-8 text-xs flex-1"}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>{let e=(D.headers||[]).filter((e,r)=>r!==t);P({...D,headers:e})},children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},t))]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Request Body"}),(0,m.jsx)(eq,{placeholder:`{
  "token": "{{vars.authToken}}",
  "user": "{{vars.userId}}",
  "page": "{{url}}",
  "ts": "{{timestamp}}"
}`,value:D.requestBody||"",onChange:e=>P({...D,requestBody:e.target.value}),className:"h-24 text-xs font-mono"}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Supports ","{{vars.*}}"," plus ","{{timestamp}}"," and ","{{url}}"," for dynamic payloads."]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Save response to variable (optional)"}),(0,m.jsx)(eO,{placeholder:"result or vars.result",value:D.saveTo||"",onChange:e=>P({...D,saveTo:e.target.value}),className:"h-8 text-xs font-mono"}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Response JSON path is applied first; value is stored and available as ","{{vars.yourKey}}","."]})]})]}),"sendPageSource"===D.type&&(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,m.jsx)(cQ,{className:"h-4 w-4 text-primary"}),(0,m.jsx)("span",{className:"text-xs font-medium",children:"Send Page Source"})]}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"Sends the current tab HTML (doctype + documentElement.outerHTML) as JSON to your endpoint."}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Server URL"}),(0,m.jsx)(eO,{placeholder:"https://api.example.com/page-source",value:D.serverUrl||"",onChange:e=>P({...D,serverUrl:e.target.value}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Method"}),(0,m.jsxs)(nd,{value:"PUT"===D.requestMethod?"PUT":"POST",onValueChange:e=>P({...D,requestMethod:e}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"POST",children:"POST"}),(0,m.jsx)(np,{value:"PUT",children:"PUT"})]})]})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Headers"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-6 px-2 text-[10px]",onClick:()=>P({...D,headers:[...D.headers||[],{key:"",value:""}]}),children:[(0,m.jsx)(rI,{className:"h-3 w-3 mr-1"}),"Add"]})]}),(D.headers||[]).map((e,t)=>(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:"Key",value:e.key,onChange:e=>{let r=[...D.headers||[]];r[t]={...r[t],key:e.target.value},P({...D,headers:r})},className:"h-8 text-xs flex-1"}),(0,m.jsx)(eO,{placeholder:"Value",value:e.value,onChange:e=>{let r=[...D.headers||[]];r[t]={...r[t],value:e.target.value},P({...D,headers:r})},className:"h-8 text-xs flex-1"}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>{let e=(D.headers||[]).filter((e,r)=>r!==t);P({...D,headers:e})},children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},t)),0===(D.headers||[]).length&&(0,m.jsx)("p",{className:"text-[9px] text-muted-foreground",children:"Optional headers for auth or routing."})]}),(0,m.jsxs)("p",{className:"text-[9px] text-muted-foreground",children:["Payload: ","{ html, tabUrl, length, timestamp }"," with JSON content-type."]})]}),"sendCookies"===D.type&&(s=D.cookieAll??!(D.cookieDomain||D.cookieNames&&D.cookieNames.length),a=D.cookieNames&&D.cookieNames.length>0?D.cookieNames:[""],(0,m.jsxs)("div",{className:"space-y-2 border border-border rounded-md p-3 bg-secondary/30",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Send all cookies"}),(0,m.jsx)(lo,{checked:s,onCheckedChange:e=>P({...D,cookieAll:e,cookieDomain:e?void 0:D.cookieDomain,cookieNames:e?[]:a}),className:"scale-75"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Server URL"}),(0,m.jsx)(eO,{value:D.serverUrl||"",onChange:e=>P({...D,serverUrl:e.target.value}),className:"h-8 text-xs font-mono"})]}),(0,m.jsxs)("div",{className:"w-28 space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Method"}),(0,m.jsxs)(nd,{value:D.requestMethod||"POST",onValueChange:e=>P({...D,requestMethod:e}),children:[(0,m.jsx)(nx,{className:"h-8 text-xs",children:(0,m.jsx)(nu,{})}),(0,m.jsxs)(nm,{children:[(0,m.jsx)(np,{value:"POST",children:"POST"}),(0,m.jsx)(np,{value:"PUT",children:"PUT"})]})]})]})]}),!s&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Cookie Domain"}),(0,m.jsx)(eO,{placeholder:".google.com",value:D.cookieDomain||"",onChange:e=>P({...D,cookieDomain:e.target.value}),className:"h-8 text-xs font-mono"}),(0,m.jsx)("p",{className:"text-[9px] text-muted-foreground",children:"Same domain used when reading cookies"})]}),(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Cookie Names"}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-6 px-2 text-[10px]",onClick:()=>P({...D,cookieNames:[...D.cookieNames||[],""]}),children:[(0,m.jsx)(rI,{className:"h-3 w-3 mr-1"}),"Add"]})]}),a.map((e,t)=>(0,m.jsxs)("div",{className:"flex gap-1",children:[(0,m.jsx)(eO,{placeholder:".AspNet.ApplicationCookie",value:e,onChange:e=>{let r=[...a];r[t]=e.target.value,P({...D,cookieNames:r})},className:"h-8 text-xs font-mono flex-1"}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>{let e=a.filter((e,r)=>r!==t);P({...D,cookieNames:e.length?e:[""]})},children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},t))]})]})]})),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(lo,{checked:D.enabled,onCheckedChange:e=>P({...D,enabled:e})}),(0,m.jsx)(n4,{className:"text-xs",children:"Enabled"})]})]})})]})}let dx=rw("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),dm={manual:"Manual",websocket:"WebSocket",schedule:"Schedule",browser:"Browser",dom:"DOM"};function dp(e){let t=Date.now()-e;return t<6e4?"Just now":t<36e5?`${Math.floor(t/6e4)} min ago`:t<864e5?`${Math.floor(t/36e5)} hour${Math.floor(t/36e5)>1?"s":""} ago`:"Yesterday"}function dh({workflowId:e}){let{getWorkflow:t,deleteRun:r,clearRuns:s}=(0,f.useAutomation)(),a=t(e),n=a?.runs||[],[l,o]=(0,h.useState)(null),i=n.find(e=>e.id===l);return 0===n.length?(0,m.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-muted-foreground p-6",children:[(0,m.jsx)(iv,{className:"h-10 w-10 mb-3 opacity-50"}),(0,m.jsx)("p",{className:"text-sm font-medium",children:"No runs yet"}),(0,m.jsx)("p",{className:"text-xs text-center mt-1",children:"Run this workflow to see execution history here."})]}):(0,m.jsxs)("div",{className:"h-full flex overflow-hidden",children:[(0,m.jsxs)("div",{className:`${l?"w-[180px]":"w-full"} border-r border-border flex flex-col transition-all overflow-hidden`,children:[(0,m.jsxs)("div",{className:"p-2 border-b border-border flex items-center justify-between shrink-0",children:[(0,m.jsxs)("span",{className:"text-xs text-muted-foreground",children:[n.length," runs"]}),(0,m.jsxs)(eL,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-destructive hover:text-destructive",onClick:()=>s(e),children:[(0,m.jsx)(ih,{className:"h-3 w-3 mr-1"}),"Clear"]})]}),(0,m.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,m.jsx)(lW,{className:"h-full",children:(0,m.jsx)("div",{className:"p-2 space-y-1.5",children:n.map(e=>(0,m.jsxs)("div",{onClick:()=>o(e.id),className:`p-2 rounded-lg border cursor-pointer transition-colors ${l===e.id?"border-primary/50 bg-primary/5":"border-border bg-card hover:border-border/80"}`,children:[(0,m.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,m.jsxs)("div",{className:"flex items-start gap-2",children:[(e=>{switch(e){case"success":return(0,m.jsx)(nw,{className:"h-3.5 w-3.5 text-success"});case"failed":return(0,m.jsx)(nN,{className:"h-3.5 w-3.5 text-destructive"});case"running":return(0,m.jsx)(nk,{className:"h-3.5 w-3.5 text-info animate-spin"});default:return(0,m.jsx)(iv,{className:"h-3.5 w-3.5 text-muted-foreground"})}})(e.status),(0,m.jsxs)("div",{className:"min-w-0",children:[(0,m.jsx)("h4",{className:"text-xs font-medium truncate",children:a?.name}),(0,m.jsxs)("div",{className:"flex items-center gap-1.5 mt-0.5",children:[(0,m.jsx)(lc,{variant:"outline",className:"text-[8px] px-1 py-0 h-3.5",children:dm[e.trigger]}),(0,m.jsx)("span",{className:"text-[10px] text-muted-foreground",children:dp(e.startTime)})]})]})]}),(0,m.jsx)("div",{className:"text-right",children:(0,m.jsx)("span",{className:"text-[10px] text-muted-foreground font-mono",children:e.duration||"-"})})]}),e.error&&(0,m.jsxs)("div",{className:"mt-1.5 flex items-start gap-1 text-[10px] text-destructive",children:[(0,m.jsx)(iO,{className:"h-3 w-3 mt-0.5 shrink-0"}),(0,m.jsx)("span",{className:"truncate",children:e.error})]})]},e.id))})})})]}),l&&i&&(0,m.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,m.jsx)("div",{className:"p-3 border-b border-border shrink-0",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("h3",{className:"text-sm font-medium",children:a?.name}),(e=>{switch(e){case"success":return(0,m.jsx)(lc,{className:"bg-success/15 text-success border-0 text-[9px] px-1.5 py-0",children:"Success"});case"failed":return(0,m.jsx)(lc,{className:"bg-destructive/15 text-destructive border-0 text-[9px] px-1.5 py-0",children:"Failed"});case"running":return(0,m.jsx)(lc,{className:"bg-info/15 text-info border-0 text-[9px] px-1.5 py-0",children:"Running"});default:return(0,m.jsx)(lc,{variant:"secondary",className:"text-[9px] px-1.5 py-0",children:e})}})(i.status)]}),(0,m.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-muted-foreground",children:[(0,m.jsx)("span",{children:dp(i.startTime)}),(0,m.jsx)("span",{children:""}),(0,m.jsx)("span",{children:i.duration||"-"}),(0,m.jsx)("span",{children:""}),(0,m.jsx)("span",{children:dm[i.trigger]})]})]}),(0,m.jsx)(eL,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>o(null),children:(0,m.jsx)(rO,{className:"h-4 w-4"})})]})}),(0,m.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,m.jsx)(lW,{className:"h-full",children:(0,m.jsxs)("div",{className:"p-3 space-y-2",children:[(0,m.jsx)("h4",{className:"text-xs font-medium text-muted-foreground",children:"Steps Timeline"}),(0,m.jsx)("div",{className:"space-y-1",children:i.steps.map((e,t)=>(0,m.jsxs)("div",{className:`flex items-center gap-2 p-2 rounded border ${"failed"===e.status?"border-destructive/30 bg-destructive/5":"border-border bg-card"}`,children:["success"===e.status&&(0,m.jsx)(nw,{className:"h-3.5 w-3.5 text-success"}),"failed"===e.status&&(0,m.jsx)(nN,{className:"h-3.5 w-3.5 text-destructive"}),"running"===e.status&&(0,m.jsx)(nk,{className:"h-3.5 w-3.5 text-info animate-spin"}),"pending"===e.status&&(0,m.jsx)(iv,{className:"h-3.5 w-3.5 text-muted-foreground"}),"skipped"===e.status&&(0,m.jsx)(iv,{className:"h-3.5 w-3.5 text-muted-foreground opacity-50"}),(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsx)("div",{className:"text-xs",children:e.name}),e.error&&(0,m.jsx)("div",{className:"text-[10px] text-destructive/80 font-mono truncate",title:e.error,children:e.error})]}),(0,m.jsx)("span",{className:"text-[10px] text-muted-foreground font-mono",children:e.duration||"-"})]},t))}),i.error&&(0,m.jsxs)("div",{className:"mt-3 p-2 rounded border border-destructive/30 bg-destructive/5",children:[(0,m.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-destructive font-medium",children:[(0,m.jsx)(iO,{className:"h-3.5 w-3.5"}),"Error Details"]}),(0,m.jsx)("p",{className:"text-[10px] text-destructive/80 mt-1 font-mono",children:i.error})]}),(0,m.jsxs)("div",{className:"mt-3 p-2 rounded border border-border bg-secondary/30",children:[(0,m.jsx)("h4",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Context"}),(0,m.jsxs)("div",{className:"space-y-1 text-[10px]",children:[i.context.url&&(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(nj,{className:"h-3 w-3 text-muted-foreground"}),(0,m.jsx)("span",{className:"text-muted-foreground",children:"URL:"}),(0,m.jsx)("span",{className:"font-mono",children:i.context.url})]}),i.context.tabId&&(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Tab ID:"}),(0,m.jsx)("span",{className:"font-mono",children:i.context.tabId})]})]})]})]})})}),(0,m.jsxs)("div",{className:"p-2 border-t border-border flex gap-1.5 shrink-0",children:[(0,m.jsxs)(eL,{size:"sm",className:"flex-1 h-7 text-xs gap-1.5 bg-primary hover:bg-primary/90 text-primary-foreground",children:[(0,m.jsx)(dx,{className:"h-3 w-3"}),"Replay"]}),(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1.5 border-border bg-transparent",children:[(0,m.jsx)(rz,{className:"h-3 w-3"}),"Export"]}),(0,m.jsx)(eL,{variant:"ghost",size:"sm",className:"h-7 text-xs text-destructive hover:text-destructive",onClick:()=>{r(e,i.id),o(null)},children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]})]})]})}let df=rw("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),dg=rw("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);function dv(e){let t=crypto.randomUUID();return window.parent.postMessage({__fromSandbox:!0,requestId:t,payload:e},"*"),new Promise((e,r)=>{let s=a=>{let n=a.data;n?.__fromExtension&&n.requestId===t&&(window.removeEventListener("message",s),n.error?r(Error(n.error)):e(n.response))};window.addEventListener("message",s)})}function db({workflowId:e}){let{getWorkflow:t,lastKnownTab:r,setLastKnownTab:s,updateWorkflow:a,updateSettings:n,addAllowedSite:l,removeAllowedSite:o,workflows:i,selectedWorkflowId:c,restartWebsocket:d}=(0,f.useAutomation)(),{selectedProjectId:u,deleteProject:x,setSelectedProjectId:g,getProject:v}=(0,p.useProject)(),b=t(e),y=b?.settings||(0,r_.createDefaultSettings)(),j=u?v(u):null,[w,N]=(0,h.useState)(""),[k,C]=(0,h.useState)(!1),[S,E]=(0,h.useState)(!1),[T,R]=(0,h.useState)(!1),[M,D]=(0,h.useState)(!1),[P,A]=(0,h.useState)(b?.name||""),[I,L]=(0,h.useState)(b?.description||""),O="undefined"!=typeof chrome&&chrome.permissions,q=async()=>{E(!0);try{if(O)if(y.allowCookies)await chrome.permissions.remove({permissions:["cookies"]})&&(n(e,{allowCookies:!1}),console.log("[v0] Cookie permission revoked"));else{let t=await chrome.permissions.request({permissions:["cookies"]});n(e,{allowCookies:t}),console.log("[v0] Cookie permission:",t?"granted":"denied")}else{console.warn("[v0] Chrome permissions API not available - running in preview mode");let t=!y.allowCookies;n(e,{allowCookies:t}),alert(t?"Cookie permission would be requested in a real Chrome extension":"Cookie permission would be revoked in a real Chrome extension")}}catch(e){console.error("[v0] Failed to request cookie permission:",e),alert("Failed to request permission: "+e.message)}finally{E(!1)}},z=async()=>{R(!0);try{if(O)if(y.allowStorage)await chrome.permissions.remove({permissions:["storage"]})&&(n(e,{allowStorage:!1}),console.log("[v0] Storage permission revoked"));else{let t=await chrome.permissions.request({permissions:["storage"]});n(e,{allowStorage:t}),console.log("[v0] Storage permission:",t?"granted":"denied")}else{console.warn("[v0] Chrome permissions API not available - running in preview mode");let t=!y.allowStorage;n(e,{allowStorage:t}),alert(t?"Storage permission would be requested in a real Chrome extension":"Storage permission would be revoked in a real Chrome extension")}}catch(e){console.error("[v0] Failed to request storage permission:",e),alert("Failed to request permission: "+e.message)}finally{R(!1)}};(0,h.useEffect)(()=>{O&&(chrome.permissions.contains({permissions:["cookies"]},t=>{t!==y.allowCookies&&n(e,{allowCookies:t})}),chrome.permissions.contains({permissions:["storage"]},t=>{t!==y.allowStorage&&n(e,{allowStorage:t})}))},[O,e]),(0,h.useEffect)(()=>{A(b?.name||""),L(b?.description||"")},[b?.name,b?.description]),(0,h.useEffect)(()=>{y.wsConnected&&C(!1)},[y.wsConnected]);let F=()=>{b&&a(b.id,{name:P.trim(),description:I.trim()})};if(!y)return(0,m.jsx)("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:(0,m.jsx)("p",{className:"text-sm",children:"No settings available"})});let _=()=>{w.trim()&&(l(e,{host:w.trim(),favicon:""}),N(""))},U=async()=>{try{let t=await dv({type:"tabs.query",query:{active:!0,lastFocusedWindow:!0}});t?.ok===!1&&t?.error&&console.warn("[settings] tabs.query failed",t.error);let a=Array.isArray(t?.tabs)?t.tabs[0]:void 0;(a?.id||a?.url)&&s({id:a.id,url:a.url});let n=a?.url||r.url||window.location.href;if(!n)return void console.warn("[settings] No active tab url found");let o=new URL(n);if("chrome-extension:"===o.protocol)return void console.warn("[settings] Ignoring extension URL when allowing site",n);let i=`${o.origin}${o.pathname}${o.search||""}`;l(e,{host:i,favicon:""})}catch(e){console.error("[settings] Failed to allow current site",e)}};return(0,m.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,m.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,m.jsx)(lW,{className:"h-full",children:(0,m.jsx)("div",{className:"p-3",children:(0,m.jsxs)(cp,{type:"multiple",defaultValue:["permissions","connections"],className:"space-y-2",children:[(0,m.jsxs)(ch,{value:"permissions",className:"border border-border rounded-lg px-3",children:[(0,m.jsx)(cf,{className:"text-xs font-medium py-2 hover:no-underline",children:(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(nj,{className:"h-3.5 w-3.5"}),"Allowed Sites",(0,m.jsx)(lc,{variant:"secondary",className:"text-[9px] px-1.5 py-0 h-4",children:y.allowedSites.length})]})}),(0,m.jsxs)(cg,{className:"pb-3",children:[0===y.allowedSites.length&&(0,m.jsx)("div",{className:"p-2 rounded border border-warning/30 bg-warning/5 mb-2",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,m.jsx)(iO,{className:"h-3.5 w-3.5 text-warning"}),(0,m.jsx)("span",{children:"No sites allowed"})]}),(0,m.jsx)(eL,{size:"sm",className:"h-6 text-[10px] px-2 bg-primary text-primary-foreground",onClick:U,children:"Allow current site"})]})}),(0,m.jsx)("div",{className:"space-y-1.5",children:y.allowedSites.map((t,r)=>(0,m.jsxs)("div",{className:"flex items-center justify-between p-2 rounded border border-border bg-card",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("span",{children:t.favicon}),(0,m.jsx)("span",{className:"text-xs font-mono",children:t.host})]}),(0,m.jsx)(eL,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>o(e,t.host),children:(0,m.jsx)(ih,{className:"h-3 w-3"})})]},r))}),(0,m.jsxs)("div",{className:"flex gap-1.5 mt-2",children:[(0,m.jsx)(eO,{className:"h-7 text-xs flex-1",placeholder:"e.g. *.example.com",value:w,onChange:e=>N(e.target.value),onKeyDown:e=>"Enter"===e.key&&_()}),(0,m.jsx)(eL,{size:"sm",className:"h-7 px-2",onClick:_,children:"Add"})]})]})]}),(0,m.jsxs)(ch,{value:"connections",className:"border border-border rounded-lg px-3",children:[(0,m.jsx)(cf,{className:"text-xs font-medium py-2 hover:no-underline",children:(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(nC,{className:"h-3.5 w-3.5"}),"Connections"]})}),(0,m.jsx)(cg,{className:"pb-3 space-y-3",children:(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)(n4,{className:"text-xs flex items-center gap-1.5",children:[(0,m.jsx)(nC,{className:"h-3 w-3"}),"WebSocket"]}),(0,m.jsx)("div",{className:"flex items-center gap-1.5 text-[10px]",children:y.wsConnected?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(nw,{className:"h-3 w-3 text-success"}),(0,m.jsx)("span",{className:"text-success",children:"Connected"})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(nN,{className:"h-3 w-3 text-destructive"}),(0,m.jsx)("span",{className:"text-destructive",children:"Disconnected"})]})})]}),(0,m.jsxs)("div",{className:"flex gap-1.5",children:[(0,m.jsx)(eO,{className:"h-7 text-[10px] font-mono flex-1",value:y.wsEndpoint,onChange:t=>n(e,{wsEndpoint:t.target.value,wsConnectRequested:!0}),placeholder:"ws://localhost:8765"}),(0,m.jsx)(eL,{variant:"outline",size:"sm",className:"h-7 px-2 bg-transparent",onClick:()=>{C(!0),d(e),setTimeout(()=>C(!1),5e3)},children:k?(0,m.jsx)(nk,{className:"h-3 w-3 animate-spin"}):(0,m.jsx)(ny,{className:"h-3 w-3"})})]}),(0,m.jsx)("div",{className:"text-[10px] text-muted-foreground",children:k?"Connecting...":y.wsConnected?"Connected":"Disconnected"})]})})]}),(0,m.jsxs)(ch,{value:"defaults",className:"border border-border rounded-lg px-3",children:[(0,m.jsx)(cf,{className:"text-xs font-medium py-2 hover:no-underline",children:(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(c$,{className:"h-3.5 w-3.5"}),"Defaults"]})}),(0,m.jsxs)(cg,{className:"pb-3 space-y-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between p-2 rounded border border-border bg-card",children:[(0,m.jsx)("div",{className:"text-xs",children:(0,m.jsx)("span",{className:"text-muted-foreground",children:"Default Timeout:"})}),(0,m.jsxs)("div",{className:"flex items-center gap-1",children:[(0,m.jsx)(eO,{type:"number",className:"h-6 w-20 text-xs text-right",value:y.defaultTimeout,onChange:t=>n(e,{defaultTimeout:Number.parseInt(t.target.value)||5e3})}),(0,m.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"ms"})]})]}),(0,m.jsxs)("div",{className:"flex items-center justify-between p-2 rounded border border-border bg-card",children:[(0,m.jsx)("div",{className:"text-xs",children:(0,m.jsx)("span",{className:"text-muted-foreground",children:"Max Retries:"})}),(0,m.jsx)(eO,{type:"number",className:"h-6 w-16 text-xs text-right",value:y.maxRetries,onChange:t=>n(e,{maxRetries:Number.parseInt(t.target.value)||0})})]}),(0,m.jsxs)("div",{className:"space-y-1 p-2 rounded border border-border bg-card",children:[(0,m.jsx)(n4,{className:"text-xs",children:"Workflow Name"}),(0,m.jsx)(eO,{className:"h-7 text-xs",placeholder:"Workflow name",value:P,onChange:e=>A(e.target.value),onBlur:F}),(0,m.jsx)(n4,{className:"text-xs",children:"Workflow Description"}),(0,m.jsx)(eq,{className:"text-xs",rows:3,placeholder:"Describe this workflow...",value:I,onChange:e=>L(e.target.value),onBlur:F}),(0,m.jsx)("div",{className:"flex justify-end",children:(0,m.jsx)(eL,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:F,children:"Save"})})]})]})]}),(0,m.jsxs)(ch,{value:"storage",className:"border border-border rounded-lg px-3",children:[(0,m.jsx)(cf,{className:"text-xs font-medium py-2 hover:no-underline",children:(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(cK,{className:"h-3.5 w-3.5"}),"Storage"]})}),(0,m.jsxs)(cg,{className:"pb-3 space-y-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between p-2 rounded border border-border bg-card",children:[(0,m.jsxs)("div",{className:"text-xs",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:"Storage type:"}),(0,m.jsx)("span",{className:"ml-1.5 font-medium",children:"chrome.storage.local"})]}),(0,m.jsxs)(lc,{variant:"secondary",className:"text-[9px]",children:[b?.steps.length||0," steps"]})]}),(0,m.jsxs)("div",{className:"flex gap-1.5",children:[(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"flex-1 h-7 text-xs gap-1.5 border-border bg-transparent",children:[(0,m.jsx)(rz,{className:"h-3 w-3"}),"Backup"]}),(0,m.jsxs)(eL,{variant:"destructive",size:"sm",className:"h-7 text-xs gap-1.5",children:[(0,m.jsx)(ih,{className:"h-3 w-3"}),"Clear"]})]})]})]}),(0,m.jsxs)(ch,{value:"security",className:"border border-border rounded-lg px-3",children:[(0,m.jsx)(cf,{className:"text-xs font-medium py-2 hover:no-underline",children:(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(df,{className:"h-3.5 w-3.5"}),"Security"]})}),(0,m.jsxs)(cg,{className:"pb-3 space-y-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between p-2 rounded border border-border bg-card",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(cZ,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-xs",children:"Allow reading cookies"}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"Required for cookie-based steps"})]})]}),(0,m.jsxs)(eL,{variant:y.allowCookies?"destructive":"default",size:"sm",className:"h-7 text-xs gap-1.5",onClick:q,disabled:S,children:[S?(0,m.jsx)(nk,{className:"h-3 w-3 animate-spin"}):y.allowCookies?(0,m.jsx)(nN,{className:"h-3 w-3"}):(0,m.jsx)(nw,{className:"h-3 w-3"}),y.allowCookies?"Revoke":"Grant"]})]}),(0,m.jsxs)("div",{className:"flex items-center justify-between p-2 rounded border border-border bg-card",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(dg,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-xs",children:"Allow reading localStorage"}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"Required for storage-based steps"})]})]}),(0,m.jsxs)(eL,{variant:y.allowStorage?"destructive":"default",size:"sm",className:"h-7 text-xs gap-1.5",onClick:z,disabled:T,children:[T?(0,m.jsx)(nk,{className:"h-3 w-3 animate-spin"}):y.allowStorage?(0,m.jsx)(nN,{className:"h-3 w-3"}):(0,m.jsx)(nw,{className:"h-3 w-3"}),y.allowStorage?"Revoke":"Grant"]})]}),(0,m.jsxs)("div",{className:"p-2 rounded border border-border bg-secondary/50",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,m.jsx)(df,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,m.jsx)("span",{className:"text-muted-foreground",children:"Permission Status:"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2 mt-1.5",children:[(0,m.jsx)(lc,{variant:y.allowCookies?"default":"secondary",className:"text-[9px]",children:y.allowCookies?" Cookies":" Cookies"}),(0,m.jsx)(lc,{variant:y.allowStorage?"default":"secondary",className:"text-[9px]",children:y.allowStorage?" Storage":" Storage"})]})]}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"These permissions allow workflows to access sensitive data. Grant only if needed for your automation."})]})]}),(0,m.jsxs)(ch,{value:"developer",className:"border border-border rounded-lg px-3",children:[(0,m.jsx)(cf,{className:"text-xs font-medium py-2 hover:no-underline",children:(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(cG,{className:"h-3.5 w-3.5"}),"Developer"]})}),(0,m.jsxs)(cg,{className:"pb-3 space-y-2",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between p-2 rounded border border-border bg-card",children:[(0,m.jsx)("span",{className:"text-xs",children:"Verbose logging"}),(0,m.jsx)(lo,{checked:y.verboseLogging,onCheckedChange:t=>n(e,{verboseLogging:t}),className:"scale-75"})]}),(0,m.jsxs)("div",{className:"flex gap-1.5",children:[(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"flex-1 h-7 text-xs gap-1.5 border-border bg-transparent",onClick:async()=>{let e=JSON.stringify({projectId:u,project:j,workflows:i,selectedWorkflowId:c},null,2),t=`developer-state-${Date.now()}.json`;try{await dv({type:"download.workflow",fileName:t,content:e})}catch(r){console.warn("[developer] sandbox download failed, falling back",r);try{let r=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(r),a=document.createElement("a");a.href=s,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}catch(e){console.error("[developer] export failed",e)}}},children:[(0,m.jsx)(rz,{className:"h-3 w-3"}),"Export State"]}),(0,m.jsxs)(eL,{variant:"outline",size:"sm",className:"flex-1 h-7 text-xs gap-1.5 border-border bg-transparent",onClick:()=>{console.log("[developer] current state",{projectId:u,project:j,workflows:i,selectedWorkflowId:c})},children:[(0,m.jsx)(cG,{className:"h-3 w-3"}),"Console"]})]})]})]}),(0,m.jsxs)(ch,{value:"danger",className:"border border-border rounded-lg px-3",children:[(0,m.jsx)(cf,{className:"text-xs font-medium py-2 hover:no-underline",children:(0,m.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,m.jsx)(ih,{className:"h-3.5 w-3.5"}),"Danger Zone"]})}),(0,m.jsx)(cg,{className:"pb-3",children:(0,m.jsxs)("div",{className:"p-2 rounded border border-destructive/40 bg-background flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"text-xs",children:[(0,m.jsx)("p",{className:"text-foreground font-medium",children:"Delete this project"}),(0,m.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"This removes the project from the list."})]}),(0,m.jsx)(eL,{variant:"outline",size:"sm",className:"h-7 text-xs border-destructive text-destructive hover:bg-destructive/10",onClick:()=>D(!0),disabled:!u,children:"Delete project"})]})})]})]})})})}),(0,m.jsx)(rk,{open:M,onOpenChange:D,children:(0,m.jsxs)(rT,{className:"sm:max-w-sm",children:[(0,m.jsxs)(rR,{children:[(0,m.jsx)(rD,{className:"text-destructive",children:"Delete project?"}),(0,m.jsx)(rP,{children:"This will remove the project from your list."})]}),(0,m.jsxs)(rM,{className:"flex justify-end gap-2",children:[(0,m.jsx)(eL,{variant:"outline",onClick:()=>D(!1),children:"Cancel"}),(0,m.jsx)(eL,{variant:"destructive",onClick:()=>{u&&(x(u),g(null),D(!1))},children:"Yes, delete"})]})]})})]})}let dy=[{id:"workflows",label:"Workflows",icon:rL},{id:"triggers",label:"Triggers",icon:nS},{id:"steps",label:"Steps",icon:ng},{id:"runs",label:"Runs",icon:rw("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},{id:"settings",label:"Settings",icon:rw("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}];function dj(){let[e,t]=(0,h.useState)("workflows"),{selectedWorkflowId:r,setSelectedWorkflowId:s}=(0,f.useAutomation)(),[a,n]=(0,h.useState)(null),l=(0,h.useCallback)(e=>{n(e),t("steps")},[]),o=(0,h.useCallback)(()=>{n(null)},[]);return(0,m.jsxs)("div",{className:"automation-studio-container w-full h-full bg-background border-b border-border flex flex-col overflow-hidden",children:[(0,m.jsx)(n5,{selectedWorkflowId:r,onWorkflowChange:s,onOpenAddStep:l}),(0,m.jsx)("div",{className:"flex border-b border-border bg-card/50",children:dy.map(r=>{let s=r.icon,a=e===r.id;return(0,m.jsxs)("button",{onClick:()=>t(r.id),className:`flex-1 flex items-center justify-center gap-1.5 py-2.5 text-xs font-medium transition-colors relative ${a?"text-foreground":"text-muted-foreground hover:text-foreground/80"}`,children:[(0,m.jsx)(s,{className:"h-3.5 w-3.5"}),(0,m.jsx)("span",{children:r.label}),a&&(0,m.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]},r.id)})}),(0,m.jsxs)("div",{className:"flex-1 overflow-hidden",children:["workflows"===e&&(0,m.jsx)(ij,{onEditWorkflow:()=>t("steps")}),"triggers"===e&&(0,m.jsx)(cy,{}),"steps"===e&&(0,m.jsx)(du,{workflowId:r,initialSelector:a,onSelectorConsumed:o}),"runs"===e&&(0,m.jsx)(dh,{workflowId:r}),"settings"===e&&(0,m.jsx)(db,{workflowId:r})]})]})}function dw(){let{selectedProjectId:e,hydrated:t}=(0,p.useProject)();return t?e?(0,m.jsx)("div",{className:"h-screen w-screen bg-background",children:(0,m.jsx)(dj,{})}):(0,m.jsx)(rV,{}):(0,m.jsx)("div",{className:"h-screen w-screen bg-background"})}e.s(["AppContainer",()=>dw],23204)}]);